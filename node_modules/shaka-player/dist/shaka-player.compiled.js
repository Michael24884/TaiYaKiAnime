/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
(function(){var innerGlobal=typeof window!="undefined"?window:global;var exportTo={};(function(window,global,module){var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)},ca="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function da(){da=function(){};ca.Symbol||(ca.Symbol=fa)}var fa=function(){var b=0;return function(c){return"jscomp_symbol_"+(c||"")+b++}}();
function ha(){da();var b=ca.Symbol.iterator;b||(b=ca.Symbol.iterator=ca.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&aa(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return ia(this)}});ha=function(){}}function ia(b){var c=0;return ja(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})}function ja(b){ha();b={next:b};b[ca.Symbol.iterator]=function(){return this};return b}function t(b){ha();var c=b[Symbol.iterator];return c?c.call(b):ia(b)}
function ka(b,c){if(c){for(var d=ca,e=b.split("."),f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];f=d[e];g=c(f);g!=f&&null!=g&&aa(d,e,{configurable:!0,writable:!0,value:g})}}
ka("Promise",function(b){function c(b){this.b=0;this.g=void 0;this.a=[];var c=this.c();try{b(c.resolve,c.reject)}catch(m){c.reject(m)}}function d(){this.a=null}function e(b){return b instanceof c?b:new c(function(c){c(b)})}if(b)return b;d.prototype.b=function(b){null==this.a&&(this.a=[],this.f());this.a.push(b)};d.prototype.f=function(){var b=this;this.c(function(){b.h()})};var f=ca.setTimeout;d.prototype.c=function(b){f(b,0)};d.prototype.h=function(){for(;this.a&&this.a.length;){var b=this.a;this.a=
[];for(var c=0;c<b.length;++c){var d=b[c];b[c]=null;try{d()}catch(n){this.g(n)}}}this.a=null};d.prototype.g=function(b){this.c(function(){throw b;})};c.prototype.c=function(){function b(b){return function(e){d||(d=!0,b.call(c,e))}}var c=this,d=!1;return{resolve:b(this.u),reject:b(this.f)}};c.prototype.u=function(b){if(b===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof c)this.v(b);else{a:switch(typeof b){case "object":var d=null!=b;break a;case "function":d=!0;
break a;default:d=!1}d?this.o(b):this.h(b)}};c.prototype.o=function(b){var c=void 0;try{c=b.then}catch(m){this.f(m);return}"function"==typeof c?this.F(c,b):this.h(b)};c.prototype.f=function(b){this.i(2,b)};c.prototype.h=function(b){this.i(1,b)};c.prototype.i=function(b,c){if(0!=this.b)throw Error("Cannot settle("+b+", "+c+"): Promise already settled in state"+this.b);this.b=b;this.g=c;this.l()};c.prototype.l=function(){if(null!=this.a){for(var b=0;b<this.a.length;++b)g.b(this.a[b]);this.a=null}};
var g=new d;c.prototype.v=function(b){var c=this.c();b.kc(c.resolve,c.reject)};c.prototype.F=function(b,c){var d=this.c();try{b.call(c,d.resolve,d.reject)}catch(n){d.reject(n)}};c.prototype.then=function(b,d){function e(b,c){return"function"==typeof b?function(c){try{f(b(c))}catch(z){g(z)}}:c}var f,g,h=new c(function(b,c){f=b;g=c});this.kc(e(b,f),e(d,g));return h};c.prototype["catch"]=function(b){return this.then(void 0,b)};c.prototype.kc=function(b,c){function d(){switch(e.b){case 1:b(e.g);break;
case 2:c(e.g);break;default:throw Error("Unexpected state: "+e.b);}}var e=this;null==this.a?g.b(d):this.a.push(d)};c.resolve=e;c.reject=function(b){return new c(function(c,d){d(b)})};c.race=function(b){return new c(function(c,d){for(var f=t(b),g=f.next();!g.done;g=f.next())e(g.value).kc(c,d)})};c.all=function(b){var d=t(b),f=d.next();return f.done?e([]):new c(function(b,c){function g(c){return function(d){h[c]=d;k--;0==k&&b(h)}}var h=[],k=0;do h.push(void 0),k++,e(f.value).kc(g(h.length-1),c),f=d.next();
while(!f.done)})};return c});ka("Promise.prototype.finally",function(b){return b?b:function(b){return this.then(function(c){return Promise.resolve(b()).then(function(){return c})},function(c){return Promise.resolve(b()).then(function(){throw c;})})}});function ma(b){function c(c){return b.next(c)}function d(c){return b["throw"](c)}return new Promise(function(e,f){function g(b){b.done?e(b.value):Promise.resolve(b.value).then(c,d).then(g,f)}g(b.next())})}function u(b){return ma(b())}
var na="function"==typeof Object.create?Object.create:function(b){function c(){}c.prototype=b;return new c},oa;if("function"==typeof Object.setPrototypeOf)oa=Object.setPrototypeOf;else{var pa;a:{var qa={Oe:!0},ra={};try{ra.__proto__=qa;pa=ra.Oe;break a}catch(b){}pa=!1}oa=pa?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null}var va=oa;
function wa(b,c){b.prototype=na(c.prototype);b.prototype.constructor=b;if(va)va(b,c);else for(var d in c)if("prototype"!=d)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(c,d);e&&Object.defineProperty(b,d,e)}else b[d]=c[d];b.Dg=c.prototype}function xa(){this.g=!1;this.c=null;this.s=void 0;this.j=1;this.b=this.f=0;this.i=this.a=null}function ya(b){if(b.g)throw new TypeError("Generator is already running");b.g=!0}xa.prototype.h=function(b){this.s=b};
function za(b,c){b.a={Yd:c,ie:!0};b.j=b.f||b.b}xa.prototype["return"]=function(b){this.a={"return":b};this.j=this.b};function v(b,c,d){b.j=d;return{value:c}}xa.prototype.C=function(b){this.j=b};function w(b){b.j=0}function Aa(b,c,d){b.f=c;void 0!=d&&(b.b=d)}function Ca(b,c){b.f=0;b.b=c||0}function Ea(b,c){b.j=c;b.f=0}function Fa(b){b.f=0;var c=b.a.Yd;b.a=null;return c}function Ga(b){b.i=[b.a];b.f=0;b.b=0}
function Ha(b,c){var d=b.i.splice(0)[0];(d=b.a=b.a||d)?d.ie?b.j=b.f||b.b:void 0!=d.C&&b.b<d.C?(b.j=d.C,b.a=null):b.j=b.b:b.j=c}function Ka(b){this.a=new xa;this.b=b}function La(b,c){ya(b.a);var d=b.a.c;if(d)return Ma(b,"return"in d?d["return"]:function(b){return{value:b,done:!0}},c,b.a["return"]);b.a["return"](c);return Na(b)}
function Ma(b,c,d,e){try{var f=c.call(b.a.c,d);if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");if(!f.done)return b.a.g=!1,f;var g=f.value}catch(h){return b.a.c=null,za(b.a,h),Na(b)}b.a.c=null;e.call(b.a,g);return Na(b)}
function Na(b){for(;b.a.j;)try{var c=b.b(b.a);if(c)return b.a.g=!1,{value:c.value,done:!1}}catch(d){b.a.s=void 0,za(b.a,d)}b.a.g=!1;if(b.a.a){c=b.a.a;b.a.a=null;if(c.ie)throw c.Yd;return{value:c["return"],done:!0}}return{value:void 0,done:!0}}
function Ra(b){this.next=function(c){ya(b.a);b.a.c?c=Ma(b,b.a.c.next,c,b.a.h):(b.a.h(c),c=Na(b));return c};this["throw"]=function(c){ya(b.a);b.a.c?c=Ma(b,b.a.c["throw"],c,b.a.h):(za(b.a,c),c=Na(b));return c};this["return"]=function(c){return La(b,c)};ha();this[Symbol.iterator]=function(){return this}}function x(b,c){Ra.prototype=b.prototype;return new Ra(new Ka(c))}function Sa(b){for(var c,d=[];!(c=b.next()).done;)d.push(c.value);return d}
function Ta(b,c){return Object.prototype.hasOwnProperty.call(b,c)}
ka("WeakMap",function(b){function c(b){this.a=(g+=Math.random()+1).toString();if(b){da();ha();b=t(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}}function d(b){Ta(b,f)||aa(b,f,{value:{}})}function e(b){var c=Object[b];c&&(Object[b]=function(b){d(b);return c(b)})}if(function(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),e=new b([[c,2],[d,3]]);if(2!=e.get(c)||3!=e.get(d))return!1;e["delete"](c);e.set(d,4);return!e.has(c)&&4==e.get(d)}catch(n){return!1}}())return b;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0;c.prototype.set=function(b,c){d(b);if(!Ta(b,f))throw Error("WeakMap key fail: "+b);b[f][this.a]=c;return this};c.prototype.get=function(b){return Ta(b,f)?b[f][this.a]:void 0};c.prototype.has=function(b){return Ta(b,f)&&Ta(b[f],this.a)};c.prototype["delete"]=function(b){return Ta(b,f)&&Ta(b[f],this.a)?delete b[f][this.a]:!1};return c});
ka("Map",function(b){function c(){var b={};return b.Ja=b.next=b.head=b}function d(b,c){var d=b.a;return ja(function(){if(d){for(;d.head!=b.a;)d=d.Ja;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})}function e(b,c){var d=c&&typeof c;"object"==d||"function"==d?g.has(c)?d=g.get(c):(d=""+ ++h,g.set(c,d)):d="p_"+c;var e=b.b[d];if(e&&Ta(b.b,d))for(var f=0;f<e.length;f++){var k=e[f];if(c!==c&&k.key!==k.key||c===k.key)return{id:d,list:e,index:f,ba:k}}return{id:d,
list:e,index:-1,ba:void 0}}function f(b){this.b={};this.a=c();this.size=0;if(b){b=t(b);for(var d;!(d=b.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b(t([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=c||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||
"t"!=f.value[1]||!e.next().done?!1:!0}catch(q){return!1}}())return b;da();ha();var g=new WeakMap;f.prototype.set=function(b,c){var d=e(this,b);d.list||(d.list=this.b[d.id]=[]);d.ba?d.ba.value=c:(d.ba={next:this.a,Ja:this.a.Ja,head:this.a,key:b,value:c},d.list.push(d.ba),this.a.Ja.next=d.ba,this.a.Ja=d.ba,this.size++);return this};f.prototype["delete"]=function(b){b=e(this,b);return b.ba&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.b[b.id],b.ba.Ja.next=b.ba.next,b.ba.next.Ja=b.ba.Ja,
b.ba.head=null,this.size--,!0):!1};f.prototype.clear=function(){this.b={};this.a=this.a.Ja=c();this.size=0};f.prototype.has=function(b){return!!e(this,b).ba};f.prototype.get=function(b){return(b=e(this,b).ba)&&b.value};f.prototype.entries=function(){return d(this,function(b){return[b.key,b.value]})};f.prototype.keys=function(){return d(this,function(b){return b.key})};f.prototype.values=function(){return d(this,function(b){return b.value})};f.prototype.forEach=function(b,c){for(var d=this.entries(),
e;!(e=d.next()).done;)e=e.value,b.call(c,e[1],e[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
ka("Set",function(b){function c(b){this.a=new Map;if(b){b=t(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new b(t([c]));if(!e.has(c)||1!=e.size||e.add(c)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var f=e.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return b;da();ha();c.prototype.add=function(b){this.a.set(b,b);this.size=this.a.size;return this};c.prototype["delete"]=function(b){b=this.a["delete"](b);this.size=this.a.size;return b};c.prototype.clear=function(){this.a.clear();this.size=0};c.prototype.has=function(b){return this.a.has(b)};c.prototype.entries=function(){return this.a.entries()};c.prototype.values=function(){return this.a.values()};c.prototype.keys=c.prototype.values;
c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(b,c){var d=this;this.a.forEach(function(e){return b.call(c,e,e,d)})};return c});function Ua(b,c,d){b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var g=b[f];if(c.call(d,g,f,b))return{fe:f,Je:g}}return{fe:-1,Je:void 0}}ka("Array.prototype.findIndex",function(b){return b?b:function(b,d){return Ua(this,b,d).fe}});
function Va(b,c){ha();b instanceof String&&(b+="");var d=0,e={next:function(){if(d<b.length){var f=d++;return{value:c(f,b[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e}ka("Array.prototype.keys",function(b){return b?b:function(){return Va(this,function(b){return b})}});ka("Object.is",function(b){return b?b:function(b,d){return b===d?0!==b||1/b===1/d:b!==b&&d!==d}});
ka("Array.prototype.includes",function(b){return b?b:function(b,d){var c=this;c instanceof String&&(c=String(c));var f=c.length,g=d||0;for(0>g&&(g=Math.max(g+f,0));g<f;g++){var h=c[g];if(h===b||Object.is(h,b))return!0}return!1}});function Wa(b,c,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""}
ka("String.prototype.includes",function(b){return b?b:function(b,d){return-1!==Wa(this,b,"includes").indexOf(b,d||0)}});ka("Array.from",function(b){return b?b:function(b,d,e){ha();d=null!=d?d:function(b){return b};var c=[],g=b[Symbol.iterator];if("function"==typeof g)for(b=g.call(b);!(g=b.next()).done;)c.push(d.call(e,g.value));else{g=b.length;for(var h=0;h<g;h++)c.push(d.call(e,b[h]))}return c}});
ka("String.prototype.startsWith",function(b){return b?b:function(b,d){for(var c=Wa(this,b,"startsWith"),f=c.length,g=b.length,h=Math.max(0,Math.min(d|0,c.length)),k=0;k<g&&h<f;)if(c[h++]!=b[k++])return!1;return k>=g}});ka("Array.prototype.find",function(b){return b?b:function(b,d){return Ua(this,b,d).Je}});var Xa="function"==typeof Object.assign?Object.assign:function(b,c){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e)for(var f in e)Ta(e,f)&&(b[f]=e[f])}return b};
ka("Object.assign",function(b){return b||Xa});var bb=this;bb.a=!0;function A(b,c){var d=b.split("."),e=bb;d[0]in e||!e.execScript||e.execScript("var "+d[0]);for(var f;d.length&&(f=d.shift());)d.length||void 0===c?e[f]?e=e[f]:e=e[f]={}:e[f]=c}function cb(b,c){function d(){}d.prototype=c.prototype;b.Dg=c.prototype;b.prototype=new d;b.prototype.constructor=b;b.Og=function(b,d,g){return c.prototype[d].apply(b,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function db(b){this.c=Math.exp(Math.log(.5)/b);this.b=this.a=0}function eb(b,c,d){var e=Math.pow(b.c,c);d=d*(1-e)+e*b.a;isNaN(d)||(b.a=d,b.b+=c)}function fb(b){return b.a/(1-Math.pow(b.c,b.b))};function gb(){this.b=new db(2);this.c=new db(5);this.a=0}gb.prototype.getBandwidthEstimate=function(b){return 128E3>this.a?b:Math.min(fb(this.b),fb(this.c))};var B={mb:0,jc:function(){},Z:function(){},error:function(){},m:function(){},info:function(){},debug:function(){},D:function(){},J:function(){}};window.console&&window.console.log.bind&&(B.Z=console.warn.bind(console),B.jc=console.error.bind(console),1<=B.mb&&(B.error=console.error.bind(console)),2<=B.mb&&(B.m=console.warn.bind(console)),3<=B.mb&&(B.info=console.info.bind(console)),4<=B.mb&&(B.debug=console.log.bind(console)),5<=B.mb&&(B.D=console.debug.bind(console)),6<=B.mb&&(B.J=console.debug.bind(console)));/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var hb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
function ib(b){var c;b instanceof ib?(jb(this,b.xa),this.jb=b.jb,this.wa=b.wa,kb(this,b.Jb),this.la=b.la,lb(this,b.a.clone()),this.Xa=b.Xa):b&&(c=String(b).match(hb))?(jb(this,c[1]||"",!0),this.jb=pb(c[2]||""),this.wa=pb(c[3]||"",!0),kb(this,c[4]),this.la=pb(c[5]||"",!0),lb(this,c[6]||"",!0),this.Xa=pb(c[7]||"")):this.a=new qb(null)}l=ib.prototype;l.xa="";l.jb="";l.wa="";l.Jb=null;l.la="";l.Xa="";
l.toString=function(){var b=[],c=this.xa;c&&b.push(rb(c,sb,!0),":");if(c=this.wa){b.push("//");var d=this.jb;d&&b.push(rb(d,sb,!0),"@");b.push(encodeURIComponent(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));c=this.Jb;null!=c&&b.push(":",String(c))}if(c=this.la)this.wa&&"/"!=c.charAt(0)&&b.push("/"),b.push(rb(c,"/"==c.charAt(0)?tb:ub,!0));(c=this.a.toString())&&b.push("?",c);(c=this.Xa)&&b.push("#",rb(c,vb));return b.join("")};
l.resolve=function(b){var c=this.clone();"data"===c.xa&&(c=new ib);var d=!!b.xa;d?jb(c,b.xa):d=!!b.jb;d?c.jb=b.jb:d=!!b.wa;d?c.wa=b.wa:d=null!=b.Jb;var e=b.la;if(d)kb(c,b.Jb);else if(d=!!b.la){if("/"!=e.charAt(0))if(this.wa&&!this.la)e="/"+e;else{var f=c.la.lastIndexOf("/");-1!=f&&(e=c.la.substr(0,f+1)+e)}if(".."==e||"."==e)e="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){f=0==e.lastIndexOf("/",0);e=e.split("/");for(var g=[],h=0;h<e.length;){var k=e[h++];"."==k?f&&h==e.length&&g.push(""):".."==
k?((1<g.length||1==g.length&&""!=g[0])&&g.pop(),f&&h==e.length&&g.push("")):(g.push(k),f=!0)}e=g.join("/")}}d?c.la=e:d=""!==b.a.toString();d?lb(c,b.a.clone()):d=!!b.Xa;d&&(c.Xa=b.Xa);return c};l.clone=function(){return new ib(this)};function jb(b,c,d){b.xa=d?pb(c,!0):c;b.xa&&(b.xa=b.xa.replace(/:$/,""))}function kb(b,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);b.Jb=c}else b.Jb=null}function lb(b,c,d){c instanceof qb?b.a=c:(d||(c=rb(c,wb)),b.a=new qb(c))}
function pb(b,c){return b?c?decodeURI(b):decodeURIComponent(b):""}function rb(b,c,d){return"string"==typeof b?(b=encodeURI(b).replace(c,xb),d&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function xb(b){b=b.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var sb=/[#\/\?@]/g,ub=/[#\?:]/g,tb=/[#\?]/g,wb=/[#\?@]/g,vb=/#/g;function qb(b){this.a=b||null}l=qb.prototype;l.ja=null;l.nc=null;
l.add=function(b,c){if(!this.ja&&(this.ja={},this.nc=0,this.a))for(var d=this.a.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null;if(0<=f){var h=d[e].substring(0,f);g=d[e].substring(f+1)}else h=d[e];h=decodeURIComponent(h.replace(/\+/g," "));g=g||"";this.add(h,decodeURIComponent(g.replace(/\+/g," ")))}this.a=null;(d=this.ja.hasOwnProperty(b)&&this.ja[b])||(this.ja[b]=d=[]);d.push(c);this.nc++;return this};
l.toString=function(){if(this.a)return this.a;if(!this.ja)return"";var b=[],c;for(c in this.ja)for(var d=encodeURIComponent(c),e=this.ja[c],f=0;f<e.length;f++){var g=d;""!==e[f]&&(g+="="+encodeURIComponent(e[f]));b.push(g)}return this.a=b.join("&")};l.clone=function(){var b=new qb;b.a=this.a;if(this.ja){var c={},d;for(d in this.ja)c[d]=this.ja[d].concat();b.ja=c;b.nc=this.nc}return b};function yb(b){this.b=b;this.a=null}yb.prototype.R=function(b){var c=this;this.stop();var d=!0,e=null;this.a=function(){window.clearTimeout(e);d=!1};e=window.setTimeout(function(){d&&c.b()},1E3*b);return this};yb.prototype.stop=function(){this.a&&(this.a(),this.a=null)};function D(b){this.b=b;this.a=null}A("shaka.util.Timer",D);D.prototype.Gc=function(){this.stop();this.b();return this};D.prototype.tickNow=D.prototype.Gc;D.prototype.R=function(b){var c=this;this.stop();this.a=(new yb(function(){c.b()})).R(b);return this};D.prototype.tickAfter=D.prototype.R;D.prototype.Ka=function(b){var c=this;this.stop();this.a=(new yb(function(){c.a.R(b);c.b()})).R(b);return this};D.prototype.tickEvery=D.prototype.Ka;D.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)};
D.prototype.stop=D.prototype.stop;function zb(b,c){var d=Ab();this.i=null==b.maxAttempts?d.maxAttempts:b.maxAttempts;this.f=null==b.baseDelay?d.baseDelay:b.baseDelay;this.h=null==b.fuzzFactor?d.fuzzFactor:b.fuzzFactor;this.g=null==b.backoffFactor?d.backoffFactor:b.backoffFactor;this.a=0;this.b=this.f;if(this.c=void 0===c?!1:c)this.a=1}
function Eb(b){return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:if(b.a>=b.i)if(b.c)b.a=1,b.b=b.f;else return d["return"](Promise.reject());e=b.a;b.a++;if(0==e)return d["return"]();f=b.b*(1+(2*Math.random()-1)*b.h);return v(d,new Promise(function(b){(new D(b)).R(f/1E3)}),2);case 2:b.b*=b.g,w(d)}})})}function Ab(){return{maxAttempts:2,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0}};function E(b,c,d,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.severity=b;this.category=c;this.code=d;this.data=f;this.handled=!1}A("shaka.util.Error",E);E.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")};E.Severity={RECOVERABLE:1,CRITICAL:2};E.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9};
E.Code={UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,
MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,
DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,
HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6E3,
REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7E3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,
CAST_API_UNAVAILABLE:8E3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9E3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,
MISSING_STORAGE_CELL:9013};function G(){var b,c,d=new Promise(function(d,f){b=d;c=f});d.resolve=b;d.reject=c;return d}G.prototype.resolve=function(){};G.prototype.reject=function(){};function I(b,c){this.promise=b;this.me=c;this.a=!1}A("shaka.util.AbortableOperation",I);function Fb(b){return new I(Promise.reject(b),function(){return Promise.resolve()})}I.failed=Fb;function Gb(){var b=Promise.reject(new E(2,7,7001));b["catch"](function(){});return new I(b,function(){return Promise.resolve()})}I.aborted=Gb;function Hb(b){return new I(Promise.resolve(b),function(){return Promise.resolve()})}I.completed=Hb;
function Ib(b){return new I(b,function(){return b["catch"](function(){})})}I.notAbortable=Ib;I.prototype.abort=function(){this.a=!0;return this.me()};I.prototype.abort=I.prototype.abort;function Jb(b){return new I(Promise.all(b.map(function(b){return b.promise})),function(){return Promise.all(b.map(function(b){return b.abort()}))})}I.all=Jb;I.prototype["finally"]=function(b){this.promise.then(function(){return b(!0)},function(){return b(!1)});return this};I.prototype["finally"]=I.prototype["finally"];
I.prototype.Y=function(b,c){function d(d){return function(k){if(f.a&&d)g.reject(h);else{var m=d?b:c;m?e=Kb(m,k,g):(d?g.resolve:g.reject)(k)}}}function e(){g.reject(h);return f.abort()}var f=this,g=new G,h=new E(2,7,7001);this.promise.then(d(!0),d(!1));return new I(g,function(){return e()})};I.prototype.chain=I.prototype.Y;
function Kb(b,c,d){try{var e=b(c);if(e&&e.promise&&e.abort)return d.resolve(e.promise),function(){return e.abort()};d.resolve(e);return function(){return Promise.resolve(e).then(function(){},function(){})}}catch(f){return d.reject(f),function(){return Promise.resolve()}}};function J(b,c){c=void 0===c?{}:c;for(var d in c)this[d]=c[d];this.defaultPrevented=this.cancelable=this.bubbles=!1;this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now();this.type=b;this.isTrusted=!1;this.target=this.currentTarget=null;this.a=!1}J.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)};J.prototype.stopImmediatePropagation=function(){this.a=!0};J.prototype.stopPropagation=function(){};function Lb(){this.a={}}l=Lb.prototype;l.push=function(b,c){this.a.hasOwnProperty(b)?this.a[b].push(c):this.a[b]=[c]};l.get=function(b){return(b=this.a[b])?b.slice():null};l.getAll=function(){var b=[],c;for(c in this.a)b.push.apply(b,this.a[c]);return b};l.remove=function(b,c){var d=this.a[b];if(d)for(var e=0;e<d.length;++e)d[e]==c&&(d.splice(e,1),--e)};l.forEach=function(b){for(var c in this.a)b(c,this.a[c])};function Mb(){this.Sc=new Lb;this.gc=this}Mb.prototype.addEventListener=function(b,c){this.Sc.push(b,c)};Mb.prototype.removeEventListener=function(b,c){this.Sc.remove(b,c)};Mb.prototype.dispatchEvent=function(b){for(var c=this.Sc.get(b.type)||[],d=0;d<c.length;++d){b.target=this.gc;b.currentTarget=this.gc;var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(f){B.error("Uncaught exception in event handler",f,f?f.message:null,f?f.stack:null)}if(b.a)break}return b.defaultPrevented};function Nb(b){function c(b){switch(typeof b){case "undefined":case "boolean":case "number":case "string":case "symbol":case "function":return b;default:if(!b||b.buffer&&b.buffer.constructor==ArrayBuffer)return b;if(d.has(b))return null;var e=b.constructor==Array;if(b.constructor!=Object&&!e)return null;d.add(b);var g=e?[]:{},h;for(h in b)g[h]=c(b[h]);e&&(g.length=b.length);return g}}var d=new Set;return c(b)};function Ob(b,c){return"number"===typeof b&&"number"===typeof c&&isNaN(b)&&isNaN(c)?!0:b===c}function Pb(b,c){var d=b.indexOf(c);-1<d&&b.splice(d,1)}function Qb(b,c){var d=0;b.forEach(function(b){d+=c(b)?1:0});return d}
function Rb(b,c,d){d||(d=Ob);if(b.length!=c.length)return!1;c=c.slice();var e={};b=t(b);for(var f=b.next();!f.done;e={item:e.item},f=b.next()){e.item=f.value;f=c.findIndex(function(b){return function(c){return d(b.item,c)}}(e));if(-1==f)return!1;c[f]=c[c.length-1];c.pop()}return 0==c.length};function Sb(){this.a=[]}function Tb(b,c){b.a.push(c["finally"](function(){Pb(b.a,c)}))}Sb.prototype.destroy=function(){var b=[];this.a.forEach(function(c){c.promise["catch"](function(){});b.push(c.abort())});this.a=[];return Promise.all(b)};function K(b){Mb.call(this);this.f=!1;this.g=new Sb;this.a=new Set;this.b=new Set;this.c=b||null}cb(K,Mb);A("shaka.net.NetworkingEngine",K);K.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};K.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Ub={};function Vb(b,c,d){d=d||3;var e=Ub[b];if(!e||d>=e.priority)Ub[b]={priority:d,dg:c}}K.registerScheme=Vb;K.unregisterScheme=function(b){delete Ub[b]};K.prototype.fg=function(b){this.a.add(b)};K.prototype.registerRequestFilter=K.prototype.fg;
K.prototype.Fg=function(b){this.a["delete"](b)};K.prototype.unregisterRequestFilter=K.prototype.Fg;K.prototype.We=function(){this.a.clear()};K.prototype.clearAllRequestFilters=K.prototype.We;K.prototype.gg=function(b){this.b.add(b)};K.prototype.registerResponseFilter=K.prototype.gg;K.prototype.Gg=function(b){this.b["delete"](b)};K.prototype.unregisterResponseFilter=K.prototype.Gg;K.prototype.Xe=function(){this.b.clear()};K.prototype.clearAllResponseFilters=K.prototype.Xe;
K.defaultRetryParameters=function(){return Ab()};function Wb(b,c){return{uris:b,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:c,licenseRequestType:null,sessionId:null}}K.makeRequest=Wb;K.prototype.destroy=function(){this.f=!0;this.a.clear();this.b.clear();return this.g.destroy()};K.prototype.destroy=K.prototype.destroy;
K.prototype.request=function(b,c){var d=this,e=new Xb;if(this.f){var f=Promise.reject(new E(2,7,7001));f["catch"](function(){});return new Yb(f,function(){return Promise.resolve()},e)}c.method=c.method||"GET";c.headers=c.headers||{};c.retryParameters=c.retryParameters?Nb(c.retryParameters):Ab();c.uris=Nb(c.uris);f=Zb(this,b,c);var g=f.Y(function(){return $b(d,b,c,new zb(c.retryParameters,!1),0,null,e)}),h=g.Y(function(c){return ac(d,b,c)}),k=Date.now(),m=0;f.promise.then(function(){m=Date.now()-k},
function(){});var n=0;g.promise.then(function(){n=Date.now()},function(){});f=h.Y(function(c){var e=Date.now()-n,f=c.response;f.timeMs+=m;f.timeMs+=e;c.Ef||!d.c||f.fromCache||1!=b||d.c(f.timeMs,f.data.byteLength);return f},function(b){b&&(b.severity=2);throw b;});f=new Yb(f.promise,f.me,e);Tb(this.g,f);return f};K.prototype.request=K.prototype.request;
function Zb(b,c,d){var e=Hb(void 0),f={};b=t(b.a);for(var g=b.next();!g.done;f={Ad:f.Ad},g=b.next())f.Ad=g.value,e=e.Y(function(b){return function(){return b.Ad(c,d)}}(f));return e.Y(void 0,function(b){if(b&&7001==b.code)throw b;throw new E(2,1,1006,b);})}
function $b(b,c,d,e,f,g,h){var k=new ib(d.uris[f]),m=k.xa,n=!1;m||(m=location.protocol,m=m.slice(0,-1),jb(k,m),d.uris[f]=k.toString());m=m.toLowerCase();var p=(m=Ub[m])?m.dg:null;if(!p)return Fb(new E(2,1,1E3,k));var q;return Ib(Eb(e)).Y(function(){if(b.f)return Gb();q=Date.now();return p(d.uris[f],d,c,function(d,e,f){b.c&&1==c&&(b.c(d,e),n=!0,h.a=f)})}).Y(function(b){void 0==b.timeMs&&(b.timeMs=Date.now()-q);return{response:b,Ef:n}},function(k){if(k&&7001==k.code)throw k;if(b.f)return Gb();if(k&&
1==k.severity)return b.dispatchEvent(new J("retry",{error:k instanceof E?k:null})),f=(f+1)%d.uris.length,$b(b,c,d,e,f,k,h);throw k||g;})}function ac(b,c,d){var e=Hb(void 0);b=t(b.b);for(var f=b.next();!f.done;f=b.next())e=e.Y(f.value.bind(null,c,d.response));return e.Y(function(){return d},function(b){if(b&&7001==b.code)throw b;var c=2;b instanceof E&&(c=b.severity);throw new E(c,1,1007,b);})}function Xb(){this.a=0}K.NumBytesRemainingClass=Xb;function Yb(b,c,d){I.call(this,b,c);this.b=d}wa(Yb,I);
K.PendingRequest=Yb;Yb.all=Jb;Yb.notAbortable=Ib;Yb.completed=Hb;Yb.aborted=Gb;Yb.failed=Fb;function bc(){}A("shaka.util.IReleasable",bc);bc.prototype.release=function(){};function L(){this.a=new Lb}A("shaka.util.EventManager",L);L.prototype.release=function(){this.hb();this.a=null};L.prototype.release=L.prototype.release;L.prototype.B=function(b,c,d,e){this.a&&(b=new dc(b,c,d,e),this.a.push(c,b))};L.prototype.listen=L.prototype.B;L.prototype.ua=function(b,c,d,e){function f(e){g.pa(b,c,f);d(e)}var g=this;this.B(b,c,f,e)};L.prototype.listenOnce=L.prototype.ua;
L.prototype.pa=function(b,c,d){if(this.a){var e=this.a.get(c)||[];e=t(e);for(var f=e.next();!f.done;f=e.next())f=f.value,f.target!=b||d!=f.listener&&d||(f.pa(),this.a.remove(c,f))}};L.prototype.unlisten=L.prototype.pa;L.prototype.hb=function(){if(this.a){var b=this.a.getAll();b=t(b);for(var c=b.next();!c.done;c=b.next())c.value.pa();this.a.a={}}};L.prototype.removeAll=L.prototype.hb;
function dc(b,c,d,e){this.target=b;this.type=c;this.listener=d;this.a=ec(b,e);this.target.addEventListener(c,d,this.a)}dc.prototype.pa=function(){this.target.removeEventListener(this.type,this.listener,this.a);this.listener=this.target=null;this.a=!1};dc.prototype.unlisten=dc.prototype.pa;function ec(b,c){if(void 0==c)return!1;if("boolean"==typeof c)return c;var d=new Set(["passive","capture"]);Object.keys(c).filter(function(b){return!d.has(b)});return fc(b)?c:c.capture||!1}
function fc(b){var c=gc;if(void 0==c){c=!1;try{var d={},e={get:function(){c=!0;return!1}};Object.defineProperty(d,"passive",e);Object.defineProperty(d,"capture",e);e=function(){};b.addEventListener("test",e,d);b.removeEventListener("test",e,d)}catch(f){c=!1}gc=c}return c||!1}var gc=void 0;function hc(b){b=ic(b);return(new ib(b)).wa}A("shaka.util.FairPlayUtils.defaultGetContentId",hc);function jc(b,c,d){function e(b){(new DataView(f.buffer)).setUint32(g,b.byteLength,!0);g+=4;f.set(b,g);g+=b.byteLength}if(!d||!d.byteLength)throw new E(2,6,6015);c="string"==typeof c?new Uint8Array(kc(c,!0)):new Uint8Array(c);b=ic(b);b=kc(b,!0);var f=new Uint8Array(12+b.byteLength+c.byteLength+d.byteLength),g=0;e(new Uint8Array(b));e(c);e(new Uint8Array(d));return f}
A("shaka.util.FairPlayUtils.initDataTransform",jc);function lc(b,c){for(var d=[],e=t(b),f=e.next();!f.done;f=e.next())d.push(c(f.value));return d}function mc(b,c){for(var d=t(b),e=d.next();!e.done;e=d.next())if(!c(e.value))return!1;return!0};function nc(b){var c=new Map;Object.keys(b).forEach(function(d){c.set(d,b[d])});return c}function oc(b){var c={};b.forEach(function(b,e){c[e]=b});return c};function pc(b,c){var d=b;c&&(d+='; codecs="'+c+'"');return d}function qc(b){var c=[b.mimeType];rc.forEach(function(d,e){var f=b[e];f&&c.push(d+'="'+f+'"')});return c.join(";")}function sc(b){b=b.split(".");var c=b[0];b.pop();return[c,b.join(".")]}var rc=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function tc(){return window.MediaSource&&MediaSource.isTypeSupported?!0:!1}function uc(b){return""!=vc().canPlayType(b)}function wc(){return navigator.userAgent.match(/Edge?\//)?!0:!1}function xc(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!yc("Tizen")}function zc(){if(!xc())return null;var b=navigator.userAgent.match(/Version\/(\d+)/);return b?parseInt(b[1],10):(b=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(b[1],10):null}
function yc(b){return(navigator.userAgent||"").includes(b)}function vc(){if(Ac)return Ac;Bc||(Bc=new D(function(){Ac=null}));(Ac=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(Ac=document.createElement("video"));Bc.R(1);return Ac}var Bc=null,Ac=null;function Cc(b){if(!b)return"";b=new Uint8Array(b);239==b[0]&&187==b[1]&&191==b[2]&&(b=b.subarray(3));b=Dc(b);b=escape(b);try{return decodeURIComponent(b)}catch(c){throw new E(2,2,2004);}}A("shaka.util.StringUtils.fromUTF8",Cc);
function Ec(b,c,d){if(!b)return"";if(!d&&0!=b.byteLength%2)throw B.error("Data has an incorrect length, must be even."),new E(2,2,2004);if(b instanceof ArrayBuffer)var e=b;else d=new Uint8Array(b.byteLength),d.set(new Uint8Array(b)),e=d.buffer;b=Math.floor(b.byteLength/2);d=new Uint16Array(b);e=new DataView(e);for(var f=0;f<b;f++)d[f]=e.getUint16(2*f,c);return Dc(d)}A("shaka.util.StringUtils.fromUTF16",Ec);
function ic(b){var c=new Uint8Array(b);if(239==c[0]&&187==c[1]&&191==c[2])return Cc(c);if(254==c[0]&&255==c[1])return Ec(c.subarray(2),!1);if(255==c[0]&&254==c[1])return Ec(c.subarray(2),!0);var d=function(b,c){return b.byteLength<=c||32<=b[c]&&126>=b[c]}.bind(null,c);B.debug("Unable to find byte-order-mark, making an educated guess.");if(0==c[0]&&0==c[2])return Ec(b,!1);if(0==c[1]&&0==c[3])return Ec(b,!0);if(d(0)&&d(1)&&d(2)&&d(3))return Cc(b);throw new E(2,2,2003);}
A("shaka.util.StringUtils.fromBytesAutoDetect",ic);function Fc(b){b=encodeURIComponent(b);b=unescape(b);for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c.buffer}A("shaka.util.StringUtils.toUTF8",Fc);function kc(b,c){for(var d=new Uint8Array(2*b.length),e=new DataView(d.buffer),f=0;f<b.length;++f)e.setUint16(2*f,b.charCodeAt(f),c);return d.buffer}A("shaka.util.StringUtils.toUTF16",kc);
function Dc(b){if(!Gc)for(var c=function(b){try{var c=new Uint8Array(b);return 0<String.fromCharCode.apply(null,c).length}catch(g){return!1}},d={size:65536};0<d.size;d={size:d.size},d.size/=2)if(c(d.size)){Gc=function(b){return function(c){for(var d="",e=0;e<c.length;e+=b.size)d+=String.fromCharCode.apply(null,c.subarray(e,e+b.size));return d}}(d);break}return Gc(b)}var Gc=null;A("shaka.util.StringUtils.resetFromCharCode",function(){Gc=null});var M={Hc:function(b,c){var d=Dc(b);c=void 0==c?!0:c;d=window.btoa(d).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}};A("shaka.util.Uint8ArrayUtils.toBase64",M.Hc);M.Fa=function(b){b=window.atob(b.replace(/-/g,"+").replace(/_/g,"/"));for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c};A("shaka.util.Uint8ArrayUtils.fromBase64",M.Fa);
M.Yc=function(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2)c[d/2]=window.parseInt(b.substr(d,2),16);return c};A("shaka.util.Uint8ArrayUtils.fromHex",M.Yc);M.Ic=function(b){for(var c="",d=0;d<b.length;++d){var e=b[d].toString(16);1==e.length&&(e="0"+e);c+=e}return c};A("shaka.util.Uint8ArrayUtils.toHex",M.Ic);M.Da=function(b,c){if(!b&&!c)return!0;if(!b||!c||b.length!=c.length)return!1;for(var d=0;d<b.length;++d)if(b[d]!=c[d])return!1;return!0};A("shaka.util.Uint8ArrayUtils.equal",M.Da);
M.concat=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];for(var e=d=0;e<c.length;++e)d+=c[e].length;d=new Uint8Array(d);for(var f=e=0;f<c.length;++f)d.set(c[f],e),e+=c[f].length;return d};A("shaka.util.Uint8ArrayUtils.concat",M.concat);function Hc(b,c){var d=this;c=void 0===c?1:c;this.F=b;this.u=new Set;this.h=this.l=null;this.V=!1;this.K=0;this.a=null;this.i=new L;this.b=new Map;this.v=[];this.o=new G;this.f=null;this.g=function(c){d.o.reject(c);b.onError(c)};this.sa=new Map;this.$=new Map;this.T=new D(function(){return Ic(d)});this.c=!1;this.qa=new G;this.G=!1;this.H=[];this.ra=!1;this.ea=(new D(function(){Jc(d)})).Ka(c);this.o["catch"](function(){})}l=Hc.prototype;
l.destroy=function(){var b=this;return u(function d(){return x(d,function(d){switch(d.j){case 1:if(b.c)return v(d,b.qa,0);b.c=!0;return v(d,Kc(b),4);case 4:b.qa.resolve(),d.C(0)}})})};
function Kc(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:return b.i.release(),b.i=null,b.o.reject(),b.ea.stop(),b.ea=null,b.T.stop(),b.T=null,v(d,Lc(b),2);case 2:if(!b.h){d.C(3);break}Aa(d,4);return v(d,b.h.setMediaKeys(null),6);case 6:Ea(d,5);break;case 4:Fa(d);case 5:b.h=null;case 3:b.a=null,b.u.clear(),b.l=null,b.v=[],b.f=null,b.g=null,b.F=null,w(d)}})})}l.configure=function(b){this.f=b};function Mc(b,c,d){b.v=[];b.G=d;return Nc(b,c)}
function Oc(b,c,d){b.v=d;b.G=0<d.length;return Nc(b,c)}function Pc(b,c,d,e,f,g){var h=new Map;h.set(c,{audioCapabilities:f,videoCapabilities:g,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:c,drmInfos:[{keySystem:c,licenseServerUri:d,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:e,initData:null,keyIds:null}]});return Qc(b,h)}
function Nc(b,c){var d=Rc(b);if(d)for(var e=t(c),f=e.next();!f.done;f=e.next())f.value.drmInfos=[d];d=c.some(function(b){return 0<b.drmInfos.length});d||(f=nc(b.f.servers),Sc(c,f));e=t(c);for(f=e.next();!f.done;f=e.next()){f=t(f.value.drmInfos);for(var g=f.next();!g.done;g=f.next())Tc(g.value,nc(b.f.servers),nc(b.f.advanced||{}))}f=Uc(b,c);if(!f.size)return b.V=!0,Promise.resolve();f=Qc(b,f);return d?f:f["catch"](function(){})}
l.Qb=function(b){var c=this;if(!this.l)return this.i.ua(b,"encrypted",function(){c.g(new E(2,6,6010))}),Promise.resolve();this.h=b;this.i.ua(this.h,"play",function(){for(var b=0;b<c.H.length;b++)Vc(c,c.H[b]);c.ra=!0;c.H=[]});"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",function(){return Lc(c)});b=this.h.setMediaKeys(this.l);b=b["catch"](function(b){return Promise.reject(new E(2,6,6003,b.message))});var d=Wc(this);return Promise.all([b,
d]).then(function(){if(c.c)return Promise.reject();Xc(c);c.a.initData.length||c.v.length||c.i.B(c.h,"encrypted",function(b){return Yc(c,b.initDataType,new Uint8Array(b.initData))})})["catch"](function(b){if(!c.c)return Promise.reject(b)})};
function Wc(b){return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:if(!(b.l&&b.a&&b.a.serverCertificate&&b.a.serverCertificate.length)){d.C(0);break}Aa(d,3);return v(d,b.l.setServerCertificate(b.a.serverCertificate),5);case 5:(e=d.s)||B.m("Server certificates are not supported by the key system.  The server certificate has been ignored.");Ea(d,0);break;case 3:return f=Fa(d),d["return"](Promise.reject(new E(2,6,6004,f.message)))}})})}
function Zc(b,c){return u(function e(){var f,g,h;return x(e,function(e){switch(e.j){case 1:return v(e,$c(b,c),2);case 2:f=e.s;if(!f)return B.J("Ignoring attempt to remove missing session",c),e["return"]();g=[];if(h=b.b.get(f))h.Ca=new G,g.push(h.Ca);B.J("Attempting to remove session",c);g.push(f.remove());return v(e,Promise.all(g),0)}})})}
function Xc(b){var c=b.a?b.a.initData:[];c.forEach(function(c){return Yc(b,c.initDataType,c.initData)});b.v.forEach(function(c){return $c(b,c)});c.length||b.v.length||b.o.resolve();return b.o}function Yc(b,c,d){var e=b.b.values();e=t(e);for(var f=e.next();!f.done;f=e.next())if(M.Da(d,f.value.initData)&&!yc("Tizen 2")){B.debug("Ignoring duplicate init data.");return}ad(b,c,d)}function bd(b){return b?b.keySystem:""}
function cd(b){b=b.b.keys();b=lc(b,function(b){return b.sessionId});return Array.from(b)}l.Tb=function(){var b=Infinity,c=this.b.keys();c=t(c);for(var d=c.next();!d.done;d=c.next())d=d.value,isNaN(d.expiration)||(b=Math.min(b,d.expiration));return b};
function Uc(b,c){for(var d=new Set,e=t(c),f=e.next();!f.done;f=e.next()){var g=t(f.value.drmInfos);for(f=g.next();!f.done;f=g.next())d.add(f.value)}e=t(d);for(f=e.next();!f.done;f=e.next())Tc(f.value,nc(b.f.servers),nc(b.f.advanced||{}));g=b.G?"required":"optional";var h=b.G?["persistent-license"]:["temporary"];e=new Map;d=t(d);for(f=d.next();!f.done;f=d.next())f=f.value,e.set(f.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:g,sessionTypes:h,
label:f.keySystem,drmInfos:[]});d=t(c);for(f=d.next();!f.done;f=d.next()){f=f.value;g=f.audio;h=f.video;var k=g?pc(g.mimeType,g.codecs):"",m=h?pc(h.mimeType,h.codecs):"",n=t(f.drmInfos);for(f=n.next();!f.done;f=n.next()){f=f.value;var p=e.get(f.keySystem);p.drmInfos.push(f);f.distinctiveIdentifierRequired&&(p.distinctiveIdentifier="required");f.persistentStateRequired&&(p.persistentState="required");g&&p.audioCapabilities.push({robustness:f.audioRobustness||"",contentType:k});h&&p.videoCapabilities.push({robustness:f.videoRobustness||
"",contentType:m})}}return e}
function Qc(b,c){if(1==c.size&&c.has(""))return Promise.reject(new E(2,6,6E3));for(var d=t(c.values()),e=d.next();!e.done;e=d.next())e=e.value,0==e.audioCapabilities.length&&delete e.audioCapabilities,0==e.videoCapabilities.length&&delete e.videoCapabilities;var f=d=new G;[!0,!1].forEach(function(b){var d=this;c.forEach(function(c,e){c.drmInfos.some(function(b){return!!b.licenseServerUri})==b&&(f=f["catch"](function(){if(!this.c)return navigator.requestMediaKeySystemAccess(e,[c])}.bind(d)))})}.bind(b));
f=f["catch"](function(){return Promise.reject(new E(2,6,6001))});f=f.then(function(b){if(this.c)return Promise.reject();this.u.clear();var d=b.getConfiguration(),e=d.videoCapabilities||[],f=t(d.audioCapabilities||[]);for(d=f.next();!d.done;d=f.next())this.u.add(d.value.contentType.toLowerCase());e=t(e);for(d=e.next();!d.done;d=e.next())this.u.add(d.value.contentType.toLowerCase());e=b.keySystem;d=c.get(b.keySystem);f=[];var g=[],p=[],q=[];dd(d.drmInfos,f,g,p,q);1<g.length&&B.m("Multiple unique server certificates found! Only the first will be used.");
1<f.length&&B.m("Multiple unique license server URIs found! Only the first will be used.");this.a={keySystem:e,licenseServerUri:f[0],distinctiveIdentifierRequired:"required"==d.distinctiveIdentifier,persistentStateRequired:"required"==d.persistentState,audioRobustness:(d.audioCapabilities?d.audioCapabilities[0].robustness:"")||"",videoRobustness:(d.videoCapabilities?d.videoCapabilities[0].robustness:"")||"",serverCertificate:g[0],initData:p,keyIds:q};return this.a.licenseServerUri?b.createMediaKeys():
Promise.reject(new E(2,6,6012,this.a.keySystem))}.bind(b)).then(function(b){if(this.c)return Promise.reject();B.info("Created MediaKeys object for key system",this.a.keySystem);this.l=b;this.V=!0}.bind(b))["catch"](function(b){if(!this.c)return this.a=null,this.u.clear(),b instanceof E?Promise.reject(b):Promise.reject(new E(2,6,6002,b.message))}.bind(b));d.reject();return f}
function Rc(b){b=nc(b.f.clearKeys);if(0==b.size)return null;var c=[],d=[];b.forEach(function(b,e){var f=M.Yc(e),g=M.Yc(b);f={kty:"oct",kid:M.Hc(f,!1),k:M.Hc(g,!1)};c.push(f);d.push(f.kid)});b=JSON.stringify({keys:c});var e=JSON.stringify({kids:d});e=[{initData:new Uint8Array(Fc(e)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(b),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",
serverCertificate:null,initData:e,keyIds:[]}}
function $c(b,c){try{B.D("Attempting to load an offline session",c);var d=b.l.createSession("persistent-license")}catch(g){var e=new E(2,6,6005,g.message);b.g(e);return Promise.reject(e)}b.i.B(d,"message",b.se.bind(b));b.i.B(d,"keystatuseschange",b.qe.bind(b));var f={initData:null,loaded:!1,rd:Infinity,Ca:null};b.b.set(d,f);return d.load(c).then(function(b){if(this.c)return Promise.reject();B.J("Loaded offline session",c,b);if(b)return f.loaded=!0,ed(this)&&this.o.resolve(),d;this.b["delete"](d);
this.g(new E(2,6,6013))}.bind(b),function(b){this.c||(this.b["delete"](d),this.g(new E(2,6,6005,b.message)))}.bind(b))}
function ad(b,c,d){try{if(b.G){B.D("Creating new persistent session");var e=b.l.createSession("persistent-license")}else B.D("Creating new temporary session"),e=b.l.createSession()}catch(f){b.g(new E(2,6,6005,f.message));return}b.i.B(e,"message",b.se.bind(b));b.i.B(e,"keystatuseschange",b.qe.bind(b));b.b.set(e,{initData:d,loaded:!1,rd:Infinity,Ca:null});try{d=b.f.initDataTransform(d,b.a)}catch(f){c=f;f instanceof E||(c=new E(2,6,6016,f));b.g(c);return}e.generateRequest(c,d)["catch"](function(c){if(!b.c){b.b["delete"](e);
if(c.errorCode&&c.errorCode.systemCode){var d=c.errorCode.systemCode;0>d&&(d+=Math.pow(2,32));d="0x"+d.toString(16)}b.g(new E(2,6,6006,c.message,c,d))}})}function fd(b,c){if(bd(c).startsWith("com.apple.fps")){var d=c.serverCertificate,e=hc(b);b=jc(b,e,d)}return b}l.se=function(b){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ra?this.H.push(b):Vc(this,b)};
function Vc(b,c){var d=c.target;B.D("Sending license request for session",d.sessionId,"of type",c.messageType);var e=b.b.get(d),f=b.a.licenseServerUri,g=b.f.advanced[b.a.keySystem];"individualization-request"==c.messageType&&g&&g.individualizationServer&&(f=g.individualizationServer);f=Wb([f],b.f.retryParameters);f.body=c.message;f.method="POST";f.licenseRequestType=c.messageType;f.sessionId=d.sessionId;"com.microsoft.playready"!=b.a.keySystem&&"com.chromecast.playready"!=b.a.keySystem||gd(f);b.a.keySystem.startsWith("com.apple.fps")&&
b.f.fairPlayTransform&&hd(f);var h=Date.now();b.F.Db.request(2,f).promise.then(function(b){if(this.c)return Promise.reject();this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&id(b);this.K+=(Date.now()-h)/1E3;B.D("Updating session",d.sessionId);return d.update(b.data).then(function(){var b=this;this.F.onEvent(new J("drmsessionupdate"));e&&(e.Ca&&e.Ca.resolve(),(new D(function(){e.loaded=!0;ed(b)&&b.o.resolve()})).R(jd))}.bind(this))}.bind(b),function(b){this.c||(b=new E(2,6,6007,
b),this.g(b),e&&e.Ca&&e.Ca.reject(b))}.bind(b))["catch"](function(b){this.c||(b=new E(2,6,6008,b.message),this.g(b),e&&e.Ca&&e.Ca.reject(b))}.bind(b))}
function gd(b){var c=Ec(b.body,!0,!0);if(c.includes("PlayReadyKeyMessage")){B.debug("Unwrapping PlayReady request.");c=(new DOMParser).parseFromString(c,"application/xml");for(var d=c.getElementsByTagName("HttpHeader"),e=0;e<d.length;++e)b.headers[d[e].getElementsByTagName("name")[0].textContent]=d[e].getElementsByTagName("value")[0].textContent;b.body=M.Fa(c.getElementsByTagName("Challenge")[0].textContent).buffer}else B.debug("PlayReady request is already unwrapped."),b.headers["Content-Type"]=
"text/xml; charset=utf-8"}function hd(b){var c=new Uint8Array(b.body);c="spc="+M.Hc(c);b.headers["Content-Type"]="application/x-www-form-urlencoded";b.body=Fc(c)}function id(b){try{var c=Cc(b.data)}catch(d){return}c=c.trim();"<ckc>"===c.substr(0,5)&&"</ckc>"===c.substr(-6)&&(c=c.slice(5,-6));try{c=JSON.parse(c).ckc}catch(d){}b.data=M.Fa(c).buffer}
l.qe=function(b){b=b.target;B.J("Key status changed for session",b.sessionId);var c=this.b.get(b),d=!1;b.keyStatuses.forEach(function(b,e){if("string"==typeof e){var f=e;e=b;b=f}if("com.microsoft.playready"==this.a.keySystem&&16==e.byteLength&&(yc("Trident/")||wc())){f=new DataView(e);var g=f.getUint32(0,!0),m=f.getUint16(4,!0),n=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,m,!1);f.setUint16(6,n,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==b&&(b="usable");"status-pending"!=
b&&(c.loaded=!0);"expired"==b&&(d=!0);f=M.Ic(new Uint8Array(e));this.sa.set(f,b)}.bind(this));var e=b.expiration-Date.now();(0>e||d&&1E3>e)&&c&&!c.Ca&&(B.debug("Session has expired",b.sessionId),this.b["delete"](b),b.close()["catch"](function(){}));ed(this)&&(this.o.resolve(),this.T.R(kd))};function Ic(b){var c=b.sa,d=b.$;d.clear();c.forEach(function(b,c){return d.set(c,b)});c=Array.from(d.values());c.length&&c.every(function(b){return"expired"==b})&&b.g(new E(2,6,6014));b.F.yc(oc(d))}
function ld(){function b(b){return u(function h(){var c,f,n;return x(h,function(h){switch(h.j){case 1:return Aa(h,2),v(h,navigator.requestMediaKeySystemAccess(b,d),4);case 4:return c=h.s,n=(f=c.getConfiguration().sessionTypes)?f.includes("persistent-license"):!1,yc("Tizen 3")&&(n=!1),e.set(b,{persistentState:n}),v(h,c.createMediaKeys(),5);case 5:Ea(h,0);break;case 2:Fa(h),e.set(b,null),w(h)}})})}var c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],d=[{videoCapabilities:c,
persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:c}],e=new Map;c="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(c){return b(c)});return Promise.all(c).then(function(){return oc(e)})}
function md(b,c){var d=c.audio,e=c.video;if(d&&d.encrypted&&!wc()&&!b.u.has(pc(d.mimeType,d.codecs).toLowerCase())||e&&e.encrypted&&!wc()&&!b.u.has(pc(e.mimeType,e.codecs).toLowerCase()))return!1;var f=bd(b.a);return 0==c.drmInfos.length||c.drmInfos.some(function(b){return b.keySystem==f})}
function nd(b,c){if(!b.length)return c;if(!c.length)return b;for(var d=[],e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(b[e].keySystem==c[f].keySystem){var g=b[e];f=c[f];var h=[];h=h.concat(g.initData||[]);h=h.concat(f.initData||[]);var k=[];k=k.concat(g.keyIds);k=k.concat(f.keyIds);d.push({keySystem:g.keySystem,licenseServerUri:g.licenseServerUri||f.licenseServerUri,distinctiveIdentifierRequired:g.distinctiveIdentifierRequired||f.distinctiveIdentifierRequired,persistentStateRequired:g.persistentStateRequired||
f.persistentStateRequired,videoRobustness:g.videoRobustness||f.videoRobustness,audioRobustness:g.audioRobustness||f.audioRobustness,serverCertificate:g.serverCertificate||f.serverCertificate,initData:h,keyIds:k});break}return d}
function od(b){return u(function d(){var e;return x(d,function(d){switch(d.j){case 1:return e=new Promise(function(b,d){(new D(d)).R(pd)}),Aa(d,2),v(d,Promise.race([Promise.all([b.close(),b.closed]),e]),4);case 4:Ea(d,0);break;case 2:Fa(d),B.m("Timeout waiting for session close"),w(d)}})})}
function Lc(b){return u(function d(){var e;return x(d,function(d){switch(d.j){case 1:return e=Array.from(b.b.keys()),b.b.clear(),v(d,Promise.all(e.map(function(b){return u(function k(){return x(k,function(d){switch(d.j){case 1:return B.D("Closing session",b.sessionId),Aa(d,2),v(d,od(b),4);case 4:Ea(d,0);break;case 2:Fa(d),w(d)}})})})),0)}})})}function Jc(b){b.b.forEach(function(c,d){var e=c.rd,f=d.expiration;isNaN(f)&&(f=Infinity);f!=e&&(b.F.onExpirationUpdated(d.sessionId,f),c.rd=f)})}
function ed(b){b=b.b.values();return mc(b,function(b){return b.loaded})}function Sc(b,c){var d=[];c.forEach(function(b,c){d.push({keySystem:c,licenseServerUri:b,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var e=t(b),f=e.next();!f.done;f=e.next())f.value.drmInfos=d}
function dd(b,c,d,e,f){b.forEach(function(b){c.includes(b.licenseServerUri)||c.push(b.licenseServerUri);b.serverCertificate&&(d.some(function(c){return M.Da(c,b.serverCertificate)})||d.push(b.serverCertificate));b.initData&&b.initData.forEach(function(b){e.some(function(c){return c.keyId&&c.keyId==b.keyId?!0:c.initDataType==b.initDataType&&M.Da(c.initData,b.initData)})||e.push(b)});if(b.keyIds)for(var g=0;g<b.keyIds.length;++g)f.includes(b.keyIds[g])||f.push(b.keyIds[g])})}
function Tc(b,c,d){if(b.keySystem&&("org.w3.clearkey"!=b.keySystem||!b.licenseServerUri)){c.size&&(c=c.get(b.keySystem)||"",b.licenseServerUri=c);b.keyIds||(b.keyIds=[]);if(d=d.get(b.keySystem))b.distinctiveIdentifierRequired||(b.distinctiveIdentifierRequired=d.distinctiveIdentifierRequired),b.persistentStateRequired||(b.persistentStateRequired=d.persistentStateRequired),b.videoRobustness||(b.videoRobustness=d.videoRobustness),b.audioRobustness||(b.audioRobustness=d.audioRobustness),b.serverCertificate||
(b.serverCertificate=d.serverCertificate);window.cast&&window.cast.__platform__&&"com.microsoft.playready"==b.keySystem&&(b.keySystem="com.chromecast.playready")}}var pd=1,jd=5,kd=.5;function qd(){this.a=new muxjs.mp4.CaptionParser;this.g=[];this.f={}}qd.prototype.init=function(b){var c=muxjs.mp4.probe;b=new Uint8Array(b);this.g=c.videoTrackIds(b);this.f=c.timescale(b);this.a.init()};qd.prototype.b=function(b,c){var d=new Uint8Array(b);(d=this.a.parse(d,this.g,this.f))&&d.captions&&c(d.captions);this.a.clearParsedCaptions()};qd.prototype.c=function(){this.a.resetCaptionStream()};function rd(){}rd.prototype.init=function(){};rd.prototype.b=function(){};rd.prototype.c=function(){};function sd(b){return!b||1==b.length&&1E-6>b.end(0)-b.start(0)?null:b.length?b.end(b.length-1):null}function td(b,c,d){d=void 0===d?0:d;return!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0)||c>b.end(b.length-1)?!1:c+d>=b.start(0)}function ud(b,c){if(!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0))return 0;for(var d=0,e=b.length-1;0<=e&&b.end(e)>c;--e)d+=b.end(e)-Math.max(b.start(e),c);return d}
function vd(b){if(!b)return[];for(var c=[],d=0;d<b.length;d++)c.push({start:b.start(d),end:b.end(d)});return c};var wd={Ye:function(b,c){return b.reduce(function(b,c,f){return c["catch"](b.bind(null,f))}.bind(null,c),Promise.reject())},Oc:function(b,c){return b.concat(c)},wc:function(){},Na:function(b){return null!=b}};function xd(b,c){if(0==c.length)return b;var d=c.map(function(b){return new ib(b)});return b.map(function(b){return new ib(b)}).map(function(b){return d.map(b.resolve.bind(b))}).reduce(wd.Oc,[]).map(function(b){return b.toString()})}function yd(b,c){return{keySystem:b,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:c||[],keyIds:[]}}
var zd={Ua:"video",Nb:"audio",va:"text",Mg:"image",Kg:"application"},Ad=1/15;function Bd(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0});this.b=null;this.g=[];this.c=[];this.f=!1;this.a.on("data",this.i.bind(this));this.a.on("done",this.h.bind(this))}Bd.prototype.destroy=function(){this.a.dispose();this.a=null;return Promise.resolve()};function Cd(b,c){return window.muxjs&&"mp2t"==b.toLowerCase().split(";")[0].split("/")[1]?c?MediaSource.isTypeSupported(Dd(c,b)):MediaSource.isTypeSupported(Dd("audio",b))||MediaSource.isTypeSupported(Dd("video",b)):!1}
function Dd(b,c){var d=c.replace(/mp2t/i,"mp4");"audio"==b&&(d=d.replace("video","audio"));var e=/avc1\.(66|77|100)\.(\d+)/.exec(d);if(e){var f="avc1.",g=e[1],h=Number(e[2]);f=("66"==g?f+"4200":"77"==g?f+"4d00":f+"6400")+(h>>4).toString(16);f+=(h&15).toString(16);d=d.replace(e[0],f)}return d}function Ed(b,c){b.f=!0;b.b=new G;b.g=[];b.c=[];var d=new Uint8Array(c);b.a.push(d);b.a.flush();b.f&&b.b.reject(new E(2,3,3018));return b.b}
Bd.prototype.i=function(b){this.c=b.captions;var c=new Uint8Array(b.data.byteLength+b.initSegment.byteLength);c.set(b.initSegment,0);c.set(b.data,b.initSegment.byteLength);this.g.push(c)};Bd.prototype.h=function(){var b={data:M.concat.apply(null,this.g),captions:this.c};this.b.resolve(b);this.f=!1};function Fd(b,c,d){this.startTime=b;this.direction=Gd;this.endTime=c;this.payload=d;this.region=new Hd;this.position=null;this.positionAlign=Id;this.size=0;this.textAlign=Jd;this.writingMode=Kd;this.lineInterpretation=Ld;this.line=null;this.lineHeight="";this.lineAlign=Md;this.displayAlign=Nd;this.fontSize=this.backgroundImage=this.backgroundColor=this.color="";this.fontWeight=Od;this.fontStyle=Pd;this.fontFamily="";this.textDecoration=[];this.wrapLine=!0;this.id="";this.nestedCues=[];this.spacer=
!1}A("shaka.text.Cue",Fd);Fd.prototype.clone=function(){var b=new Fd(0,0,""),c;for(c in this)b[c]=this[c],b[c]&&b[c].constructor==Array&&(b[c]=b[c].slice());return b};var Id="auto";Fd.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Id};var Jd="center",Qd={LEFT:"left",RIGHT:"right",CENTER:Jd,START:"start",END:"end"};Fd.textAlign=Qd;var Nd="after",Rd={BEFORE:"before",CENTER:"center",AFTER:Nd};Fd.displayAlign=Rd;var Gd="ltr";Fd.direction={HORIZONTAL_LEFT_TO_RIGHT:Gd,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};
var Kd="horizontal-tb";Fd.writingMode={HORIZONTAL_TOP_TO_BOTTOM:Kd,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var Ld=0;Fd.lineInterpretation={LINE_NUMBER:Ld,PERCENTAGE:1};var Md="start",Sd={CENTER:"center",START:Md,END:"end"};Fd.lineAlign=Sd;var Od=400;Fd.fontWeight={NORMAL:Od,BOLD:700};var Pd="normal",Td={NORMAL:Pd,ITALIC:"italic",OBLIQUE:"oblique"};Fd.fontStyle=Td;Fd.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};
function Hd(){this.id="";this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0;this.height=this.width=100;this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Ud;this.scroll=Vd}A("shaka.text.CueRegion",Hd);var Ud=1;Hd.units={PX:0,PERCENTAGE:Ud,LINES:2};var Vd="";Hd.scrollMode={NONE:Vd,UP:"up"};function Wd(b){this.g=null;this.c=b;this.f=this.o=0;this.h=Infinity;this.b=this.a=null;this.l="";this.i=new Map}var Xd={};A("shaka.text.TextEngine.registerParser",function(b,c){Xd[b]=c});A("shaka.text.TextEngine.unregisterParser",function(b){delete Xd[b]});function Yd(b){return Xd[b]||window.muxjs&&"application/cea-608"==b?!0:!1}Wd.prototype.destroy=function(){this.c=this.g=null;this.i.clear();return Promise.resolve()};function Zd(b,c){"application/cea-608"!=c&&(b.g=new Xd[c])}
Wd.prototype.sc=function(b){var c={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.g.parseMedia(new Uint8Array(b),c)[0].startTime}catch(d){throw new E(2,2,2009,d);}};
function $d(b,c,d,e){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==d||null==e)this.g.parseInit(new Uint8Array(c));else{var b={periodStart:this.o,segmentStart:d,segmentEnd:e};b=this.g.parseMedia(new Uint8Array(c),b).filter(function(b){return b.startTime>=this.f&&b.startTime<this.h}.bind(this));this.c.append(b);null==this.a&&(this.a=Math.max(d,this.f));this.b=Math.min(e,this.h)}}.bind(b))}
Wd.prototype.remove=function(b,c){return Promise.resolve().then(function(){!this.c||!this.c.remove(b,c)||null==this.a||c<=this.a||b>=this.b||(b<=this.a&&c>=this.b?this.a=this.b=null:b<=this.a&&c<this.b?this.a=c:b>this.a&&c>=this.b&&(this.b=b))}.bind(this))};function ae(b,c,d){b.l=c;if(c=b.i.get(c))for(var e=t(c.keys()),f=e.next();!f.done;f=e.next())(f=c.get(f.value).filter(function(b){return b.endTime<=d}))&&b.c.append(f)}
function be(b,c,d,e,f){var g=d+" "+e,h=new Map;c=t(c);for(var k=c.next();!k.done;k=c.next()){var m=k.value;k=m.stream;h.has(k)||h.set(k,new Map);h.get(k).has(g)||h.get(k).set(g,[]);m.startTime+=f;m.endTime+=f;m.startTime>=b.f&&m.startTime<b.h&&(m=new Fd(m.startTime,m.endTime,m.text),h.get(k).get(g).push(m),k==b.l&&b.c.append([m]))}f=t(h.keys());for(g=f.next();!g.done;g=f.next())for(g=g.value,b.i.has(g)||b.i.set(g,new Map),c=t(h.get(g).keys()),k=c.next();!k.done;k=c.next())k=k.value,m=h.get(g).get(k),
b.i.get(g).set(k,m);b.a=null==b.a?Math.max(d,b.f):Math.min(b.a,Math.max(d,b.f));b.b=Math.max(b.b,Math.min(e,b.h))};function ce(b,c,d){this.f=b;this.g=d;this.b={};this.a=null;this.c={};this.i=new L;this.v=!1;this.l={};this.o=c;b=this.u=new G;c=new MediaSource;this.i.ua(c,"sourceopen",b.resolve);this.f.src=de(c);this.h=c}var de=window.URL.createObjectURL;function ee(b){var c=pc(b.mimeType,b.codecs),d=qc(b);return Yd(c)||MediaSource.isTypeSupported(d)||Cd(c,b.type)}l=ce.prototype;
l.destroy=function(){var b=this;this.v=!0;var c=[],d;for(d in this.c){var e=this.c[d],f=e[0];this.c[d]=e.slice(0,1);f&&c.push(f.p["catch"](wd.wc));for(f=1;f<e.length;++f)e[f].p.reject()}this.a&&c.push(this.a.destroy());this.g&&c.push(this.g.destroy());for(var g in this.l)c.push(this.l[g].destroy());return Promise.all(c).then(function(){b.i&&(b.i.release(),b.i=null);b.f&&(b.f.removeAttribute("src"),b.f.load(),b.f=null);b.h=null;b.a=null;b.g=null;b.b={};b.l={};b.o=null;b.c={}})};
l.init=function(b,c){var d=this;return u(function f(){var g;return x(f,function(f){switch(f.j){case 1:return g=zd,v(f,d.u,2);case 2:b.forEach(function(b,f){var h=pc(b.mimeType,b.codecs);f==g.va?fe(d,h):(!c&&MediaSource.isTypeSupported(h)||!Cd(h,f)||(d.l[f]=new Bd,h=Dd(f,h)),h=d.h.addSourceBuffer(h),d.i.B(h,"error",d.vg.bind(d,f)),d.i.B(h,"updateend",d.Gb.bind(d,f)),d.b[f]=h,d.c[f]=[])}),w(f)}})})};function fe(b,c){b.a||(b.a=new Wd(b.g));Zd(b.a,c)}
function ge(b){return b.h?"ended"==b.h.readyState:!0}function he(b,c){if("text"==c)var d=b.a.a;else d=ie(b,c),d=!d||1==d.length&&1E-6>d.end(0)-d.start(0)?null:1==d.length&&0>d.start(0)?0:d.length?d.start(0):null;return d}function je(b,c){return"text"==c?b.a.b:sd(ie(b,c))}function ke(b,c,d){if("text"==c)return b=b.a,null==b.b||b.b<d?0:b.b-Math.max(d,b.a);b=ie(b,c);return ud(b,d)}
l.$c=function(b){b.total=vd(this.f.buffered);b.audio=vd(ie(this,"audio"));b.video=vd(ie(this,"video"));b.text=[];if(this.a){var c=this.a.a,d=this.a.b;null!=c&&null!=d&&b.text.push({start:c,end:d})}};function ie(b,c){try{return b.b[c].buffered}catch(d){return c in b.b&&B.error("failed to get buffered range for "+c,d),null}}
function le(b,c,d,e,f,g){if("text"==c)return $d(b.a,d,e,f);if(b.l[c])return Ed(b.l[c],d).then(function(b){this.a||fe(this,"text/vtt");b.captions&&b.captions.length&&be(this.a,b.captions,e,f,this.b.video.timestampOffset);return me(this,c,this.Fe.bind(this,c,b.data.buffer))}.bind(b));g&&window.muxjs&&(b.a||fe(b,"text/vtt"),null==e&&null==f?b.o.init(d):b.o.b(d,function(c){c.length&&be(b.a,c,e,f,b.b.video.timestampOffset)}));return me(b,c,b.Fe.bind(b,c,d))}
function ne(b,c){var d=je(b,"video")||0;ae(b.a,c,d)}l.remove=function(b,c,d){return"text"==b?this.a.remove(c,d):me(this,b,this.Ge.bind(this,b,c,d))};function oe(b,c){if("text"==c){if(!b.a)return Promise.resolve();b.o.c();return b.a.remove(0,Infinity)}return me(b,c,b.Ge.bind(b,c,0,b.h.duration))}l.flush=function(b){return"text"==b?Promise.resolve():me(this,b,this.cf.bind(this,b))};
function pe(b,c,d,e,f){return"text"==c?(b.a.o=d,b=b.a,b.f=e,b.h=f,Promise.resolve()):Promise.all([me(b,c,b.Pe.bind(b,c)),me(b,c,b.ug.bind(b,c,d)),me(b,c,b.rg.bind(b,c,e,f))])}l.endOfStream=function(b){return qe(this,function(){ge(this)||(b?this.h.endOfStream(b):this.h.endOfStream())}.bind(this))};l.Ba=function(b){return qe(this,function(){this.h.duration=b}.bind(this))};l.ca=function(){return this.h.duration};l.Fe=function(b,c){this.b[b].appendBuffer(c)};
l.Ge=function(b,c,d){d<=c?this.Gb(b):this.b[b].remove(c,d)};l.Pe=function(b){var c=this.b[b].appendWindowStart,d=this.b[b].appendWindowEnd;this.b[b].abort();this.b[b].appendWindowStart=c;this.b[b].appendWindowEnd=d;this.Gb(b)};l.cf=function(b){this.f.currentTime-=.001;this.Gb(b)};l.ug=function(b,c){0>c&&(c+=.001);this.b[b].timestampOffset=c;this.Gb(b)};l.rg=function(b,c,d){this.b[b].appendWindowStart=0;this.b[b].appendWindowEnd=d;this.b[b].appendWindowStart=c;this.Gb(b)};
l.vg=function(b){this.c[b][0].p.reject(new E(2,3,3014,this.f.error?this.f.error.code:0))};l.Gb=function(b){var c=this.c[b][0];c&&(c.p.resolve(),re(this,b))};function me(b,c,d){if(b.v)return Promise.reject();d={start:d,p:new G};b.c[c].push(d);if(1==b.c[c].length)try{d.start()}catch(e){"QuotaExceededError"==e.name?d.p.reject(new E(2,3,3017,c)):d.p.reject(new E(2,3,3015,e)),re(b,c)}return d.p}
function qe(b,c){if(b.v)return Promise.reject();var d=[],e;for(e in b.b){var f=new G,g={start:function(b){b.resolve()}.bind(null,f),p:f};b.c[e].push(g);d.push(f);1==b.c[e].length&&g.start()}return Promise.all(d).then(function(){try{c()}catch(m){var b=Promise.reject(new E(2,3,3015,m))}for(var d in this.b)re(this,d);return b}.bind(b),function(b){throw b;}.bind(b))}function re(b,c){b.c[c].shift();var d=b.c[c][0];if(d)try{d.start()}catch(e){d.p.reject(new E(2,3,3015,e)),re(b,c)}};function se(b,c){b=N(b);c=N(c);return b.split("-")[0]==c.split("-")[0]}function te(b,c){b=N(b);c=N(c);var d=b.split("-"),e=c.split("-");return d[0]==e[0]&&1==d.length&&2==e.length}function N(b){var c=b.split("-");b=c[0]||"";c=c[1]||"";b=b.toLowerCase();b=ue.get(b)||b;return(c=c.toUpperCase())?b+"-"+c:b}function ve(b){return b.language?N(b.language):b.audio&&b.audio.language?N(b.audio.language):b.video&&b.video.language?N(b.video.language):"und"}
function we(b,c){for(var d=N(b),e=new Set,f=t(c),g=f.next();!g.done;g=f.next())e.add(N(g.value));f=t(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,g==d)return g;f=t(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,te(g,d))return g;f=t(e);for(g=f.next();!g.done;g=f.next()){var h=g=g.value,k=d;h=N(h);k=N(k);h=h.split("-");k=k.split("-");if(2==h.length&&2==k.length&&h[0]==k[0])return g}e=t(e);for(g=e.next();!g.done;g=e.next())if(f=g.value,te(d,f))return f;return null}
var ue=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze",
"cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice",
"is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao",
"mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san",
"sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie",
"vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);var O={Vd:function(b,c){function d(b){var c="";b.video&&(c=sc(b.video.codecs)[0]);var d="";b.audio&&(d=sc(b.audio.codecs)[0]);return c+"-"+d}var e=b.periods.reduce(function(b,c){return b.concat(c.variants)},[]);e=O.$d(e,c);var f=new Lb;e=t(e);for(var g=e.next();!g.done;g=e.next()){g=g.value;var h=d(g);f.push(h,g)}var k=null,m=Infinity;f.forEach(function(b,c){for(var d=0,e=0,f=t(c),g=f.next();!g.done;g=f.next())d+=g.value.bandwidth||0,++e;d/=e;B.debug("codecs",b,"avg bandwidth",d);d<m&&(k=b,m=d)});
f=t(b.periods);for(e=f.next();!e.done;e=f.next())e=e.value,e.variants=e.variants.filter(function(b){if(d(b)==k)return!0;B.debug("Dropping Variant (better codec available)",b);return!1})},ld:function(b,c,d){function e(b,c,d){return b>=c&&b<=d}var f=b.video;return f&&f.width&&f.height&&(!e(f.width,c.minWidth,Math.min(c.maxWidth,d.width))||!e(f.height,c.minHeight,Math.min(c.maxHeight,d.height))||!e(f.width*f.height,c.minPixels,c.maxPixels))||b&&b.video&&b.video.frameRate&&!e(b.video.frameRate,c.minFrameRate,
c.maxFrameRate)||!e(b.bandwidth,c.minBandwidth,c.maxBandwidth)?!1:!0},Sd:function(b,c,d){var e=!1;b.forEach(function(b){var f=b.allowedByApplication;b.allowedByApplication=O.ld(b,c,d);f!=b.allowedByApplication&&(e=!0)});return e},filterNewPeriod:function(b,c,d,e){e.variants=e.variants.filter(function(e){if(b&&b.V&&!md(b,e))return B.debug("Dropping variant - not compatible with key system",e),!1;var f=e.audio;e=e.video;return f&&!ee(f)?(B.debug("Dropping variant - audio not compatible with platform",
O.yb(f)),!1):e&&!ee(e)?(B.debug("Dropping variant - video not compatible with platform",O.yb(e)),!1):f&&c&&!O.Td(f,c)?(B.debug("Droping variant - not compatible with active audio","active audio",O.yb(c),"variant.audio",O.yb(f)),!1):e&&d&&!O.Td(e,d)?(B.debug("Droping variant - not compatible with active video","active video",O.yb(d),"variant.video",O.yb(e)),!1):!0});e.textStreams=e.textStreams.filter(function(b){var c=Yd(pc(b.mimeType,b.codecs));c||B.debug("Dropping text stream. Is not supported by the platform.",
b);return c})},Td:function(b,c){return b.mimeType!=c.mimeType||b.codecs.split(".")[0]!=c.codecs.split(".")[0]?!1:!0},Qd:function(b){var c=b.audio,d=b.video,e=c?c.codecs:null,f=d?d.codecs:null,g=[];f&&g.push(f);e&&g.push(e);var h=[];d&&h.push(d.mimeType);c&&h.push(c.mimeType);h=h[0]||null;var k=[];c&&k.push(c.kind);d&&k.push(d.kind);k=k[0]||null;var m=new Set;c&&c.roles.forEach(function(b){return m.add(b)});d&&d.roles.forEach(function(b){return m.add(b)});b={id:b.id,active:!1,type:"variant",bandwidth:b.bandwidth,
language:b.language,label:null,kind:k,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:h,codecs:g.join(", "),audioCodec:e,videoCodec:f,primary:b.primary,roles:Array.from(m),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};d&&(b.videoId=d.id,b.originalVideoId=d.originalId,b.width=d.width||null,b.height=d.height||null,b.frameRate=d.frameRate||
null,b.pixelAspectRatio=d.pixelAspectRatio||null,b.videoBandwidth=d.bandwidth||null);c&&(b.audioId=c.id,b.originalAudioId=c.originalId,b.channelsCount=c.channelsCount,b.audioSamplingRate=c.audioSamplingRate,b.audioBandwidth=c.bandwidth||null,b.label=c.label,b.audioRoles=c.roles);return b},Fc:function(b){return{id:b.id,active:!1,type:"text",bandwidth:0,language:b.language,label:b.label,kind:b.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:b.mimeType,codecs:b.codecs||
null,audioCodec:null,videoCodec:null,primary:b.primary,roles:b.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:b.originalId}},ed:function(b){b.__shaka_id||(b.__shaka_id=O.Lf++);return b.__shaka_id},Lf:0,Ff:function(b){var c=O.ee(b);c.active="disabled"!=b.mode;c.type="text";c.originalTextId=b.id;"captions"==b.kind&&(c.mimeType="application/cea-608");b.kind&&(c.roles=
[b.kind]);return c},de:function(b){var c=O.ee(b);c.active=b.enabled;c.type="variant";c.originalAudioId=b.id;"main"==b.kind&&(c.primary=!0);b.kind&&(c.roles=[b.kind],c.audioRoles=[b.kind]);return c},ee:function(b){return{id:O.ed(b),active:!1,type:"",bandwidth:0,language:N(b.language),label:b.label,kind:b.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,
audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Bb:function(b){return b.allowedByApplication&&b.allowedByKeySystem},tf:function(b){return b.filter(function(b){return O.Bb(b)})},$d:function(b,c){var d=b.filter(function(b){return b.audio&&b.audio.channelsCount}),e=new Map;d=t(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=f.audio.channelsCount;e.has(g)||e.set(g,[]);e.get(g).push(f)}d=Array.from(e.keys());if(0==
d.length)return b;f=d.filter(function(b){return b<=c});return f.length?e.get(Math.max.apply(null,f)):e.get(Math.min.apply(null,d))},Sb:function(b,c,d){var e=b,f=b.filter(function(b){return b.primary});f.length&&(e=f);var g=e.length?e[0].language:"";e=e.filter(function(b){return b.language==g});if(c){var h=we(N(c),b.map(function(b){return b.language}));h&&(e=b.filter(function(b){return N(b.language)==h}))}if(d){b=O.Zd(e,d);if(b.length)return b;B.m("No exact match for the text role could be found.")}else if(b=
e.filter(function(b){return 0==b.roles.length}),b.length)return b;b=e.map(function(b){return b.roles}).reduce(wd.Oc,[]);return b.length?O.Zd(e,b[0]):e},Zd:function(b,c){return b.filter(function(b){return b.roles.includes(c)})},ce:function(b,c,d){for(var e=0;e<d.length;e++)if(d[e].audio==b&&d[e].video==c)return d[e];return null},Gf:function(b){return"audio"==b.type},Jf:function(b){return"video"==b.type},Cf:function(b){var c=[];b.audio&&c.push(b.audio);b.video&&c.push(b.video);return c},yb:function(b){return O.Gf(b)?
"type=audio codecs="+b.codecs+" bandwidth="+b.bandwidth+" channelsCount="+b.channelsCount+" audioSamplingRate="+b.audioSamplingRate:O.Jf(b)?"type=video codecs="+b.codecs+" bandwidth="+b.bandwidth+" frameRate="+b.frameRate+" width="+b.width+" height="+b.height:"unexpected stream type"}};function P(){this.h=null;this.c=!1;this.b=new gb;this.g=[];this.i=!1;this.a=this.f=null}A("shaka.abr.SimpleAbrManager",P);P.prototype.stop=function(){this.h=null;this.c=!1;this.g=[];this.f=null};P.prototype.stop=P.prototype.stop;P.prototype.init=function(b){this.h=b};P.prototype.init=P.prototype.init;
P.prototype.chooseVariant=function(){var b=xe(this.a.restrictions,this.g),c=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!b.length&&(B.m("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),b=xe(null,this.g),b=[b[0]]);for(var d=b[0]||null,e=0;e<b.length;++e){var f=b[e],g=f.bandwidth/this.a.bandwidthDowngradeTarget,h=(b[e+1]||{bandwidth:Infinity}).bandwidth/this.a.bandwidthUpgradeTarget;B.J("Bandwidth ranges:",(f.bandwidth/1E6).toFixed(3),
(g/1E6).toFixed(3),(h/1E6).toFixed(3));c>=g&&c<=h&&(d=f)}this.f=Date.now();return d};P.prototype.chooseVariant=P.prototype.chooseVariant;P.prototype.enable=function(){this.c=!0};P.prototype.enable=P.prototype.enable;P.prototype.disable=function(){this.c=!1};P.prototype.disable=P.prototype.disable;
P.prototype.segmentDownloaded=function(b,c){B.J("Segment downloaded:","deltaTimeMs="+b,"numBytes="+c,"lastTimeChosenMs="+this.f,"enabled="+this.c);var d=this.b;if(!(16E3>c)){var e=8E3*c/b,f=b/1E3;d.a+=c;eb(d.b,f,e);eb(d.c,f,e)}if(null!=this.f&&this.c)a:{B.J("Suggesting Streams...");if(!this.i){if(!(128E3<=this.b.a)){B.J("Still waiting for a good estimate...");break a}this.i=!0}else if(Date.now()-this.f<1E3*this.a.switchInterval){B.J("Still within switch interval...");break a}d=this.chooseVariant();
e=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);B.debug("Calling switch_(), bandwidth="+Math.round(e/1E3)+" kbps");this.h(d)}};P.prototype.segmentDownloaded=P.prototype.segmentDownloaded;P.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)};P.prototype.getBandwidthEstimate=P.prototype.getBandwidthEstimate;P.prototype.setVariants=function(b){this.g=b};P.prototype.setVariants=P.prototype.setVariants;
P.prototype.configure=function(b){this.a=b};P.prototype.configure=P.prototype.configure;function xe(b,c){b&&(c=c.filter(function(c){return O.ld(c,b,{width:Infinity,height:Infinity})}));return c.sort(function(b,c){return b.bandwidth-c.bandwidth})};function ye(b,c){this.a=b;this.b=c}ye.prototype.toString=function(){return"v"+this.a+"."+this.b};function ze(b,c){var d=new ye(2,6),e=Ae,f=e.a,g=d.b-f.b;(0<(d.a-f.a||g)?e.c:e.b)(e.a,d,b,c)}function Be(b,c,d,e){B.Z([d,"has been deprecated and will be removed in",c,". We are currently at version",b,". Additional information:",e].join(" "))}function Ce(b,c,d,e){B.jc([d,"has been deprecated and has been removed in",c,". We are now at version",b,". Additional information:",e].join(""))}var Ae=null;var De="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Ee="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Fe=["loop","playbackRate"],Ge=["pause","play"],He="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),
Ie={getAssetUri:2,getAudioLanguages:2,getAudioLanguagesAndRoles:2,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:2,getTextLanguagesAndRoles:2,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},Je={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},Ke=[["getConfiguration","configure"]],Le=[["isTextTrackVisible","setTextTrackVisibility"]],
Me="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),Ne=["attach","detach","load","unload"];
function Oe(b){return JSON.stringify(b,function(b,d){if("function"!=typeof d){if(d instanceof Event||d instanceof J){var c={};for(g in d){var f=d[g];f&&"object"==typeof f?"detail"==g&&(c[g]=f):g in Event||(c[g]=f)}return c}if(d instanceof Error){var g=new Set(["name","message","stack"]);for(c in d)g.add(c);f=t(Object.getOwnPropertyNames(d));for(c=f.next();!c.done;c=f.next())g.add(c.value);f={};g=t(g);for(c=g.next();!c.done;c=g.next())c=c.value,f[c]=d[c];g={__type__:"Error",contents:f}}else if(d instanceof
TimeRanges)for(g={__type__:"TimeRanges",length:d.length,start:[],end:[]},c=0;c<d.length;++c)g.start.push(d.start(c)),g.end.push(d.end(c));else g=d instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(d)}:"number"==typeof d?isNaN(d)?"NaN":isFinite(d)?d:0>d?"-Infinity":"Infinity":d;return g}})}
function Pe(b){return JSON.parse(b,function(b,d){if("NaN"==d)var c=NaN;else if("-Infinity"==d)c=-Infinity;else if("Infinity"==d)c=Infinity;else if(d&&"object"==typeof d&&"TimeRanges"==d.__type__)c=Qe(d);else if(d&&"object"==typeof d&&"Uint8Array"==d.__type__)c=new Uint8Array(d.entries);else if(d&&"object"==typeof d&&"Error"==d.__type__){c=d.contents;var f=Error(c.message),g;for(g in c)f[g]=c[g];c=f}else c=d;return c})}
function Qe(b){return{length:b.length,start:function(c){return b.start[c]},end:function(c){return b.end[c]}}};function Re(b,c,d,e,f,g){this.T=b;this.f=new D(c);this.V=d;this.l=!1;this.v=e;this.K=f;this.G=g;this.b=this.h=!1;this.H="";this.i=null;this.o=this.sd.bind(this);this.u=this.Sf.bind(this);this.a={video:{},player:{}};this.F=0;this.c={};this.g=null;Se.add(this)}var Te=!1,Ue=null;l=Re.prototype;l.destroy=function(){Se["delete"](this);Ve(this);Ue&&We(this);this.f&&(this.f.stop(),this.f=null);this.K=this.v=null;this.b=this.h=!1;this.u=this.o=this.g=this.c=this.a=this.i=null;return Promise.resolve()};
l.ha=function(){return this.b};l.xd=function(){return this.H};
l.init=function(){if(window.chrome&&chrome.cast&&chrome.cast.isAvailable&&this.T.length){this.h=!0;this.f.Gc();var b=new chrome.cast.SessionRequest(this.T);b=new chrome.cast.ApiConfig(b,Xe.bind(this),Ye.bind(this),"origin_scoped");chrome.cast.initialize(b,function(){B.debug("CastSender: init")},function(b){B.error("CastSender: init error",b)});Te&&this.f.R(.02);(b=Ue)&&b.status!=chrome.cast.SessionStatus.STOPPED?(B.debug("CastSender: re-using existing connection"),Ze(this,b)):Ue=null}};
l.Gd=function(b){this.i=b;this.b&&$e(this,{type:"appData",appData:this.i})};l.cast=function(b){if(!this.h)return Promise.reject(new E(1,8,8E3));if(!Te)return Promise.reject(new E(1,8,8001));if(this.b)return Promise.reject(new E(1,8,8002));this.g=new G;chrome.cast.requestSession(this.ud.bind(this,b),this.pe.bind(this));return this.g};l.vb=function(){if(this.b){Ve(this);if(Ue){We(this);try{Ue.stop(function(){},function(){})}catch(b){}Ue=null}this.sd()}};
l.get=function(b,c){if("video"==b){if(Ge.includes(c))return this.ye.bind(this,b,c)}else if("player"==b){if(Je[c]&&!this.get("player","isLive")())return function(){};if(Me.includes(c))return this.ye.bind(this,b,c);if(Ne.includes(c))return this.ig.bind(this,b,c);if(Ie[c])return this.ve.bind(this,b,c)}return this.ve(b,c)};l.set=function(b,c,d){this.a[b][c]=d;$e(this,{type:"set",targetName:b,property:c,value:d})};
l.ud=function(b,c){B.debug("CastSender: onSessionInitiated");Ue=c;c.addUpdateListener(this.o);c.addMessageListener("urn:x-cast:com.google.shaka.v2",this.u);this.sd();$e(this,{type:"init",initState:b,appData:this.i});this.g.resolve()};l.pe=function(b){var c=8003;switch(b.code){case "cancel":c=8004;break;case "timeout":c=8005;break;case "receiver_unavailable":c=8006}this.g.reject(new E(2,8,c,b))};l.ve=function(b,c){return this.a[b][c]};
l.ye=function(b,c,d){for(var e=[],f=2;f<arguments.length;++f)e[f-2]=arguments[f];$e(this,{type:"call",targetName:b,methodName:c,args:e})};l.ig=function(b,c,d){for(var e=[],f=2;f<arguments.length;++f)e[f-2]=arguments[f];f=new G;var g=this.F.toString();this.F++;this.c[g]=f;try{$e(this,{type:"asyncCall",targetName:b,methodName:c,args:e,id:g})}catch(h){f.reject(h)}return f};function Xe(b){for(var c=t(Se),d=c.next();!d.done;d=c.next())Ze(d.value,b)}
function Ze(b,c){B.debug("CastSender: onExistingSessionJoined");var d=b.G();b.g=new G;b.l=!0;b.ud(d,c)}function Ye(b){for(var c=t(Se),d=c.next();!d.done;d=c.next()){d=d.value;var e=b;B.debug("CastSender: receiver status",e);Te="available"==e;d.f.Gc()}}function We(b){var c=Ue;c.removeUpdateListener(b.o);c.removeMessageListener("urn:x-cast:com.google.shaka.v2",b.u)}
l.sd=function(){var b=Ue?"connected"==Ue.status:!1;B.debug("CastSender: connection status",b);if(this.b&&!b){this.K();for(var c in this.a)this.a[c]={};Ve(this)}this.H=(this.b=b)?Ue.receiver.friendlyName:"";this.f.Gc()};function Ve(b){for(var c in b.c){var d=b.c[c];delete b.c[c];d.reject(new E(1,7,7E3))}}
l.Sf=function(b,c){var d=Pe(c);B.J("CastSender: message",d);switch(d.type){case "event":var e=d.event;this.v(d.targetName,new J(e.type,e));break;case "update":e=d.update;for(var f in e){d=this.a[f]||{};for(var g in e[f])d[g]=e[f][g]}this.l&&(this.V(),this.l=!1);break;case "asyncComplete":if(f=d.id,d=d.error,g=this.c[f],delete this.c[f],g)if(d){f=new E(d.severity,d.category,d.code);for(e in d)f[e]=d[e];g.reject(f)}else g.resolve()}};
function $e(b,c){var d=Oe(c),e=Ue;try{e.sendMessage("urn:x-cast:com.google.shaka.v2",d,function(){},B.error)}catch(f){throw B.error("Cast session sendMessage threw",f),d=new E(2,8,8005,f),b.v("player",new J("error",{detail:d})),b.vb(),d;}}var Se=new Set;window.__onGCastApiAvailable=function(b){if(b){b=t(Se);for(var c=b.next();!c.done;c=b.next())c.value.init()}};function Q(b,c,d){var e=this;Mb.call(this);this.c=b;this.b=c;this.i=this.g=this.f=this.l=this.h=null;this.u=d;this.o=new Map;this.a=new Re(d,function(){return af(e)},function(){return bf(e)},function(b,c){return cf(e,b,c)},function(){return df(e)},function(){return ef(e)});ff(this)}cb(Q,Mb);A("shaka.cast.CastProxy",Q);
Q.prototype.destroy=function(b){b&&this.a.vb();this.i&&(this.i.release(),this.i=null);b=[];this.b&&(b.push(this.b.destroy()),this.b=null);this.a&&(b.push(this.a.destroy()),this.a=null);this.l=this.h=this.c=null;return Promise.all(b)};Q.prototype.destroy=Q.prototype.destroy;Q.prototype.Df=function(){return this.h};Q.prototype.getVideo=Q.prototype.Df;Q.prototype.vf=function(){return this.l};Q.prototype.getPlayer=Q.prototype.vf;Q.prototype.Se=function(){return this.a.h&&Te};Q.prototype.canCast=Q.prototype.Se;
Q.prototype.ha=function(){return this.a.ha()};Q.prototype.isCasting=Q.prototype.ha;Q.prototype.xd=function(){return this.a.xd()};Q.prototype.receiverName=Q.prototype.xd;Q.prototype.cast=function(){var b=ef(this);return this.a.cast(b).then(function(){if(this.b)return this.b.Od()}.bind(this))};Q.prototype.cast=Q.prototype.cast;Q.prototype.Gd=function(b){this.a.Gd(b)};Q.prototype.setAppData=Q.prototype.Gd;
Q.prototype.Cg=function(){var b=this.a;if(b.b){var c=b.G();chrome.cast.requestSession(b.ud.bind(b,c),b.pe.bind(b))}};Q.prototype.suggestDisconnect=Q.prototype.Cg;
Q.prototype.Ve=function(b){var c=this;return u(function e(){return x(e,function(e){switch(e.j){case 1:if(b==c.u)return e["return"]();c.u=b;c.a.vb();return v(e,c.a.destroy(),2);case 2:c.a=null,c.a=new Re(b,function(){return af(c)},function(){return bf(c)},function(b,e){return cf(c,b,e)},function(){return df(c)},function(){return ef(c)}),c.a.init(),w(e)}})})};Q.prototype.changeReceiverId=Q.prototype.Ve;Q.prototype.vb=function(){this.a.vb()};Q.prototype.forceDisconnect=Q.prototype.vb;
function ff(b){b.a.init();b.i=new L;De.forEach(function(b){this.i.B(this.c,b,this.G.bind(this))}.bind(b));He.forEach(function(b){this.i.B(this.b,b,this.v.bind(this))}.bind(b));b.h={};for(var c in b.c)Object.defineProperty(b.h,c,{configurable:!1,enumerable:!0,get:b.F.bind(b,c),set:b.H.bind(b,c)});b.l={};gf(b,function(c){Object.defineProperty(b.l,c,{configurable:!1,enumerable:!0,get:function(){return hf(b,c)}})});jf(b);b.f=new Mb;b.f.gc=b.h;b.g=new Mb;b.g.gc=b.l}
function jf(b){var c=new Map;gf(b,function(d,e){if(c.has(e)){var f=c.get(e);d.length<f.length?b.o.set(d,f):b.o.set(f,d)}else c.set(e,d)})}
function gf(b,c){function d(b){return"constructor"==b||"function"!=typeof e[b]?!1:!f.has(b)}var e=b.b,f=new Set;for(g in e)d(g)&&(f.add(g),c(g,e[g]));var g=Object.getPrototypeOf(e);for(var h=Object.getPrototypeOf({});g&&g!=h;){for(var k=t(Object.getOwnPropertyNames(g)),m=k.next();!m.done;m=k.next())m=m.value,d(m)&&(f.add(m),c(m,e[m]));g=Object.getPrototypeOf(g)}}
function ef(b){var c={video:{},player:{},playerAfterLoad:{},manifest:b.b.pc(),startTime:null};b.c.pause();Fe.forEach(function(b){c.video[b]=this.c[b]}.bind(b));b.c.ended||(c.startTime=b.c.currentTime);Ke.forEach(function(b){var d=b[1];b=this.b[b[0]]();c.player[d]=b}.bind(b));Le.forEach(function(b){var d=b[1];b=this.b[b[0]]();c.playerAfterLoad[d]=b}.bind(b));return c}function af(b){b.dispatchEvent(new J("caststatuschanged"))}function bf(b){b.f.dispatchEvent(new J(b.h.paused?"pause":"play"))}
function df(b){Ke.forEach(function(b){var c=b[1];b=this.a.get("player",b[0])();this.b[c](b)}.bind(b));var c=b.a.get("player","getAssetUri")(),d=b.a.get("video","ended"),e=Promise.resolve(),f=b.c.autoplay,g=null;d||(g=b.a.get("video","currentTime"));c&&(b.c.autoplay=!1,e=b.b.load(c,g));var h={};Fe.forEach(function(b){h[b]=this.a.get("video",b)}.bind(b));e.then(function(){b.c&&(Fe.forEach(function(b){this.c[b]=h[b]}.bind(b)),Le.forEach(function(b){var c=b[1];b=this.a.get("player",b[0])();this.b[c](b)}.bind(b)),
b.c.autoplay=f,c&&b.c.play())},function(c){b.b.dispatchEvent(new J("error",{detail:c}))})}Q.prototype.F=function(b){if("addEventListener"==b)return this.f.addEventListener.bind(this.f);if("removeEventListener"==b)return this.f.removeEventListener.bind(this.f);if(this.a.ha()&&0==Object.keys(this.a.a.video).length){var c=this.c[b];if("function"!=typeof c)return c}return this.a.ha()?this.a.get("video",b):(b=this.c[b],"function"==typeof b&&(b=b.bind(this.c)),b)};
Q.prototype.H=function(b,c){this.a.ha()?this.a.set("video",b,c):this.c[b]=c};Q.prototype.G=function(b){this.a.ha()||this.f.dispatchEvent(new J(b.type,b))};
function hf(b,c){b.o.has(c)&&(c=b.o.get(c));if("addEventListener"==c)return b.g.addEventListener.bind(b.g);if("removeEventListener"==c)return b.g.removeEventListener.bind(b.g);if("getMediaElement"==c)return function(){return this.h}.bind(b);if("getSharedConfiguration"==c)return B.m("Can't share configuration across a network. Returning copy."),b.a.get("player","getConfiguration");if("getNetworkingEngine"==c)return b.a.ha()&&B.m("NOTE: getNetworkingEngine() is always local!"),b.b.Ub.bind(b.b);if(b.a.ha()){if("getManifest"==
c||"drmInfo"==c)return function(){B.Z(c+"() does not work while casting!");return null};if("getManifestUri"==c)return ze("getManifestUri",'Please use "getAssetUri" instead.'),hf(b,"getAssetUri");if("attach"==c||"detach"==c)return function(){B.Z(c+"() does not work while casting!");return Promise.resolve()}}return b.a.ha()&&0==Object.keys(b.a.a.video).length&&Ie[c]||!b.a.ha()?b.b[c].bind(b.b):b.a.get("player",c)}Q.prototype.v=function(b){this.a.ha()||this.g.dispatchEvent(b)};
function cf(b,c,d){b.a.ha()&&("video"==c?b.f.dispatchEvent(d):"player"==c&&b.g.dispatchEvent(d))};function kf(b,c,d,e){var f=this;Mb.call(this);this.a=b;this.b=c;this.c=new L;this.G={video:b,player:c};this.u=d||function(){};this.H=e||function(b){return b};this.v=!1;this.h=!0;this.g=0;this.o=!1;this.l=!0;this.i=this.f=null;this.F=new D(function(){lf(f)});mf(this)}cb(kf,Mb);A("shaka.cast.CastReceiver",kf);kf.prototype.isConnected=function(){return this.v};kf.prototype.isConnected=kf.prototype.isConnected;kf.prototype.If=function(){return this.h};kf.prototype.isIdle=kf.prototype.If;
kf.prototype.destroy=function(){var b=this;return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return b.c&&(b.c.release(),b.c=null),e=[],b.b&&(e.push(b.b.destroy()),b.b=null),b.F&&(b.F.stop(),b.F=null),b.a=null,b.G=null,b.u=null,b.v=!1,b.h=!0,b.f=null,b.i=null,v(d,Promise.all(e),2);case 2:f=cast.receiver.CastReceiverManager.getInstance(),f.stop(),w(d)}})})};kf.prototype.destroy=kf.prototype.destroy;
function mf(b){var c=cast.receiver.CastReceiverManager.getInstance();c.onSenderConnected=b.re.bind(b);c.onSenderDisconnected=b.re.bind(b);c.onSystemVolumeChanged=b.bf.bind(b);b.i=c.getCastMessageBus("urn:x-cast:com.google.cast.media");b.i.onMessage=b.Nf.bind(b);b.f=c.getCastMessageBus("urn:x-cast:com.google.shaka.v2");b.f.onMessage=b.Xf.bind(b);c.start();De.forEach(function(b){this.c.B(this.a,b,this.we.bind(this,"video"))}.bind(b));He.forEach(function(b){this.c.B(this.b,b,this.we.bind(this,"player"))}.bind(b));
cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?b.b.Hd(3840,2160):b.b.Hd(1920,1080);b.c.B(b.a,"loadeddata",function(){this.o=!0}.bind(b));b.c.B(b.b,"loading",function(){this.h=!1;nf(this)}.bind(b));b.c.B(b.a,"playing",function(){this.h=!1;nf(this)}.bind(b));b.c.B(b.a,"pause",function(){nf(this)}.bind(b));b.c.B(b.b,"unloading",function(){this.h=!0;nf(this)}.bind(b));b.c.B(b.a,"ended",function(){var b=this;(new D(function(){b.a&&b.a.ended&&
(b.h=!0,nf(b))})).R(5)}.bind(b))}l=kf.prototype;l.re=function(){this.g=0;this.l=!0;this.v=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length;nf(this)};function nf(b){Promise.resolve().then(function(){this.b&&(this.dispatchEvent(new J("caststatuschanged")),of(this)||pf(this))}.bind(b))}
function qf(b,c,d){for(var e in c.player)b.b[e](c.player[e]);b.u(d);d=Promise.resolve();var f=b.a.autoplay;c.manifest&&(b.a.autoplay=!1,d=b.b.load(c.manifest,c.startTime));d.then(function(){if(b.b){for(var d in c.video)b.a[d]=c.video[d];for(var e in c.playerAfterLoad)b.b[e](c.playerAfterLoad[e]);b.a.autoplay=f;c.manifest&&(b.a.play(),pf(b))}},function(c){b.b.dispatchEvent(new J("error",{detail:c}))})}l.we=function(b,c){this.b&&(lf(this),rf(this,{type:"event",targetName:b,event:c},this.f))};
function lf(b){b.F.R(.5);var c={video:{},player:{}};Ee.forEach(function(b){c.video[b]=this.a[b]}.bind(b));if(b.b.X())for(var d in Je)0==b.g%Je[d]&&(c.player[d]=b.b[d]());for(var e in Ie)0==b.g%Ie[e]&&(c.player[e]=b.b[e]());if(d=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())c.video.volume=d.level,c.video.muted=d.muted;b.o&&(b.g+=1);rf(b,{type:"update",update:c},b.f);of(b)}function of(b){return b.l&&(b.a.duration||b.b.X())?(sf(b),b.l=!1,!0):!1}
function sf(b,c){c=void 0===c?0:c;var d={contentId:b.b.pc(),streamType:b.b.X()?"LIVE":"BUFFERED",contentType:""};b.b.X()||(d.duration=b.a.duration);pf(b,c,d)}l.bf=function(){var b=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();b&&rf(this,{type:"update",update:{video:{volume:b.level,muted:b.muted}}},this.f);rf(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.f)};
l.Xf=function(b){var c=Pe(b.data);B.debug("CastReceiver: message",c);switch(c.type){case "init":this.g=0;this.o=!1;this.l=!0;qf(this,c.initState,c.appData);lf(this);break;case "appData":this.u(c.appData);break;case "set":var d=c.targetName,e=c.property;c=c.value;if("video"==d){var f=cast.receiver.CastReceiverManager.getInstance();if("volume"==e){f.setSystemVolumeLevel(c);break}else if("muted"==e){f.setSystemVolumeMuted(c);break}}this.G[d][e]=c;break;case "call":d=this.G[c.targetName];d[c.methodName].apply(d,
c.args);break;case "asyncCall":d=c.targetName;e=c.methodName;"player"==d&&"load"==e&&(this.g=0,this.o=!1);f=c.id;b=b.senderId;var g=this.G[d];c=g[e].apply(g,c.args);"player"==d&&"load"==e&&(c=c.then(function(){this.l=!0}.bind(this)));c.then(this.Ce.bind(this,b,f,null),this.Ce.bind(this,b,f))}};
l.Nf=function(b){var c=Pe(b.data);B.debug("CastReceiver: message",c);switch(c.type){case "PLAY":this.a.play();pf(this);break;case "PAUSE":this.a.pause();pf(this);break;case "SEEK":b=c.currentTime;var d=c.resumeState;null!=b&&(this.a.currentTime=Number(b));d&&"PLAYBACK_START"==d?(this.a.play(),pf(this)):d&&"PLAYBACK_PAUSE"==d&&(this.a.pause(),pf(this));break;case "STOP":this.b.Od().then(function(){this.b&&pf(this)}.bind(this));break;case "GET_STATUS":sf(this,Number(c.requestId));break;case "VOLUME":d=
c.volume;b=d.level;d=d.muted;var e=this.a.volume,f=this.a.muted;null!=b&&(this.a.volume=Number(b));null!=d&&(this.a.muted=d);e==this.a.volume&&f==this.a.muted||pf(this);break;case "LOAD":this.g=0;this.l=this.o=!1;b=c.media;d=c.currentTime;e=this.H(b.contentId);f=c.autoplay||!0;this.u(b.customData);f&&(this.a.autoplay=!0);this.b.load(e,d).then(function(){this.b&&sf(this)}.bind(this))["catch"](function(b){var d="LOAD_FAILED";7==b.category&&7E3==b.code&&(d="LOAD_CANCELLED");rf(this,{requestId:Number(c.requestId),
type:d},this.i)}.bind(this));break;default:B.m("Unrecognized message type from the generic Chromecast controller!",c.type),rf(this,{requestId:Number(c.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.i)}};l.Ce=function(b,c,d){this.b&&rf(this,{type:"asyncComplete",id:c,error:d},this.f,b)};function rf(b,c,d,e){b.v&&(b=Oe(c),e?d.getCastChannel(e).send(b):d.broadcast(b))}
function pf(b,c,d){c=void 0===c?0:c;d=void 0===d?null:d;var e=b.a.playbackRate;var f=tf;f=b.h?f.IDLE:b.b.fd()?f.Ke:b.a.paused?f.Me:f.Ne;e={mediaSessionId:0,playbackRate:e,playerState:f,currentTime:b.a.currentTime,supportedMediaCommands:63,volume:{level:b.a.volume,muted:b.a.muted}};d&&(e.media=d);rf(b,{requestId:c,type:"MEDIA_STATUS",status:[e]},b.i)}var tf={IDLE:"IDLE",Ne:"PLAYING",Ke:"BUFFERING",Me:"PAUSED"};function S(b,c){this.N=b;this.b=c==uf;this.a=0}A("shaka.util.DataViewReader",S);var uf=1;S.Endianness={Lg:0,Ng:uf};S.prototype.ya=function(){return this.a<this.N.byteLength};S.prototype.hasMoreData=S.prototype.ya;S.prototype.ga=function(){return this.a};S.prototype.getPosition=S.prototype.ga;S.prototype.jf=function(){return this.N.byteLength};S.prototype.getLength=S.prototype.jf;S.prototype.na=function(){try{var b=this.N.getUint8(this.a);this.a+=1;return b}catch(c){vf()}};S.prototype.readUint8=S.prototype.na;
S.prototype.$b=function(){try{var b=this.N.getUint16(this.a,this.b);this.a+=2;return b}catch(c){vf()}};S.prototype.readUint16=S.prototype.$b;S.prototype.I=function(){try{var b=this.N.getUint32(this.a,this.b);this.a+=4;return b}catch(c){vf()}};S.prototype.readUint32=S.prototype.I;S.prototype.xe=function(){try{var b=this.N.getInt32(this.a,this.b);this.a+=4;return b}catch(c){vf()}};S.prototype.readInt32=S.prototype.xe;
S.prototype.Kb=function(){try{if(this.b){var b=this.N.getUint32(this.a,!0);var c=this.N.getUint32(this.a+4,!0)}else c=this.N.getUint32(this.a,!1),b=this.N.getUint32(this.a+4,!1)}catch(d){vf()}if(2097151<c)throw new E(2,3,3001);this.a+=8;return c*Math.pow(2,32)+b};S.prototype.readUint64=S.prototype.Kb;S.prototype.gb=function(b){this.a+b>this.N.byteLength&&vf();var c=new Uint8Array(this.N.buffer,this.N.byteOffset+this.a,b);this.a+=b;return c};S.prototype.readBytes=S.prototype.gb;
S.prototype.P=function(b){this.a+b>this.N.byteLength&&vf();this.a+=b};S.prototype.skip=S.prototype.P;S.prototype.ze=function(b){this.a<b&&vf();this.a-=b};S.prototype.rewind=S.prototype.ze;S.prototype.seek=function(b){(0>b||b>this.N.byteLength)&&vf();this.a=b};S.prototype.seek=S.prototype.seek;S.prototype.wd=function(){for(var b=this.a;this.ya()&&0!=this.N.getUint8(this.a);)this.a+=1;b=new Uint8Array(this.N.buffer,this.N.byteOffset+b,this.a-b);this.a+=1;return Cc(b)};
S.prototype.readTerminatedString=S.prototype.wd;function vf(){throw new E(2,3,3E3);};function T(){this.c=[];this.b=[];this.a=!1}A("shaka.util.Mp4Parser",T);T.prototype.L=function(b,c){var d=wf(b);this.c[d]=0;this.b[d]=c;return this};T.prototype.box=T.prototype.L;T.prototype.ia=function(b,c){var d=wf(b);this.c[d]=1;this.b[d]=c;return this};T.prototype.fullBox=T.prototype.ia;T.prototype.stop=function(){this.a=!0};T.prototype.stop=T.prototype.stop;
T.prototype.parse=function(b,c){var d=new Uint8Array(b);d=new S(new DataView(d.buffer,d.byteOffset,d.byteLength),0);for(this.a=!1;d.ya()&&!this.a;)this.Ac(0,d,c)};T.prototype.parse=T.prototype.parse;
T.prototype.Ac=function(b,c,d){var e=c.ga(),f=c.I(),g=c.I();B.J("Parsing MP4 box",xf(g));switch(f){case 0:f=c.N.byteLength-e;break;case 1:f=c.Kb()}var h=this.b[g];if(h){var k=null,m=null;1==this.c[g]&&(m=c.I(),k=m>>>24,m&=16777215);g=e+f;d&&g>c.N.byteLength&&(g=c.N.byteLength);g-=c.ga();c=0<g?c.gb(g):new Uint8Array(0);c=new S(new DataView(c.buffer,c.byteOffset,c.byteLength),0);h({parser:this,partialOkay:d||!1,version:k,flags:m,reader:c,size:f,start:e+b})}else c.P(Math.min(e+f-c.ga(),c.N.byteLength-
c.ga()))};T.prototype.parseNext=T.prototype.Ac;function yf(b){for(var c=null!=b.flags?12:8;b.reader.ya()&&!b.parser.a;)b.parser.Ac(b.start+c,b.reader,b.partialOkay)}T.children=yf;function zf(b){for(var c=null!=b.flags?12:8,d=b.reader.I();0<d&&!b.parser.a;--d)b.parser.Ac(b.start+c,b.reader,b.partialOkay)}T.sampleDescription=zf;function Af(b){return function(c){b(c.reader.gb(c.reader.N.byteLength-c.reader.ga()))}}T.allData=Af;
function wf(b){for(var c=0,d=0;d<b.length;d++)c=c<<8|b.charCodeAt(d);return c}function xf(b){return String.fromCharCode(b>>24&255,b>>16&255,b>>8&255,b&255)}T.typeToString=xf;function Bf(b){var c=this;this.a=[];this.b=[];this.data=[];(new T).L("moov",yf).ia("pssh",function(b){if(1<b.version)B.m("Unrecognized PSSH version found!");else{var d=b.reader.N;d=new Uint8Array(d.buffer,d.byteOffset-12,b.size);c.data.push(d);c.a.push(M.Ic(b.reader.gb(16)));if(0<b.version){d=b.reader.I();for(var f=0;f<d;++f){var g=M.Ic(b.reader.gb(16));c.b.push(g)}}}}).parse(b);0==this.data.length&&B.m("No pssh box found!")}
function Cf(b){if(!b)return b;var c=new Bf(b);if(1>=c.data.length)return b;b=[];var d={};c=t(c.data);for(var e=c.next();!e.done;d={tc:d.tc},e=c.next())d.tc=e.value,b.some(function(b){return function(c){return M.Da(c,b.tc)}}(d))||b.push(d.tc);return M.concat.apply(M,b instanceof Array?b:Sa(t(b)))};var U={oc:function(b,c){var d=U.U(b,c);return 1!=d.length?null:d[0]},Wc:function(b,c,d){b=U.ae(b,c,d);return 1!=b.length?null:b[0]},U:function(b,c){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.tagName==c})},ae:function(b,c,d){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.localName==d&&b.namespaceURI==c})},getAttributeNS:function(b,c,d){return b.hasAttributeNS(c,d)?b.getAttributeNS(c,d):null},qc:function(b){return Array.prototype.every.call(b.childNodes,
function(b){return b.nodeType==Node.TEXT_NODE||b.nodeType==Node.CDATA_SECTION_NODE})?b.textContent.trim():null},M:function(b,c,d,e){e=void 0===e?null:e;var f=null;b=b.getAttribute(c);null!=b&&(f=d(b));return null==f?e:f},ag:function(b){if(!b)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(b)&&(b+="Z");b=Date.parse(b);return isNaN(b)?null:Math.floor(b/1E3)},Ia:function(b){if(!b)return null;var c=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(b);
if(!c)return B.m("Invalid duration string:",b),null;b=31536E3*Number(c[1]||null)+2592E3*Number(c[2]||null)+86400*Number(c[3]||null)+3600*Number(c[4]||null)+60*Number(c[5]||null)+Number(c[6]||null);return isFinite(b)?b:null},Cc:function(b){var c=/([0-9]+)-([0-9]+)/.exec(b);if(!c)return null;b=Number(c[1]);if(!isFinite(b))return null;c=Number(c[2]);return isFinite(c)?{start:b,end:c}:null},parseInt:function(b){b=Number(b);return 0===b%1?b:null},Bc:function(b){b=Number(b);return 0===b%1&&0<b?b:null},
Hb:function(b){b=Number(b);return 0===b%1&&0<=b?b:null},parseFloat:function(b){b=Number(b);return isNaN(b)?null:b},$e:function(b){var c;b=(c=b.match(/^(\d+)\/(\d+)$/))?Number(c[1])/Number(c[2]):Number(b);return isNaN(b)?null:b},ue:function(b,c){var d=new DOMParser;try{var e=d.parseFromString(b,"text/xml")}catch(g){}if(e&&e.documentElement.tagName==c)var f=e.documentElement;return f&&0<f.getElementsByTagName("parsererror").length?null:f},te:function(b,c){try{var d=Cc(b);return U.ue(d,c)}catch(e){}}};var Df=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");
function Ef(b,c,d){var e=Ff(b),f=null;b=[];var g=[],h=new Set(e.map(function(b){return b.keyId}));h["delete"](null);if(1<h.size)throw new E(2,4,4010);d||(g=e.filter(function(b){return"urn:mpeg:dash:mp4protection:2011"==b.Ae?(f=b.init||f,!1):!0}),g.length&&(b=Gf(f,c,g),0==b.length&&(b=[yd("",f)])));if(e.length&&(d||!g.length))for(b=[],c=t(Df.values()),d=c.next();!d.done;d=c.next())d=d.value,"org.w3.clearkey"!=d&&b.push(yd(d,f));if(h=Array.from(h)[0]||null)for(c=t(b),d=c.next();!d.done;d=c.next())for(d=
t(d.value.initData),e=d.next();!e.done;e=d.next())e.value.keyId=h;return{Xd:h,Pg:f,drmInfos:b,be:!0}}function Hf(b,c,d,e){var f=Ef(b,c,e);if(d.be){b=1==d.drmInfos.length&&!d.drmInfos[0].keySystem;c=0==f.drmInfos.length;if(0==d.drmInfos.length||b&&!c)d.drmInfos=f.drmInfos;d.be=!1}else if(0<f.drmInfos.length&&(d.drmInfos=d.drmInfos.filter(function(b){return f.drmInfos.some(function(c){return c.keySystem==b.keySystem})}),0==d.drmInfos.length))throw new E(2,4,4008);return f.Xd||d.Xd}
function If(b){var c=0,d=(new DataView(b)).getUint32(c,!0);c+=4;if(d!==b.byteLength)return B.m("PlayReady Object with invalid length encountered."),[];c+=2;d=[];for(var e=new DataView(b);c<b.byteLength-1;){var f=e.getUint16(c,!0);c+=2;var g=e.getUint16(c,!0);c+=2;var h=new Uint8Array(b,c,g);d.push({type:f,value:h});c+=g}return d}
function Jf(b){b=t(b.getElementsByTagName("DATA"));for(var c=b.next();!c.done;c=b.next()){c=t(c.value.childNodes);for(var d=c.next();!d.done;d=c.next())if(d=d.value,d instanceof Element&&"LA_URL"==d.tagName)return d.textContent}return""}
function Gf(b,c,d){var e=[];d=t(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=Df.get(f.Ae);if(g){var h;if(h=U.Wc(f.node,"urn:microsoft:playready","pro")){h=M.Fa(h.textContent);var k=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),m=h.length,n=k.length+16+m,p=new ArrayBuffer(n),q=new Uint8Array(p);p=new DataView(p);var r=0;p.setUint32(r,n);r+=4;p.setUint32(r,1886614376);r+=4;p.setUint32(r,0);r+=4;q.set(k,r);r+=k.length;p.setUint32(r,m);r+=4;q.set(h,r);h=[{initData:q,
initDataType:"cenc",keyId:f.keyId}]}else h=null;h=yd(g,f.init||b||h);if(g=Kf.get(g))h.licenseServerUri=g(f);e.push(h)}else for(f=c(f.node)||[],f=t(f),g=f.next();!g.done;g=f.next())e.push(g.value)}return e}
var Kf=(new Map).set("com.widevine.alpha",function(b){return(b=U.Wc(b.node,"urn:microsoft","laurl"))?b.getAttribute("licenseUrl")||"":""}).set("com.microsoft.playready",function(b){b=U.Wc(b.node,"urn:microsoft:playready","pro");if(!b)return"";b=M.Fa(b.textContent);b=If(b.buffer).filter(function(b){return 1===b.type})[0];if(!b)return"";b=Ec(b.value,!0);return(b=U.ue(b,"WRMHEADER"))?Jf(b):""});function Ff(b){var c=[];b=t(b);for(var d=b.next();!d.done;d=b.next())(d=Lf(d.value))&&c.push(d);return c}
function Lf(b){var c=b.getAttribute("schemeIdUri"),d=U.getAttributeNS(b,"urn:mpeg:cenc:2013","default_KID"),e=U.ae(b,"urn:mpeg:cenc:2013","pssh").map(U.qc);if(!c)return B.error("Missing required schemeIdUri attribute on","ContentProtection element",b),null;c=c.toLowerCase();if(d&&(d=d.replace(/-/g,"").toLowerCase(),d.includes(" ")))throw new E(2,4,4009);var f=[];try{f=e.map(function(b){return{initDataType:"cenc",initData:M.Fa(b),keyId:null}})}catch(g){throw new E(2,4,4007);}return{node:b,Ae:c,keyId:d,
init:0<f.length?f:null}};function Mf(b,c,d,e,f){var g={RepresentationID:c,Number:d,Bandwidth:e,Time:f};return b.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,d,e,f){if("$$"==c)return"$";var h=g[d];if(null==h)return B.m("URL template does not have an available substitution for identifier",'"'+d+'":',b),c;"RepresentationID"==d&&e&&(B.m("URL template should not contain a width specifier for identifier",'"RepresentationID":',b),e=void 0);"Time"==d&&(h=Math.round(h));switch(f){case void 0:case "d":case "i":case "u":c=
h.toString();break;case "o":c=h.toString(8);break;case "x":c=h.toString(16);break;case "X":c=h.toString(16).toUpperCase();break;default:c=h.toString()}e=window.parseInt(e,10)||1;return Array(Math.max(0,e-c.length)+1).join("0")+c})}
function Nf(b,c){var d=Of(b,c,"timescale"),e=1;d&&(e=U.Bc(d)||1);d=Of(b,c,"duration");(d=U.Bc(d||""))&&(d/=e);var f=Of(b,c,"startNumber"),g=Number(Of(b,c,"presentationTimeOffset"))||0,h=U.Hb(f||"");if(null==f||null==h)h=1;var k=Pf(b,c,"SegmentTimeline");f=null;if(k){f=e;var m=b.W.duration||Infinity;k=U.U(k,"S");for(var n=[],p=-g,q=0;q<k.length;++q){var r=k[q],y=U.M(r,"t",U.Hb),C=U.M(r,"d",U.Hb),z=U.M(r,"r",U.parseInt);null!=y&&(y-=g);if(!C){B.m('"S" element must have a duration:','ignoring the remaining "S" elements.',
r);break}y=null!=y?y:p;z=z||0;if(0>z)if(q+1<k.length){z=U.M(k[q+1],"t",U.Hb);if(null==z){B.m('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',r);break}else if(y>=z){B.m('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',r);break}z=Math.ceil((z-y)/C)-1}else{if(Infinity==m){B.m('The last "S" element cannot have a negative repeat',
"if the Period has an infinite duration:",'ignoring the last "S" element.',r);break}else if(y/f>=m){B.m('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',r);break}z=Math.ceil((m*f-y)/C)-1}0<n.length&&y!=p&&(Math.abs((y-p)/f)>=Ad&&B.m("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",r),n[n.length-1].end=y/f);for(r=0;r<=z;++r)p=y+C,n.push({start:y/f,end:p/f,Hg:y}),y=p}f=n}return{timescale:e,
da:d,ib:h,oa:g/e||0,Pd:g,S:f}}function Of(b,c,d){return[c(b.A),c(b.aa),c(b.ma)].filter(wd.Na).map(function(b){return b.getAttribute(d)}).reduce(function(b,c){return b||c})}function Pf(b,c,d){return[c(b.A),c(b.aa),c(b.ma)].filter(wd.Na).map(function(b){return U.oc(b,d)}).reduce(function(b,c){return b||c})}
function Qf(b,c,d,e,f,g){for(var h=U.getAttributeNS(b,"http://www.w3.org/1999/xlink","href"),k=U.getAttributeNS(b,"http://www.w3.org/1999/xlink","actuate")||"onRequest",m=0;m<b.attributes.length;m++){var n=b.attributes[m];"http://www.w3.org/1999/xlink"==n.namespaceURI&&(b.removeAttributeNS(n.namespaceURI,n.localName),--m)}if(5<=g)return Fb(new E(2,4,4028));if("onLoad"!=k)return Fb(new E(2,4,4027));var p=xd([e],[h]);return f.request(0,Wb(p,c)).Y(function(e){e=U.te(e.data,b.tagName);if(!e)return Fb(new E(2,
4,4001,h));for(;b.childNodes.length;)b.removeChild(b.childNodes[0]);for(;e.childNodes.length;){var k=e.childNodes[0];e.removeChild(k);b.appendChild(k)}for(k=0;k<e.attributes.length;k++){var m=e.attributes[k].nodeName,n=e.getAttribute(m);b.setAttribute(m,n)}return Rf(b,c,d,p[0],f,g+1)})}
function Rf(b,c,d,e,f,g){g=void 0===g?0:g;if(U.getAttributeNS(b,"http://www.w3.org/1999/xlink","href")){var h=Qf(b,c,d,e,f,g);d&&(h=h.Y(void 0,function(){return Rf(b,c,d,e,f,g)}));return h}h=[];for(var k=0;k<b.childNodes.length;k++){var m=b.childNodes[k];m instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==U.getAttributeNS(m,"http://www.w3.org/1999/xlink","href")?(b.removeChild(m),--k):"SegmentTimeline"!=m.tagName&&h.push(Rf(m,c,d,e,f,g)))}return Jb(h).Y(function(){return b})};function Sf(b,c,d){this.c=b;this.b=c;this.a=d}A("shaka.media.InitSegmentReference",Sf);Sf.prototype.Qc=function(){return this.c()};Sf.prototype.createUris=Sf.prototype.Qc;Sf.prototype.bd=function(){return this.b};Sf.prototype.getStartByte=Sf.prototype.bd;Sf.prototype.ad=function(){return this.a};Sf.prototype.getEndByte=Sf.prototype.ad;function V(b,c,d,e,f,g){this.position=b;this.startTime=c;this.endTime=d;this.c=e;this.b=f;this.a=g}A("shaka.media.SegmentReference",V);V.prototype.ga=function(){return this.position};
V.prototype.getPosition=V.prototype.ga;V.prototype.sc=function(){return this.startTime};V.prototype.getStartTime=V.prototype.sc;V.prototype.gf=function(){return this.endTime};V.prototype.getEndTime=V.prototype.gf;V.prototype.Qc=function(){return this.c()};V.prototype.createUris=V.prototype.Qc;V.prototype.bd=function(){return this.b};V.prototype.getStartByte=V.prototype.bd;V.prototype.ad=function(){return this.a};V.prototype.getEndByte=V.prototype.ad;function Tf(b,c,d,e){var f,g=(new T).ia("sidx",function(b){f=Uf(c,e,d,b)});b&&g.parse(b);if(f)return f;B.error('Invalid box type, expected "sidx".');throw new E(2,3,3004);}
function Uf(b,c,d,e){var f=[];e.reader.P(4);var g=e.reader.I();if(0==g)throw B.error("Invalid timescale."),new E(2,3,3005);if(0==e.version){var h=e.reader.I();var k=e.reader.I()}else h=e.reader.Kb(),k=e.reader.Kb();e.reader.P(2);var m=e.reader.$b();b=b+e.size+k;for(k=0;k<m;k++){var n=e.reader.I(),p=(n&2147483648)>>>31;n&=2147483647;var q=e.reader.I();e.reader.P(4);if(1==p)throw B.error("Heirarchical SIDXs are not supported."),new E(2,3,3006);f.push(new V(f.length,h/g-c,(h+q)/g-c,function(){return d},
b,b+n-1));h+=q;b+=n}e.parser.stop();return f};function Vf(b){this.a=b}A("shaka.media.SegmentIndex",Vf);Vf.prototype.destroy=function(){this.a=null;return Promise.resolve()};Vf.prototype.destroy=Vf.prototype.destroy;Vf.prototype.find=function(b){for(var c=this.a.length-1;0<=c;--c){var d=this.a[c];if(b>=d.startTime&&b<d.endTime)return d.position}return this.a.length&&b<this.a[0].startTime?this.a[0].position:null};Vf.prototype.find=Vf.prototype.find;
Vf.prototype.get=function(b){if(0==this.a.length)return null;b-=this.a[0].position;return 0>b||b>=this.a.length?null:this.a[b]};Vf.prototype.get=Vf.prototype.get;Vf.prototype.offset=function(b){for(var c=0;c<this.a.length;++c)this.a[c].startTime+=b,this.a[c].endTime+=b};Vf.prototype.offset=Vf.prototype.offset;
Vf.prototype.md=function(b){for(var c=[],d=0,e=0;d<this.a.length&&e<b.length;){var f=this.a[d],g=b[e];f.startTime<g.startTime?(c.push(f),d++):(f.startTime>g.startTime?0==d?c.push(g):B.m("Refusing to rewrite original references on update!"):(.1<Math.abs(f.endTime-g.endTime)?c.push(new V(f.position,g.startTime,g.endTime,g.c,g.b,g.a)):c.push(f),d++),e++)}for(;d<this.a.length;)c.push(this.a[d++]);if(c.length)for(d=c[c.length-1].position+1;e<b.length;)f=b[e++],f=new V(d++,f.startTime,f.endTime,f.c,f.b,
f.a),c.push(f);else c=b;this.a=c};Vf.prototype.merge=Vf.prototype.md;Vf.prototype.Tc=function(b){for(var c=0;c<this.a.length;++c)if(this.a[c].endTime>b){this.a.splice(0,c);return}this.a=[]};Vf.prototype.evict=Vf.prototype.Tc;function Wf(b,c){for(;b.a.length;)if(b.a[b.a.length-1].startTime>=c)b.a.pop();else break;for(;b.a.length;)if(0>=b.a[0].endTime)b.a.shift();else break;if(0!=b.a.length){var d=b.a[b.a.length-1];b.a[b.a.length-1]=new V(d.position,d.startTime,c,d.c,d.b,d.a)}};function Xf(b){this.b=b;this.a=new S(b,0);Yf||(Yf=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var Yf;Xf.prototype.ya=function(){return this.a.ya()};
function Zf(b){var c=$f(b);if(7<c.length)throw new E(2,3,3002);for(var d=0,e=0;e<c.length;e++)d=256*d+c[e];c=d;d=$f(b);a:{e=M.Da;for(var f=0;f<Yf.length;f++)if(e(d,Yf[f])){e=!0;break a}e=!1}if(e)d=b.b.byteLength-b.a.ga();else{if(8==d.length&&d[1]&224)throw new E(2,3,3001);e=d[0]&(1<<8-d.length)-1;for(f=1;f<d.length;f++)e=256*e+d[f];d=e}d=b.a.ga()+d<=b.b.byteLength?d:b.b.byteLength-b.a.ga();e=new DataView(b.b.buffer,b.b.byteOffset+b.a.ga(),d);b.a.P(d);return new ag(c,e)}
function $f(b){var c=b.a.na(),d;for(d=1;8>=d&&!(c&1<<8-d);d++);if(8<d)throw new E(2,3,3002);var e=new Uint8Array(d);e[0]=c;for(c=1;c<d;c++)e[c]=b.a.na();return e}function ag(b,c){this.id=b;this.a=c}function bg(b){if(8<b.a.byteLength)throw new E(2,3,3002);if(8==b.a.byteLength&&b.a.getUint8(0)&224)throw new E(2,3,3001);for(var c=0,d=0;d<b.a.byteLength;d++){var e=b.a.getUint8(d);c=256*c+e}return c};function cg(){}
cg.prototype.parse=function(b,c,d,e){var f;c=new Xf(new DataView(c));if(440786851!=Zf(c).id)throw B.error("Not an EBML element."),new E(2,3,3008);var g=Zf(c);if(408125543!=g.id)throw B.error("Not a Segment element."),new E(2,3,3009);c=g.a.byteOffset;g=new Xf(g.a);for(f=null;g.ya();){var h=Zf(g);if(357149030==h.id){f=h;break}}if(!f)throw B.error("Not an Info element."),new E(2,3,3010);g=new Xf(f.a);f=1E6;for(h=null;g.ya();){var k=Zf(g);if(2807729==k.id)f=bg(k);else if(17545==k.id)if(h=k,4==h.a.byteLength)h=
h.a.getFloat32(0);else if(8==h.a.byteLength)h=h.a.getFloat64(0);else throw new E(2,3,3003);}if(null==h)throw new E(2,3,3011);g=f/1E9;f=h*g;b=Zf(new Xf(new DataView(b)));if(475249515!=b.id)throw B.error("Not a Cues element."),new E(2,3,3007);return dg(b,c,g,f,d,e)};
function dg(b,c,d,e,f,g){function h(){return f}var k=[];b=new Xf(b.a);for(var m=null,n=null;b.ya();){var p=Zf(b);if(187==p.id){var q=eg(p);q&&(p=d*q.Ig,q=c+q.hg,null!=m&&k.push(new V(k.length,m-g,p-g,h,n,q-1)),m=p,n=q)}}null!=m&&k.push(new V(k.length,m-g,e-g,h,n,null));return k}
function eg(b){var c=new Xf(b.a);b=Zf(c);if(179!=b.id)throw B.m("Not a CueTime element."),new E(2,3,3013);b=bg(b);c=Zf(c);if(183!=c.id)throw B.m("Not a CueTrackPositions element."),new E(2,3,3012);c=new Xf(c.a);for(var d=0;c.ya();){var e=Zf(c);if(241==e.id){d=bg(e);break}}return{Ig:b,hg:d}};function fg(b,c){var d=Pf(b,c,"Initialization");if(!d)return null;var e=b.A.ta,f=d.getAttribute("sourceURL");f&&(e=xd(b.A.ta,[f]));f=0;var g=null;if(d=U.M(d,"range",U.Cc))f=d.start,g=d.end;return new Sf(function(){return e},f,g)}
function gg(b,c){var d=Number(Of(b,hg,"presentationTimeOffset"))||0,e=Of(b,hg,"timescale"),f=1;e&&(f=U.Bc(e)||1);d=d/f||0;e=fg(b,hg);var g=b.A.contentType;f=b.A.mimeType.split("/")[1];if("text"!=g&&"mp4"!=f&&"webm"!=f)throw B.error("SegmentBase specifies an unsupported container type.",b.A),new E(2,4,4006);if("webm"==f&&!e)throw B.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",b.A),new E(2,
4,4005);g=Pf(b,hg,"RepresentationIndex");var h=Of(b,hg,"indexRange"),k=b.A.ta;h=U.Cc(h||"");if(g){var m=g.getAttribute("sourceURL");m&&(k=xd(b.A.ta,[m]));h=U.M(g,"range",U.Cc,h)}if(!h)throw B.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",b.A),new E(2,4,4002);f=ig(b,c,e,k,h.start,h.end,f,d);return{createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,
initSegmentReference:e,oa:d}}function ig(b,c,d,e,f,g,h,k){var m=b.presentationTimeline,n=!b.tb||!b.W.hd,p=b.W.start,q=b.W.duration,r=c,y=null;return{createSegmentIndex:function(){var b=[r(e,f,g),"webm"==h?r(d.c(),d.b,d.a):null];r=null;return Promise.all(b).then(function(b){var c=b[0];b=b[1]||null;c="mp4"==h?Tf(c,f,e,k):(new cg).parse(c,b,e,k);m.Eb(c,p);y=new Vf(c);n&&Wf(y,q)})},findSegmentPosition:function(b){return y.find(b)},getSegmentReference:function(b){return y.get(b)}}}
function hg(b){return b.ac};function jg(b,c){var d=fg(b,kg);var e=lg(b);var f=Nf(b,kg),g=f.ib;0==g&&(B.m("SegmentList@startNumber must be > 0"),g=1);var h=0;f.da?h=f.da*(g-1):f.S&&0<f.S.length&&(h=f.S[0].start);e={da:f.da,startTime:h,ib:g,oa:f.oa,S:f.S,cb:e};if(!e.da&&!e.S&&1<e.cb.length)throw B.m("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",b.A),new E(2,4,4002);if(!e.da&&!b.W.duration&&!e.S&&1==e.cb.length)throw B.m("SegmentList does not contain sufficient segment information:",
"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",b.A),new E(2,4,4002);if(e.S&&0==e.S.length)throw B.m("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",b.A),new E(2,4,4002);g=f=null;b.ma.id&&b.A.id&&(g=b.ma.id+","+b.A.id,f=c[g]);h=mg(b.W.duration,e.ib,b.A.ta,e);f?(f.md(h),g=b.presentationTimeline.Wb(),f.Tc(g-b.W.start)):(b.presentationTimeline.Eb(h,b.W.start),f=new Vf(h),g&&b.tb&&
(c[g]=f));b.tb&&b.W.hd||Wf(f,b.W.duration);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:f.find.bind(f),getSegmentReference:f.get.bind(f),initSegmentReference:d,oa:e.oa}}function kg(b){return b.Qa}
function mg(b,c,d,e){var f=e.cb.length;e.S&&e.S.length!=e.cb.length&&(f=Math.min(e.S.length,e.cb.length),B.m("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",e.cb.length,"to",f));for(var g=[],h=e.startTime,k=0;k<f;k++){var m=e.cb[k],n=xd(d,[m.Kf]),p=void 0;p=null!=e.da?h+e.da:e.S?e.S[k].end:h+b;g.push(new V(k+c,h,p,function(b){return b}.bind(null,n),m.start,m.end));h=p}return g}
function lg(b){return[b.A.Qa,b.aa.Qa,b.ma.Qa].filter(wd.Na).map(function(b){return U.U(b,"SegmentURL")}).reduce(function(b,d){return 0<b.length?b:d}).map(function(c){c.getAttribute("indexRange")&&!b.he&&(b.he=!0,B.m("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var d=c.getAttribute("media");c=U.M(c,"mediaRange",U.Cc,{start:0,end:null});return{Kf:d,start:c.start,end:c.end}})};function ng(b,c,d,e){var f=og(b);var g=Nf(b,pg);var h=Of(b,pg,"media"),k=Of(b,pg,"index");g={da:g.da,timescale:g.timescale,ib:g.ib,oa:g.oa,Pd:g.Pd,S:g.S,kd:h,Yb:k};h=g.Yb?1:0;h+=g.S?1:0;h+=g.da?1:0;if(0==h)throw B.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",b.A),new E(2,4,4002);1!=h&&(B.m("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,",
"a SegmentTimeline or a segment duration.",b.A),g.Yb?(B.info("Using the index URL template by default."),g.S=null):B.info("Using the SegmentTimeline by default."),g.da=null);if(!g.Yb&&!g.kd)throw B.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",b.A),new E(2,4,4002);if(g.Yb){d=b.A.mimeType.split("/")[1];if("mp4"!=d&&"webm"!=d)throw B.error("SegmentTemplate specifies an unsupported container type.",b.A),new E(2,4,4006);
if("webm"==d&&!f)throw B.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",b.A),new E(2,4,4005);e=Mf(g.Yb,b.A.id,null,b.bandwidth||null,null);e=xd(b.A.ta,[e]);b=ig(b,c,f,e,0,null,d,g.oa)}else g.da?(e||(b.presentationTimeline.od(g.da),b.presentationTimeline.pd(b.W.start)),b=qg(b,g)):(h=c=null,b.ma.id&&b.A.id&&(h=b.ma.id+","+b.A.id,c=d[h]),k=rg(b,g),e=!b.tb||!b.W.hd,c?(e&&Wf(new Vf(k),
b.W.duration),c.md(k),d=b.presentationTimeline.Wb(),c.Tc(d-b.W.start)):(b.presentationTimeline.Eb(k,b.W.start),c=new Vf(k),h&&b.tb&&(d[h]=c)),e&&Wf(c,b.W.duration),b={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:c.find.bind(c),getSegmentReference:c.get.bind(c)});return{createSegmentIndex:b.createSegmentIndex,findSegmentPosition:b.findSegmentPosition,getSegmentReference:b.getSegmentReference,initSegmentReference:f,oa:g.oa}}function pg(b){return b.cc}
function qg(b,c){var d=b.W.duration,e=c.da,f=c.ib,g=c.timescale,h=c.kd,k=b.bandwidth||null,m=b.A.id,n=b.A.ta;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0>b||d&&b>=d?null:Math.floor(b/e)},getSegmentReference:function(b){var c=b*e,p=c+e;d&&(p=Math.min(p,d));return 0>p||d&&c>=d?null:new V(b,c,p,function(){var d=Mf(h,m,b+f,k,c*g);return xd(n,[d])},0,null)}}}
function rg(b,c){for(var d=[],e=0;e<c.S.length;e++){var f=e+c.ib;d.push(new V(f,c.S[e].start,c.S[e].end,function(b,c,d,e,f,p){b=Mf(b,c,f,d,p);return xd(e,[b]).map(function(b){return b.toString()})}.bind(null,c.kd,b.A.id,b.bandwidth||null,b.A.ta,f,c.S[e].Hg+c.Pd),0,null))}return d}function og(b){var c=Of(b,pg,"initialization");if(!c)return null;var d=b.A.id,e=b.bandwidth||null,f=b.A.ta;return new Sf(function(){var b=Mf(c,d,null,e,null);return xd(f,[b])},0,null)};var W={Ib:{},Zb:{},zd:function(b,c){W.Zb[b]=c}};A("shaka.media.ManifestParser.registerParserByExtension",W.zd);W.Lb=function(b,c){W.Ib[b]=c};A("shaka.media.ManifestParser.registerParserByMime",W.Lb);
W.eg=function(){var b={};if(tc()){for(var c in W.Ib)b[c]=!0;for(var d in W.Zb)b[d]=!0}c={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};d=t(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var e=d.next();!e.done;e=d.next())e=e.value,b[e]=tc()?!!W.Ib[e]:uc(e);for(var f in c)b[f]=tc()?!!W.Zb[f]:uc(c[f]);return b};
W.create=function(b,c,d,e){return u(function g(){var h,k;return x(g,function(g){switch(g.j){case 1:return Aa(g,2),v(g,W.hf(b,c,d,e),4);case 4:return h=g.s,g["return"](new h);case 2:throw k=Fa(g),k.severity=2,k;}})})};
W.hf=function(b,c,d,e){return u(function g(){var h,k,m,n,p;return x(g,function(g){switch(g.j){case 1:h=W;if(e){if(k=h.Ib[e.toLowerCase()])return g["return"](k);B.m("Could not determine manifest type using MIME type ",e)}if(m=h.getExtension(b)){if(n=h.Zb[m])return g["return"](n);B.m("Could not determine manifest type for extension ",m)}else B.m("Could not find extension for ",b);if(e){g.C(2);break}return v(g,h.rf(b,c,d),3);case 3:if(e=g.s){if(p=W.Ib[e])return g["return"](p);B.m("Could not determine manifest type using MIME type",
e)}case 2:throw new E(2,4,4E3,b);}})})};W.rf=function(b,c,d){return u(function f(){var g,h,k;return x(f,function(f){switch(f.j){case 1:return g=Wb([b],d),g.method="HEAD",v(f,c.request(0,g).promise,2);case 2:return h=f.s,k=h.headers["content-type"],f["return"](k?k.toLowerCase().split(";").shift():"")}})})};W.getExtension=function(b){b=(new ib(b)).la.split("/").pop().split(".");return 1==b.length?"":b.pop().toLowerCase()};
W.isSupported=function(b,c){return tc()?c in W.Ib||W.getExtension(b)in W.Zb?!0:!1:!1};function X(b,c,d){this.f=b;this.Dc=c;this.h=this.g=Infinity;this.a=1;this.b=this.c=null;this.l=0;this.o=!0;this.i=0;this.u=void 0===d?!0:d}A("shaka.media.PresentationTimeline",X);X.prototype.ca=function(){return this.g};X.prototype.getDuration=X.prototype.ca;X.prototype.pf=function(){return this.a};X.prototype.getMaxSegmentDuration=X.prototype.pf;X.prototype.Ba=function(b){this.g=b};X.prototype.setDuration=X.prototype.Ba;X.prototype.xf=function(){return this.f};
X.prototype.getPresentationStartTime=X.prototype.xf;X.prototype.De=function(b){this.l=b};X.prototype.setClockOffset=X.prototype.De;X.prototype.dc=function(b){this.o=b};X.prototype.setStatic=X.prototype.dc;X.prototype.Jd=function(b){this.h=b};X.prototype.setSegmentAvailabilityDuration=X.prototype.Jd;X.prototype.sg=function(b){this.Dc=b};X.prototype.setDelay=X.prototype.sg;X.prototype.ff=function(){return this.Dc};X.prototype.getDelay=X.prototype.ff;
X.prototype.Eb=function(b,c){if(0!=b.length){var d=b[b.length-1].endTime+c;this.pd(b[0].startTime+c);this.a=b.reduce(function(b,c){return Math.max(b,c.endTime-c.startTime)},this.a);this.b=Math.max(this.b,d);null!=this.f&&this.u&&(this.f=(Date.now()+this.l)/1E3-this.b-this.a);B.D("notifySegments:","maxSegmentDuration="+this.a)}};X.prototype.notifySegments=X.prototype.Eb;X.prototype.pd=function(b){this.c=null==this.c?b:Math.min(this.c,b)};X.prototype.notifyMinSegmentStartTime=X.prototype.pd;
X.prototype.od=function(b){this.a=Math.max(this.a,b);B.D("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)};X.prototype.notifyMaxSegmentDuration=X.prototype.od;X.prototype.offset=function(b){null!=this.c&&(this.c+=b);null!=this.b&&(this.b+=b)};X.prototype.offset=X.prototype.offset;X.prototype.X=function(){return Infinity==this.g&&!this.o};X.prototype.isLive=X.prototype.X;X.prototype.bb=function(){return Infinity!=this.g&&!this.o};X.prototype.isInProgress=X.prototype.bb;
X.prototype.Wb=function(){if(Infinity==this.h)return this.i;var b=this.xb()-this.h;return Math.max(this.i,b)};X.prototype.getSegmentAvailabilityStart=X.prototype.Wb;X.prototype.Ee=function(b){this.i=b};X.prototype.setUserSeekStart=X.prototype.Ee;X.prototype.xb=function(){return this.X()||this.bb()?Math.min(Math.max(0,(Date.now()+this.l)/1E3-this.a-this.f),this.g):this.g};X.prototype.getSegmentAvailabilityEnd=X.prototype.xb;
X.prototype.Vb=function(b){var c=Math.max(this.c,this.i);if(Infinity==this.h)return c;var d=this.xb()-this.h;b=Math.min(d+b,this.Ga());return Math.max(c,b)};X.prototype.getSafeSeekRangeStart=X.prototype.Vb;X.prototype.wb=function(){return this.Vb(0)};X.prototype.getSeekRangeStart=X.prototype.wb;X.prototype.Ga=function(){var b=this.X()||this.bb()?this.Dc:0;return Math.max(0,this.xb()-b)};X.prototype.getSeekRangeEnd=X.prototype.Ga;
X.prototype.Ie=function(){return null==this.f||null!=this.b&&this.u?!1:!0};X.prototype.usingPresentationStartTime=X.prototype.Ie;function sg(b,c,d,e){b=Wb(b,e);if(0!=c||null!=d)b.headers.Range=d?"bytes="+c+"-"+d:"bytes="+c+"-";return b};function tg(){var b=this;this.b=this.a=null;this.f=[];this.c=null;this.l=[];this.h=1;this.o={};this.u=0;this.v=new db(5);this.i=new D(function(){ug(b)});this.g=new Sb}A("shaka.dash.DashParser",tg);l=tg.prototype;l.configure=function(b){this.a=b};l.start=function(b,c){var d=this;return u(function f(){var g;return x(f,function(f){switch(f.j){case 1:return d.f=[b],d.b=c,v(f,vg(d),2);case 2:g=f.s;d.b&&wg(d,g);if(!d.b)throw new E(2,7,7001);return f["return"](d.c)}})})};
l.stop=function(){this.a=this.b=null;this.f=[];this.c=null;this.l=[];this.o={};null!=this.i&&(this.i.stop(),this.i=null);return this.g.destroy()};l.update=function(){vg(this)["catch"](function(b){if(this.b)this.b.onError(b)}.bind(this))};l.onExpirationUpdated=function(){};
function vg(b){var c=Date.now(),d=b.b.networkingEngine.request(0,Wb(b.f,b.a.retryParameters));Tb(b.g,d);return d.promise.then(function(c){if(b.b)return c.uri&&!b.f.includes(c.uri)&&b.f.unshift(c.uri),xg(b,c.data,c.uri)}).then(function(){var d=(Date.now()-c)/1E3;eb(b.v,1,d);return d})}function xg(b,c,d){c=U.te(c,"MPD");if(!c)throw new E(2,4,4001,d);c=Rf(c,b.a.retryParameters,b.a.dash.xlinkFailGracefully,d,b.b.networkingEngine);Tb(b.g,c);return c.promise.then(function(c){return yg(b,c,d)})}
function yg(b,c,d){return u(function f(){var g,h,k,m,n,p,q,r,y,C,z,F,H,R,sa,ba,Ya,Ia,la,Za,ea,ta,Ja,Oa,ua,$a,mb;return x(f,function(f){switch(f.j){case 1:m=wd;n=U;p=[d];q=n.U(c,"Location").map(n.qc).filter(m.Na);0<q.length&&(r=xd(p,q),p=b.f=r);y=n.U(c,"BaseURL").map(n.qc);C=xd(p,y);z=b.a.dash.ignoreMinBufferTime;F=0;z||(F=n.M(c,"minBufferTime",n.Ia));b.u=n.M(c,"minimumUpdatePeriod",n.Ia,-1);H=n.M(c,"availabilityStartTime",n.ag);R=n.M(c,"timeShiftBufferDepth",n.Ia);sa=n.M(c,"maxSegmentDuration",n.Ia);
ba=c.getAttribute("type")||"static";Ya=b.a.dash.ignoreSuggestedPresentationDelay;Ia=null;Ya||(Ia=n.M(c,"suggestedPresentationDelay",n.Ia));b.c?la=b.c.presentationTimeline:(Za=Math.max(b.a.dash.defaultPresentationDelay,1.5*F),ea=null!=Ia?Ia:Za,la=new X(H,ea,b.a.dash.autoCorrectDrift));ta={tb:"static"!=ba,presentationTimeline:la,ma:null,W:null,aa:null,A:null,bandwidth:0,he:!1};for(var Bb=ta,Cb=C,Db=U.M(c,"mediaPresentationDuration",U.Ia),nb=[],Da=0,ob=U.U(c,"Period"),Ba=0;Ba<ob.length;Ba++){var Qa=
ob[Ba];Da=U.M(Qa,"start",U.Ia,Da);var cc=U.M(Qa,"duration",U.Ia),ab=null;if(Ba!=ob.length-1){var Pa=U.M(ob[Ba+1],"start",U.Ia);null!=Pa&&(ab=Pa-Da)}else null!=Db&&(ab=Db-Da);Pa=Ad;ab&&cc&&Math.abs(ab-cc)>Pa&&B.m("There is a gap/overlap between Periods",Qa);null==ab&&(ab=cc);Qa=zg(b,Bb,Cb,{start:Da,duration:ab,node:Qa,hd:null==ab||Ba==ob.length-1});nb.push(Qa);cc=Bb.ma.id;b.l.includes(cc)||(b.l.push(cc),b.c&&(b.b.filterNewPeriod(Qa),b.c.periods.push(Qa)));if(null==ab){Ba!=ob.length-1&&B.m("Skipping Period",
Ba+1,"and any subsequent Periods:","Period",Ba+1,"does not have a valid start time.",nb[Ba+1]);Da=null;break}Da+=ab}null==b.c&&b.b.filterAllPeriods(nb);null!=Db?(Da!=Db&&B.m("@mediaPresentationDuration does not match the total duration of all","Periods."),g=nb,h=Db,k=!1):(g=nb,h=Da,k=!0);Ja=h;Oa=g;la.dc("static"==ba);"static"!=ba&&k||la.Ba(Ja||Infinity);(ua=la.X())&&!isNaN(b.a.availabilityWindowOverride)&&(R=b.a.availabilityWindowOverride);null==R&&(R=Infinity);la.Jd(R);la.od(sa||1);if(b.c){f.C(0);
break}b.c={presentationTimeline:la,periods:Oa,offlineSessionIds:[],minBufferTime:F||0};if(!la.Ie()){f.C(0);break}$a=n.U(c,"UTCTiming");return v(f,Ag(b,C,$a),4);case 4:mb=f.s;if(!b.b)return f["return"]();la.De(mb);w(f)}})})}
function zg(b,c,d,e){c.ma=Bg(e.node,null,d);c.W=e;c.ma.id||(B.info("No Period ID given for Period with start time "+e.start+",  Assigning a default"),c.ma.id="__shaka_period_"+e.start);U.U(e.node,"EventStream").forEach(b.bg.bind(b,e.start,e.duration));d=U.U(e.node,"AdaptationSet").map(b.$f.bind(b,c)).filter(wd.Na);if(c.tb){c=[];for(var f=t(d),g=f.next();!g.done;g=f.next()){g=t(g.value.kg);for(var h=g.next();!h.done;h=g.next())c.push(h.value)}if(c.length!=(new Set(c)).size)throw new E(2,4,4018);}var k=
d.filter(function(b){return!b.Nd});d.filter(function(b){return b.Nd}).forEach(function(b){var c=b.streams[0],d=b.Nd;k.forEach(function(b){b.id==d&&b.streams.forEach(function(b){b.trickModeVideo=c})})});c=Cg(k,"video");f=Cg(k,"audio");if(!c.length&&!f.length)throw new E(2,4,4004);d=b.a.disableAudio;if(!f.length||d)f=[null];d=b.a.disableVideo;if(!c.length||d)c=[null];d=[];for(g=0;g<f.length;g++)for(h=0;h<c.length;h++)Dg(b,f[g],c[h],d);c=[];if(!b.a.disableText)for(b=Cg(k,"text"),f=0;f<b.length;f++)c.push.apply(c,
b[f].streams);return{startTime:e.start,textStreams:c,variants:d}}function Cg(b,c){return b.filter(function(b){return b.contentType==c})}
function Dg(b,c,d,e){if(c||d)if(c&&d){var f=c.drmInfos;var g=d.drmInfos;if(f.length&&g.length?0<nd(f,g).length:1){g=nd(c.drmInfos,d.drmInfos);for(var h=0;h<c.streams.length;h++)for(var k=0;k<d.streams.length;k++)f=(d.streams[k].bandwidth||0)+(c.streams[h].bandwidth||0),f={id:b.h++,language:c.language,primary:c.jd||d.jd,audio:c.streams[h],video:d.streams[k],bandwidth:f,drmInfos:g,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}}else for(g=c||d,h=0;h<g.streams.length;h++)f=g.streams[h].bandwidth||
0,f={id:b.h++,language:g.language||"und",primary:g.jd,audio:c?g.streams[h]:null,video:d?g.streams[h]:null,bandwidth:f,drmInfos:g.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}
l.$f=function(b,c){b.aa=Bg(c,b.ma,null);if("image"==b.aa.contentType)return B.m("Skipping Image AdaptationSet",b.aa),null;var d=!1,e=U.U(c,"Role"),f=e.map(function(b){return b.getAttribute("value")}).filter(wd.Na),g=void 0,h="text"==b.aa.contentType;h&&(g="subtitle");for(var k=0;k<e.length;k++){var m=e[k].getAttribute("schemeIdUri");if(null==m||"urn:mpeg:dash:role:2011"==m)switch(m=e[k].getAttribute("value"),m){case "main":d=!0;break;case "caption":case "subtitle":g=m}}var n=null,p=!1;U.U(c,"EssentialProperty").forEach(function(b){"http://dashif.org/guidelines/trickmode"==
b.getAttribute("schemeIdUri")?n=b.getAttribute("value"):p=!0});k=U.U(c,"Accessibility");var q=new Map;e={};k=t(k);for(m=k.next();!m.done;e={Rb:e.Rb},m=k.next()){var r=m.value;m=r.getAttribute("schemeIdUri");r=r.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==m||"urn:scte:dash:cc:cea-708:2015"==m?(e.Rb=1,null!=r?r.split(";").forEach(function(b){return function(c){if(c.includes("=")){c=c.split("=");var d=c[0].startsWith("CC")?c[0]:"CC"+c[0];c=c[1].split(",")[0].split(":").pop()}else d="CC"+b.Rb,
b.Rb+=2;q.set(d,N(c))}}(e)):q.set("CC1","und")):"urn:mpeg:dash:role:2011"==m&&null!=r&&(f.push(r),"captions"==r&&(g="caption"))}if(p)return null;e=U.U(c,"ContentProtection");var y=Ef(e,this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);e=N(c.getAttribute("lang")||"und");k=c.getAttribute("label");(m=U.U(c,"Label"))&&m.length&&(m=m[0],m.textContent&&(k=m.textContent));m=U.U(c,"Representation");f=m.map(this.cg.bind(this,b,y,g,e,k,d,f,q)).filter(function(b){return!!b});if(0==f.length){if(this.a.dash.ignoreEmptyAdaptationSet||
h)return null;throw new E(2,4,4003);}b.aa.contentType&&"application"!=b.aa.contentType||(b.aa.contentType=Eg(f[0].mimeType,f[0].codecs),f.forEach(function(c){c.type=b.aa.contentType}));f.forEach(function(b){y.drmInfos.forEach(function(c){b.keyId&&c.keyIds.push(b.keyId)})});h=m.map(function(b){return b.getAttribute("id")}).filter(wd.Na);return{id:b.aa.id||"__fake__"+this.h++,contentType:b.aa.contentType,language:e,jd:d,streams:f,drmInfos:y.drmInfos,Nd:n,kg:h}};
l.cg=function(b,c,d,e,f,g,h,k,m){b.A=Bg(m,b.aa,null);if(!Fg(b.A))return B.m("Skipping Representation",b.A),null;b.bandwidth=U.M(m,"bandwidth",U.Bc)||0;var n=b.A.contentType;n="text"==n||"application"==n;try{var p=this.lg.bind(this);if(b.A.ac)var q=gg(b,p);else if(b.A.Qa)q=jg(b,this.o);else if(b.A.cc)q=ng(b,p,this.o,!!this.c);else{var r=b.A.ta,y=b.W.duration||0;q={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0<=b&&b<y?1:null},getSegmentReference:function(b){return 1!=
b?null:new V(1,0,y,function(){return r},0,null)},initSegmentReference:null,oa:0}}}catch(C){if(n&&4002==C.code)return null;throw C;}m=U.U(m,"ContentProtection");m=Hf(m,this.a.dash.customScheme,c,this.a.dash.ignoreDrmInfo);return{id:this.h++,originalId:b.A.id,createSegmentIndex:q.createSegmentIndex,findSegmentPosition:q.findSegmentPosition,getSegmentReference:q.getSegmentReference,initSegmentReference:q.initSegmentReference,presentationTimeOffset:q.oa,mimeType:b.A.mimeType,codecs:b.A.codecs,frameRate:b.A.frameRate,
pixelAspectRatio:b.A.pixelAspectRatio,bandwidth:b.bandwidth,width:b.A.width,height:b.A.height,kind:d,encrypted:0<c.drmInfos.length,keyId:m,language:e,label:f,type:b.aa.contentType,primary:g,trickModeVideo:null,emsgSchemeIdUris:b.A.emsgSchemeIdUris,roles:h,channelsCount:b.A.qd,audioSamplingRate:b.A.audioSamplingRate,closedCaptions:k}};
function ug(b){u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return B.info("Updating manifest..."),e=0,Aa(d,2),v(d,vg(b),4);case 4:e=d.s;Ea(d,3);break;case 2:f=Fa(d),b.b&&(f.severity=1,b.b.onError(f));case 3:if(!b.b)return d["return"]();wg(b,e);w(d)}})})}function wg(b,c){0>b.u||b.i.R(Math.max(3,b.u-c,fb(b.v)))}
function Bg(b,c,d){c=c||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,qd:null,audioSamplingRate:null};d=d||c.ta;var e=U.Hb,f=U.$e,g=U.U(b,"BaseURL").map(U.qc),h=b.getAttribute("contentType")||c.contentType,k=b.getAttribute("mimeType")||c.mimeType,m=b.getAttribute("codecs")||c.codecs;f=U.M(b,"frameRate",f)||c.frameRate;var n=b.getAttribute("sar")||c.pixelAspectRatio,p=U.U(b,"InbandEventStream"),q=c.emsgSchemeIdUris.slice();p=t(p);for(var r=p.next();!r.done;r=p.next())r=
r.value.getAttribute("schemeIdUri"),q.includes(r)||q.push(r);p=U.U(b,"AudioChannelConfiguration");p=Gg(p)||c.qd;r=U.M(b,"audioSamplingRate",e)||c.audioSamplingRate;h||(h=Eg(k,m));return{ta:xd(d,g),ac:U.oc(b,"SegmentBase")||c.ac,Qa:U.oc(b,"SegmentList")||c.Qa,cc:U.oc(b,"SegmentTemplate")||c.cc,width:U.M(b,"width",e)||c.width,height:U.M(b,"height",e)||c.height,contentType:h,mimeType:k,codecs:m,frameRate:f,pixelAspectRatio:n,emsgSchemeIdUris:q,id:b.getAttribute("id"),qd:p,audioSamplingRate:r}}
function Gg(b){for(var c=0;c<b.length;++c){var d=b[c],e=d.getAttribute("schemeIdUri");if(e&&(d=d.getAttribute("value")))switch(e){case "urn:mpeg:dash:outputChannelPositionList:2012":return d.trim().split(/ +/).length;case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var f=parseInt(d,10);if(!f){B.m("Channel parsing failure! Ignoring scheme and value",e,d);continue}return f;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":f=
parseInt(d,16);if(!f){B.m("Channel parsing failure! Ignoring scheme and value",e,d);continue}for(b=0;f;)f&1&&++b,f>>=1;return b;default:B.m("Unrecognized audio channel scheme:",e,d)}}return null}
function Fg(b){var c=b.ac?1:0;c+=b.Qa?1:0;c+=b.cc?1:0;if(0==c){if("text"==b.contentType||"application"==b.contentType)return!0;B.m("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',b);return!1}1!=c&&(B.m("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",
b),b.ac?(B.info("Using SegmentBase by default."),b.Qa=null):B.info("Using SegmentList by default."),b.cc=null);return!0}
function Hg(b,c,d,e){c=xd(c,[d]);c=Wb(c,b.a.retryParameters);c.method=e;c=b.b.networkingEngine.request(4,c);Tb(b.g,c);return c.promise.then(function(b){if("HEAD"==e){if(!b.headers||!b.headers.date)return B.m("UTC timing response is missing","expected date header"),0;b=b.headers.date}else b=Cc(b.data);b=Date.parse(b);return isNaN(b)?(B.m("Unable to parse date from UTC timing response"),0):b-Date.now()})}
function Ag(b,c,d){d=d.map(function(b){return{scheme:b.getAttribute("schemeIdUri"),value:b.getAttribute("value")}});var e=b.a.dash.clockSyncUri;!d.length&&e&&d.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:e});return wd.Ye(d,function(b){var d=b.scheme;b=b.value;switch(d){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Hg(this,c,b,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Hg(this,
c,b,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return d=Date.parse(b),isNaN(d)?0:d-Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return B.Z("NTP UTCTiming scheme is not supported"),Promise.reject();default:return B.Z("Unrecognized scheme in UTCTiming element",d),Promise.reject()}}.bind(b))["catch"](function(){B.Z("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!");
return 0})}l.bg=function(b,c,d){var e=U.Hb,f=d.getAttribute("schemeIdUri")||"",g=d.getAttribute("value")||"",h=U.M(d,"timescale",e)||1;U.U(d,"Event").forEach(function(d){var k=U.M(d,"presentationTime",e)||0,n=U.M(d,"duration",e)||0;k=k/h+b;n=k+n/h;null!=c&&(k=Math.min(k,b+c),n=Math.min(n,b+c));d={schemeIdUri:f,value:g,startTime:k,endTime:n,id:d.getAttribute("id")||"",eventElement:d};this.b.onTimelineRegionAdded(d)}.bind(this))};
l.lg=function(b,c,d){b=sg(b,c,d,this.a.retryParameters);b=this.b.networkingEngine.request(1,b);Tb(this.g,b);return b.promise.then(function(b){return b.data})};function Eg(b,c){return Yd(pc(b,c))?"text":b.split("/")[0]}W.zd("mpd",tg);W.Lb("application/dash+xml",tg);W.Lb("video/vnd.mpeg.dash.mpd",tg);function Ig(b,c,d,e){this.b=b;this.type=c;this.a=d;this.segments=e||null}function Jg(b,c,d,e){this.id=b;this.name=c;this.a=d;this.value=void 0===e?null:e}Jg.prototype.toString=function(){function b(b){return b.name+"="+(isNaN(Number(b.value))?'"'+b.value+'"':b.value)}var c="#"+this.name,d=this.a?this.a.map(b):[];this.value&&d.unshift(this.value);0<d.length&&(c+=":"+d.join(","));return c};function Kg(b,c){this.name=b;this.value=c}
Jg.prototype.getAttribute=function(b){var c=this.a.filter(function(c){return c.name==b});return c.length?c[0]:null};function Lg(b,c,d){return(b=b.getAttribute(c))?b.value:d||null}function Mg(b,c){this.b=c;this.a=b};var Ng={ub:function(b,c){return b.filter(function(b){return b.name==c})},Ya:function(b,c){var d=Ng.ub(b,c);return d.length?d[0]:null},Xc:function(b,c,d){return b.filter(function(b){var e=b.getAttribute("TYPE");b=b.getAttribute("GROUP-ID");return e.value==c&&b.value==d})},Pc:function(b,c){return xd([b],[c])[0]},gd:function(b){return/^#(?!EXT)/m.test(b)}};function Og(b){this.b=b;this.a=0}function Pg(b){Qg(b,/[ \t]+/gm)}function Qg(b,c){c.lastIndex=b.a;var d=c.exec(b.b);d=null==d?null:{position:d.index,length:d[0].length,ng:d};if(b.a==b.b.length||null==d||d.position!=b.a)return null;b.a+=d.length;return d.ng}function Rg(b){return b.a==b.b.length?null:(b=Qg(b,/[^ \t\n]*/gm))?b[0]:null};function Sg(){this.a=0}
function Tg(b,c,d){c=Cc(c);c=c.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim();var e=c.split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(e[0]))throw new E(2,4,4015);c=0;for(var f=1;f<e.length;f++)if(!Ng.gd(e[f])){var g=Ug(b,e[f]);--b.a;if(Vg.includes(g.name)){c=1;break}else"EXT-X-STREAM-INF"==g.name&&(f+=1)}f=[];for(g=1;g<e.length;)if(Ng.gd(e[g]))g+=1;else{var h=Ug(b,e[g]);if(Wg.includes(h.name)){if(1!=c)throw new E(2,4,4017);e=e.splice(g,e.length-g);b=Xg(b,d,e,f);return new Ig(d,c,f,b)}f.push(h);g+=1;"EXT-X-STREAM-INF"==
h.name&&(h.a.push(new Kg("URI",e[g])),g+=1)}return new Ig(d,c,f)}function Xg(b,c,d,e){var f=[],g=[];d.forEach(function(d){if(/^(#EXT)/.test(d))d=Ug(b,d),Vg.includes(d.name)?e.push(d):g.push(d);else{if(Ng.gd(d))return[];d=Ng.Pc(c,d.trim());f.push(new Mg(d,g));g=[]}});return f}
function Ug(b,c){var d=b.a++,e=c.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!e)throw new E(2,4,4016,c);var f=e[1],g=e[2];e=[];var h;if(g){g=new Og(g);var k;(k=Qg(g,/^([^,=]+)(?:,|$)/g))&&(h=k[1]);for(var m=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;k=Qg(g,m);)e.push(new Kg(k[1],k[2]||k[3]))}return new Jg(d,f,e,h)}var Vg="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),Wg="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Yg(b){try{var c=Yg.parse(b);return Hb({uri:b,vd:b,data:c.data,headers:{"content-type":c.contentType}})}catch(d){return Fb(d)}}A("shaka.net.DataUriPlugin",Yg);
Yg.parse=function(b){var c=b.split(":");if(2>c.length||"data"!=c[0])throw B.error("Bad data URI, failed to parse scheme"),new E(2,1,1004,b);c=c.slice(1).join(":").split(",");if(2>c.length)throw B.error("Bad data URI, failed to extract encoding and MIME type"),new E(2,1,1004,b);var d=c[0];b=window.decodeURIComponent(c.slice(1).join(","));c=d.split(";");d=c[0];var e=!1;1<c.length&&"base64"==c[c.length-1]&&(e=!0,c.pop());return{data:e?M.Fa(b).buffer:Fc(b),contentType:d}};Vb("data",Yg);function Zg(){var b=this;this.a=this.f=null;this.ea=1;this.G=new Map;this.V=new Set;this.b=new Map;this.c=null;this.v="";this.u=new Sg;this.T=0;this.h=new D(function(){$g(b)});this.g=ah;this.o=null;this.F=0;this.H=Infinity;this.i=new Sb;this.K=[];this.l=new Map;this.$=!1}A("shaka.hls.HlsParser",Zg);l=Zg.prototype;l.configure=function(b){this.a=b};
l.start=function(b,c){var d=this;return u(function f(){var g,h;return x(f,function(f){switch(f.j){case 1:return d.f=c,v(f,bh(d,Wb([b],d.a.retryParameters),0),2);case 2:return g=f.s,d.v=g.uri,v(f,ch(d,g.data),3);case 3:return h=d.T,0<h&&d.h.R(h),f["return"](d.o)}})})};l.stop=function(){this.h&&(this.h.stop(),this.h=null);var b=[];this.i&&(b.push(this.i.destroy()),this.i=null);this.a=this.f=null;this.G.clear();this.V.clear();this.b.clear();this.o=null;return Promise.all(b)};
l.update=function(){if(this.g!=dh.Va){for(var b=[],c=t(this.b.values()),d=c.next();!d.done;d=c.next())b.push(eh(this,d.value));return Promise.all(b)}};
function eh(b,c){return u(function e(){var f,g,h,k,m,n,p,q,r,y,C;return x(e,function(e){switch(e.j){case 1:return f=Ng,g=dh,h=c.Qe,v(e,bh(b,Wb([h],b.a.retryParameters),0),2);case 2:k=e.s;m=Tg(b.u,k.data,k.uri);if(1!=m.type)throw new E(2,4,4017);p=(n=f.Ya(m.a,"EXT-X-MEDIA-SEQUENCE"))?Number(n.value):0;q=c.stream;return v(e,fh(b,c.Jc,m,p,q.mimeType,q.codecs),3);case 3:r=e.s;c.bc.a=r;y=r[r.length-1];if(C=f.Ya(m.a,"EXT-X-ENDLIST"))gh(b,g.Va),b.c.Ba(y.endTime);w(e)}})})}l.onExpirationUpdated=function(){};
function ch(b,c){return u(function e(){var f,g,h,k,m,n,p,q,r,y,C;return x(e,function(e){switch(e.j){case 1:f=Tg(b.u,c,b.v);if(0!=f.type)throw new E(2,4,4022);return v(e,hh(b,f),2);case 2:g=e.s;if(!b.f)throw new E(2,7,7001);if(b.$&&0==g.variants.length)throw B.info("No stream is created, because we don't support AES-128","encryption yet"),new E(2,4,4034);b.f.filterAllPeriods([g]);h=Infinity;k=0;m=Infinity;for(var F=t(b.b.values()),z=F.next();!z.done;z=F.next())n=z.value,h=Math.min(h,n.nd),k=Math.max(k,
n.nd),"text"!=n.stream.type&&(m=Math.min(m,n.duration));b.g!=dh.Va?(b.c=new X(0,3*b.F),b.c.dc(!1)):(b.c=new X(null,0),b.c.dc(!0));ih(b);if(b.g!=dh.Va){b.T=b.H;p=dh;b.g==p.Rd&&(q=b.c.Dc,isNaN(b.a.availabilityWindowOverride)||(q=b.a.availabilityWindowOverride),b.c.Jd(q));for(r=0;95443.7176888889<=k;)r+=95443.7176888889,k-=95443.7176888889;if(r)for(B.debug("Offsetting live streams by",r,"to compensate for rollover"),F=t(b.b.values()),z=F.next();!z.done;z=F.next())y=z.value,95443.7176888889>y.nd?(B.D("Offset applied to",
y.stream.type),y.stream.presentationTimeOffset=-r,y.bc.offset(r)):B.D("Offset NOT applied to",y.stream.type)}else for(b.c.Ba(m),b.c.offset(-h),F=t(b.b.values()),z=F.next();!z.done;z=F.next())C=z.value,C.stream.presentationTimeOffset=h,C.bc.offset(-h),Wf(C.bc,m);b.o={presentationTimeline:b.c,periods:[g],offlineSessionIds:[],minBufferTime:0};w(e)}})})}
function hh(b,c){return u(function e(){var f,g,h,k,m,n,p,q,r,y,C,z;return x(e,function(e){switch(e.j){case 1:return f=Ng,g=wd,h=c.a,k=f.ub(c.a,"EXT-X-MEDIA"),m=k.filter(function(b){return"SUBTITLES"==jh(b,"TYPE")}.bind(b)),n=m.map(function(b){var c=this;return u(function ba(){var e;return x(ba,function(f){switch(f.j){case 1:if(c.a.disableText)return f["return"](null);Aa(f,2);return v(f,kh(c,b),4);case 4:return f["return"](f.s);case 2:e=Fa(f);if(c.a.hls.ignoreTextStreamFailures)return f["return"](null);
throw e;}})})}.bind(b)),p=k.filter(function(b){return"CLOSED-CAPTIONS"==jh(b,"TYPE")}),lh(b,p),v(e,Promise.all(n),2);case 2:return q=e.s,r=f.ub(h,"EXT-X-STREAM-INF"),y=r.map(function(b){return mh(this,b,c)}.bind(b)),v(e,Promise.all(y),3);case 3:return C=e.s,z=C.reduce(g.Oc,[]),z=z.filter(function(b){return null!=b}),e["return"]({startTime:0,variants:z,textStreams:q.filter(function(b){return null!=b})})}})})}
function mh(b,c,d){return u(function f(){var g,h,k,m,n,p,q,r,y,C,z,F,H,R,sa,ba,Ya,Ia,la,Za,ea,ta,Ja,Oa,ua,$a,mb,Pa,Bb;return x(f,function(f){switch(f.j){case 1:g=zd;h=Ng;k=[];b.a.disableVideo||k.push("avc1.42E01E");b.a.disableAudio||k.push("mp4a.40.2");m=k.join(",");n=Lg(c,"CODECS",m);p=nh(n.split(/\s*,\s*/));q=c.getAttribute("RESOLUTION");y=r=null;C=Lg(c,"FRAME-RATE");z=Number(jh(c,"BANDWIDTH"));q&&(F=q.value.split("x"),r=F[0],y=F[1]);H=h.ub(d.a,"EXT-X-MEDIA");H=H.filter(function(b){return"CLOSED-CAPTIONS"!=
jh(b,"TYPE")});H=H.filter(function(b){var c=Lg(b,"URI")||"";return"SUBTITLES"==(Lg(b,"TYPE")||"")||""!=c});R=Lg(c,"AUDIO");sa=Lg(c,"VIDEO");R?H=h.Xc(H,"AUDIO",R):sa&&(H=h.Xc(H,"VIDEO",sa));if(ba=oh(g.va,p)){if(Ya=Lg(c,"SUBTITLES"))if(Ia=h.Xc(H,"SUBTITLES",Ya),Ia.length&&(la=b.G.get(Ia[0].id)))la.stream.codecs=ba;Pb(p,ba)}Za=H.map(function(b){return ph(this,b,p)}.bind(b));ea=[];ta=[];return v(f,Promise.all(Za),2);case 2:Oa=f.s;Oa=Oa.filter(function(b){return null!=b});R?ea=Oa:sa&&(ta=Oa);B.debug("Guessing stream type for",
c.toString());$a=!1;ea.length||ta.length?ea.length?(Pa=jh(c,"URI"),Bb=ea[0].Jc,Pa==Bb?(B.debug("Guessing audio-only."),ua=g.Nb,$a=!0):(B.debug("Guessing video."),ua=g.Ua)):(B.debug("Guessing audio."),ua=g.Nb):1==p.length?(mb=oh(g.Ua,p),q||C||mb?(B.debug("Guessing video-only."),ua=g.Ua):(B.debug("Guessing audio-only."),ua=g.Nb)):(B.debug("Guessing multiplexed audio+video."),ua=g.Ua,p=[p.join(",")]);if($a){f.C(3);break}return v(f,qh(b,c,p,ua),4);case 4:Ja=f.s;case 3:if(Ja)Ja.stream.type==g.Nb?ea=[Ja]:
ta=[Ja];else if(null===Ja)return B.debug("streamInfo is null"),f["return"]([]);ta&&rh(ta);ea&&rh(ea);return f["return"](sh(b,ea,ta,z,r,y,C))}})})}function rh(b){b.forEach(function(b){if(b){var c=b.stream.codecs.split(",");c=c.filter(function(b){return"mp4a.40.34"!=b});b.stream.codecs=c.join(",")}})}
function sh(b,c,d,e,f,g,h){d.forEach(function(b){if(b=b.stream)b.width=Number(f)||void 0,b.height=Number(g)||void 0,b.frameRate=Number(h)||void 0}.bind(b));var k=b.a?b.a.disableAudio:!1;if(!c.length||k)c=[null];k=b.a?b.a.disableVideo:!1;if(!d.length||k)d=[null];k=[];c=t(c);for(var m=c.next();!m.done;m=c.next()){m=m.value;for(var n=t(d),p=n.next();!p.done;p=n.next()){var q=p.value;p=m?m.stream:null;var r=q?q.stream:null,y=m?m.drmInfos:null,C=q?q.drmInfos:null;q=(q?q.Jc:"")+" - "+(m?m.Jc:"");var z=
void 0;if(p&&r)if(y.length&&C.length?0<nd(y,C).length:1)z=nd(y,C);else{B.m("Incompatible DRM info in HLS variant.  Skipping.");continue}else p?z=y:r&&(z=C);b.V.has(q)?B.debug("Skipping variant which only differs in text streams."):(p=th(b,p,r,e,z),k.push(p),b.V.add(q))}}return k}function th(b,c,d,e,f){return{id:b.ea++,language:c?c.language:"und",primary:!!c&&c.primary||!!d&&d.primary,audio:c,video:d,bandwidth:e,drmInfos:f,allowedByApplication:!0,allowedByKeySystem:!0}}
function kh(b,c){return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return jh(c,"TYPE"),v(e,ph(b,c,[]),2);case 2:return f=e.s,e["return"](f.stream)}})})}function lh(b,c){for(var d=t(c),e=d.next();!e.done;e=d.next()){e=e.value;jh(e,"TYPE");var f=Lg(e,"LANGUAGE")||"und";f=N(f);var g=jh(e,"GROUP-ID");e=jh(e,"INSTREAM-ID");b.l.get(g)||b.l.set(g,new Map);b.l.get(g).set(e,f)}}
function ph(b,c,d){return u(function f(){var g,h,k,m,n,p,q,r,y,C,z;return x(f,function(f){switch(f.j){case 1:g=jh(c,"URI");if(b.b.has(g))return f["return"](b.b.get(g));h=jh(c,"TYPE").toLowerCase();k=zd;"subtitles"==h&&(h=k.va);m=N(Lg(c,"LANGUAGE","und"));n=Lg(c,"NAME");p=c.getAttribute("DEFAULT");q="YES"==p;r=Lg(c,"CHANNELS");if("audio"==h)if(r){var F=r.split("/")[0];F=parseInt(F,10)}else F=null;else F=null;y=F;C=Lg(c,"CHARACTERISTICS");return v(f,uh(b,g,d,h,m,q,n,y,null,C),2);case 2:z=f.s;if(b.b.has(g))return f["return"](b.b.get(g));
if(null==z)return f["return"](null);b.G.set(c.id,z);b.b.set(g,z);return f["return"](z)}})})}
function qh(b,c,d,e){return u(function g(){var h,k,m,n,p;return x(g,function(g){switch(g.j){case 1:h=zd;k=jh(c,"URI");if(b.b.has(k))return g["return"](b.b.get(k));m=Lg(c,"CLOSED-CAPTIONS");n=null;e==h.Ua&&m&&"NONE"!=m&&(n=b.l.get(m));return v(g,uh(b,k,d,e,"und",!1,null,null,n,null),2);case 2:p=g.s;if(null==p)return g["return"](null);if(b.b.has(k))return g["return"](b.b.get(k));b.b.set(k,p);return g["return"](p)}})})}
function uh(b,c,d,e,f,g,h,k,m,n){return u(function q(){var r,y,C,z,F,H,R,sa,ba,Ya,Ia,la,Za,ea,ta,Ja,Oa,ua,$a,mb,Pa,Bb,Cb,Db,nb,Da,ob;return x(q,function(q){switch(q.j){case 1:return r=Ng,y=r.Pc(b.v,c),v(q,bh(b,Wb([y],b.a.retryParameters),0),2);case 2:C=q.s;y=C.uri;z=Tg(b.u,C.data,y);if(1!=z.type)throw new E(2,4,4017);F=[];z.segments.forEach(function(b){b=r.ub(b.b,"EXT-X-KEY");F.push.apply(F,b)});H=!1;R=[];sa=null;for(var Qa=t(F),Ba=Qa.next();!Ba.done;Ba=Qa.next())if(ba=Ba.value,Ya=jh(ba,"METHOD"),
"NONE"!=Ya){H=!0;if("AES-128"==Ya)return B.m("Unsupported HLS Encryption",Ya),b.$=!0,q["return"](null);Ia=jh(ba,"KEYFORMAT");(Za=(la=vh[Ia])?la(ba):null)?(Za.keyIds.length&&(sa=Za.keyIds[0]),R.push(Za)):B.m("Unsupported HLS KEYFORMAT",Ia)}if(H&&!R.length)throw new E(2,4,4026);wh(b,z);ea=xh(e,d);return v(q,yh(b,e,ea,z),3);case 3:return ta=q.s,zh.includes(ta)&&(ea=""),Oa=(Ja=r.Ya(z.a,"EXT-X-MEDIA-SEQUENCE"))?Number(Ja.value):0,Aa(q,4),v(q,fh(b,c,z,Oa,ta,ea),6);case 6:ua=q.s;Ea(q,5);break;case 4:$a=
Fa(q);if(4035==$a.code)return B.Z("Skipping unsupported HLS stream",ta,c),q["return"](null);throw $a;case 5:return mb=ua[0].startTime,Pa=ua[ua.length-1].endTime,Bb=Pa-mb,Cb=new Vf(ua),Db=Ah(z),nb=void 0,"text"==e&&(nb="subtitle"),Da=[],n&&Da.push(n),ob={id:b.ea++,originalId:h,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:Cb.find.bind(Cb),getSegmentReference:Cb.get.bind(Cb),initSegmentReference:Db,presentationTimeOffset:0,mimeType:ta,codecs:ea,kind:nb,encrypted:H,keyId:sa,language:f,
label:h,type:e,primary:g,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:Da,channelsCount:k,audioSamplingRate:null,closedCaptions:m},q["return"]({stream:ob,bc:Cb,drmInfos:R,Jc:c,Qe:y,nd:mb,Qg:Pa,duration:Bb})}})})}
function wh(b,c){var d=dh,e=Ng.Ya(c.a,"EXT-X-PLAYLIST-TYPE"),f=Ng.Ya(c.a,"EXT-X-ENDLIST");f=e&&"VOD"==e.value||f;e=e&&"EVENT"==e.value&&!f;e=!f&&!e;f?gh(b,d.Va):(e?gh(b,d.Rd):gh(b,d.Le),d=Bh(c.a,"EXT-X-TARGETDURATION"),d=Number(d.value),b.F=Math.max(d,b.F),b.H=Math.min(d,b.H))}
function Ah(b){var c=Ng.ub(b.a,"EXT-X-MAP");if(!c.length)return null;if(1<c.length)throw new E(2,4,4020);c=c[0];var d=jh(c,"URI"),e=Ng.Pc(b.b,d);b=0;d=null;if(c=Lg(c,"BYTERANGE"))b=c.split("@"),c=Number(b[0]),b=Number(b[1]),d=b+c-1;return new Sf(function(){return[e]},b,d)}
function Ch(b,c,d,e){var f=c.b,g=c.a;c=Bh(f,"EXTINF").value.split(",");c=e+Number(c[0]);var h=0,k=null;if(f=Ng.Ya(f,"EXT-X-BYTERANGE"))h=f.value.split("@"),f=Number(h[0]),h=h[1]?Number(h[1]):b.a+1,k=h+f-1;return new V(d,e,c,function(){return[g]},h,k)}function ih(b){b.c&&(b.K.forEach(function(c){b.c.Eb(c,0)}),b.K=[])}
function fh(b,c,d,e,f,g){return u(function k(){var m,n,p,q,r,y,C,z,F,H,R;return x(k,function(k){switch(k.j){case 1:return m=d.segments,n=[],p=m[0].a,q=Ch(null,m[0],e,0),r=Ah(d),v(k,Dh(b,c,r,q,f,g),2);case 2:y=k.s;B.debug("First segment",p.split("/").pop(),"starts at",y);for(var ba=0;ba<m.length;++ba)C=m[ba],z=n[n.length-1],F=0==ba?y:z.endTime,H=e+ba,R=Ch(z,C,H,F),n.push(R);b.K.push(n);ih(b);return k["return"](n)}})})}
function Eh(b,c){return u(function e(){var f,g,h,k,m,n;return x(e,function(e){switch(e.j){case 1:f=1;g=sg(c.c(),c.b,c.b+2048-1,b.a.retryParameters);h=sg(c.c(),c.b,c.a,b.a.retryParameters);if(b.a.hls.useFullSegmentsForStartTime)return e["return"](bh(b,h,f));Aa(e,2);return v(e,bh(b,g,f),4);case 4:return k=e.s,e["return"](k);case 2:m=Fa(e);if(7001==m.code)throw m;B.Z("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",
g.uris[0]);return v(e,bh(b,h,f),5);case 5:return n=e.s,e["return"](n)}})})}
function Dh(b,c,d,e,f,g){return u(function k(){var m,n,p,q,r,y,C,z,F;return x(k,function(k){switch(k.j){case 1:if(b.o){m=b.b.get(c);n=m.bc;if(p=n.get(e.position))return B.D("Found segment start time in previous manifest"),k["return"](p.startTime);B.debug("Unable to find segment start time in previous manifest!")}B.D("Fetching segment to find start time");f=f.toLowerCase();if(zh.includes(f))throw B.Z("Raw formats are not yet supported.  Skipping "+f),new E(1,4,4035);if("video/webm"==f)throw B.Z("WebM in HLS is not yet supported.  Skipping."),
new E(1,4,4035);if("video/mp4"!=f&&"audio/mp4"!=f){k.C(2);break}q=[Eh(b,e)];d&&q.push(Eh(b,d));return v(k,Promise.all(q),3);case 3:return r=k.s,y=r[0],C=r[1]||r[0],k["return"](Fh(c,y.uri,y.data,C.data));case 2:if("video/mp2t"!=f){k.C(4);break}return v(k,Eh(b,e),5);case 5:return z=k.s,k["return"](Gh(c,z.uri,z.data));case 4:if("application/mp4"!=f&&!f.startsWith("text/")){k.C(6);break}return v(k,Eh(b,e),7);case 7:return F=k.s,k["return"](Hh(f,g,F.data));case 6:throw new E(2,4,4030,c);}})})}
function Fh(b,c,d,e){var f=0;(new T).L("moov",yf).L("trak",yf).L("mdia",yf).ia("mdhd",function(b){b.reader.P(0==b.version?8:16);f=b.reader.I();b.parser.stop()}).parse(e,!0);if(!f)throw B.error("Unable to find timescale in init segment!"),new E(2,4,4030,b,c);var g=0,h=!1;(new T).L("moof",yf).L("traf",yf).ia("tfdt",function(b){g=(0==b.version?b.reader.I():b.reader.Kb())/f;h=!0;b.parser.stop()}).parse(d,!0);if(!h)throw new E(2,4,4030,b,c);return g}
function Gh(b,c,d){function e(){g.seek(h+188);k=g.na();71!=k&&(g.seek(h+192),k=g.na());71!=k&&(g.seek(h+204),k=g.na());71!=k&&f();g.ze(1)}function f(){throw new E(2,4,4030,b,c);}for(var g=new S(new DataView(d),0),h=0,k=0;;)if(h=g.ga(),k=g.na(),71!=k&&f(),d=g.$b(),8191==(d&8191))e();else if(d&16384)if(d=(g.na()&48)>>4,0!=d&&2!=d||f(),3==d&&(d=g.na(),g.P(d)),1!=g.I()>>8)e();else{g.P(3);d=g.na()>>6;0!=d&&1!=d||f();0==g.na()&&f();d=g.na();var m=g.$b(),n=g.$b();return(1073741824*((d&14)>>1)+((m&65534)<<
14|(n&65534)>>1))/9E4}else e()}function Hh(b,c,d){b=pc(b,c);if(!Yd(b))return 0;c=new Wd(null);Zd(c,b);return c.sc(d)}function nh(b){var c=new Set,d=[];b=t(b);for(var e=b.next();!e.done;e=b.next()){e=e.value;var f=sc(e)[0];c.has(f)?B.debug("Ignoring duplicate codec"):(d.push(e),c.add(f))}return d}function oh(b,c){for(var d=Ih[b],e=0;e<d.length;e++)for(var f=0;f<c.length;f++)if(d[e].test(c[f].trim()))return c[f].trim();return"text"==b?"":null}
function xh(b,c){if(1==c.length)return c[0];var d=oh(b,c);if(null!=d)return d;throw new E(2,4,4025,c);}
function yh(b,c,d,e){return u(function g(){var h,k,m,n,p,q,r,y,C;return x(g,function(g){switch(g.j){case 1:h=zd;k=e.segments[0].a;m=new ib(k);n=m.la.split(".").pop();p=Jh[c];if(q=p[n])return g["return"](q);if(c==h.va)return d&&"vtt"!=d&&"wvtt"!=d?g["return"]("application/mp4"):g["return"]("text/vtt");r=Wb([k],b.a.retryParameters);r.method="HEAD";return v(g,bh(b,r,1),2);case 2:y=g.s;C=y.headers["content-type"];if(!C)throw new E(2,4,4021,n);return g["return"](C.split(";")[0])}})})}
function jh(b,c){var d=b.getAttribute(c);if(!d)throw new E(2,4,4023,c);return d.value}function Bh(b,c){var d=Ng.Ya(b,c);if(!d)throw new E(2,4,4024,c);return d}
var Ih={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},zh=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],Jh={audio:{mp4:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",
m4s:"application/mp4",m4i:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function $g(b){u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:B.info("Updating manifest...");if(!b.f)return d["return"]();Aa(d,2);return v(d,b.update(),4);case 4:e=b.T;b.h.R(e);Ea(d,0);break;case 2:f=Fa(d);if(!b.f)return d["return"]();f.severity=1;b.f.onError(f);b.h.R(.1);w(d)}})})}function gh(b,c){b.g=c;b.c&&b.c.dc(b.g==dh.Va);b.g!=dh.Va||b.h.stop()}
function bh(b,c,d){if(!b.i)throw new E(2,7,7001);c=b.f.networkingEngine.request(d,c);Tb(b.i,c);return c.promise}
var vh={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(b){var c=jh(b,"METHOD");ze("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var d=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(!d.includes(c))return B.error("Widevine in HLS is only supported with [",d.join(", "),"], not",c),null;c=jh(b,"URI");c=Yg.parse(c);c=new Uint8Array(c.data);c=yd("com.widevine.alpha",[{initDataType:"cenc",initData:c}]);if(b=Lg(b,"KEYID"))c.keyIds=[b.toLowerCase().substr(2)];
return c}},ah="VOD",dh={Va:ah,Le:"EVENT",Rd:"LIVE"};W.zd("m3u8",Zg);W.Lb("application/x-mpegurl",Zg);W.Lb("application/vnd.apple.mpegurl",Zg);function Kh(){this.a=new Map}function Lh(b,c,d){Mh(b,c).text=d}function Mh(b,c){b.a.has(c)||b.a.set(c,new Nh);return b.a.get(c)}function Nh(){this.text=this.variant=null};function Oh(b,c){this.a=b;this.b=new Set([b]);c=c||[];for(var d=t(c),e=d.next();!e.done;e=d.next())this.add(e.value)}Oh.prototype.add=function(b){if(Ph(this.a,b))return this.b.add(b),!0;B.m("Rejecting variant - not compatible with root.");return!1};
function Ph(b,c){var d;if(!(d=!!b.audio!=!!c.audio||!!b.video!=!!c.video||b.language!=c.language)&&(d=b.audio&&c.audio)){d=b.audio;var e=c.audio;d=!(d.channelsCount==e.channelsCount&&Qh(d,e)&&Rh(d.roles,e.roles))}!d&&(d=b.video&&c.video)&&(d=b.video,e=c.video,d=!(Qh(d,e)&&Rh(d.roles,e.roles)));return d?!1:!0}Oh.prototype.values=function(){return this.b.values()};
function Qh(b,c){if(b.mimeType!=c.mimeType)return!1;var d=b.codecs.split(",").map(function(b){return sc(b)[0]}),e=c.codecs.split(",").map(function(b){return sc(b)[0]});if(d.length!=e.length)return!1;d.sort();e.sort();for(var f=0;f<d.length;f++)if(d[f]!=e[f])return!1;return!0}function Rh(b,c){var d=new Set(b),e=new Set(c);d["delete"]("main");e["delete"]("main");if(d.size!=e.size)return!1;d=t(d);for(var f=d.next();!f.done;f=d.next())if(!e.has(f.value))return!1;return!0};function Sh(b){this.a=b;this.b=new Th(b.language,"",b.audio&&b.audio.channelsCount?b.audio.channelsCount:0,"")}Sh.prototype.create=function(b){var c=this,d=b.filter(function(b){return Ph(c.a,b)});return d.length?new Oh(d[0],d):this.b.create(b)};function Th(b,c,d,e,f){this.f=b;this.c=c;this.a=d;this.b=void 0===e?"":e;this.g=void 0===f?"":f}
Th.prototype.create=function(b){var c=[];c=Uh(b,this.f);var d=b.filter(function(b){return b.primary});c=c.length?c:d.length?d:b;this.c&&(b=Vh(c,this.c,this.g),b.length?c=b:B.m("No exact match for variant role could be found."));this.a&&(b=O.$d(c,this.a),b.length?c=b:B.m("No exact match for the channel count could be found."));this.b&&(b=Wh(c,this.b),b.length?c=b:B.m("No exact match for variant label could be found."));b=new Oh(c[0]);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,Ph(b.a,d)&&b.add(d);
return b};function Uh(b,c){var d=N(c),e=we(d,b.map(function(b){return ve(b)}));return e?b.filter(function(b){return e==ve(b)}):[]}function Vh(b,c,d){return b.filter(function(b){if(d){var e=b[d];return e&&e.roles.includes(c)}e=b.audio;b=b.video;return e&&0<=e.roles.indexOf(c)||b&&0<=b.roles.indexOf(c)})}function Wh(b,c){return b.filter(function(b){return b.audio?b.audio.label.toLowerCase()==c.toLowerCase():!1})};function Xh(){this.a=Yh;this.b=(new Map).set(Yh,2).set(Zh,1)}function $h(b,c,d){b.b.set(Yh,d).set(Zh,c)}var Zh=0,Yh=1;function ai(b,c){this.g=b;this.h=bi(b);this.a=b.a.currentTime;this.f=Date.now()/1E3;this.b=!1;this.i=c;this.c=function(){}}ai.prototype.release=function(){this.g=null;this.c=function(){}};function ci(b,c){b.c=c}function di(b){this.a=b}function bi(b){if(b.a.paused||0==b.a.playbackRate||0==b.a.buffered.length)var c=!1;else a:{c=b.a.buffered;b=b.a.currentTime;for(var d=0;d<c.length;d++){var e=c.start(d),f=c.end(d);if(!(b<e-.1||b>f-.5)){c=!0;break a}}c=!1}return c};function ei(b,c,d,e,f){var g=this;this.a=b;this.v=c;this.u=d;this.l=f;this.f=new L;this.i=!1;this.o=b.readyState;this.c=!1;this.b=e;this.h=!1;this.f.B(b,"waiting",function(){return fi(g)});this.g=(new D(function(){fi(g)})).Ka(.25)}ei.prototype.release=function(){this.f&&(this.f.release(),this.f=null);null!=this.g&&(this.g.stop(),this.g=null);this.b&&(this.b.release(),this.b=null);this.a=this.v=this.l=null};ei.prototype.td=function(){this.h=!0;fi(this)};
function fi(b){if(0!=b.a.readyState){if(b.a.seeking){if(!b.i)return}else b.i=!1;if(!b.a.paused){b.a.readyState!=b.o&&(b.c=!1,b.o=b.a.readyState);var c;if(!(c=!b.b)){c=b.b;var d=c.g,e=bi(d),f=d.a.currentTime,g=Date.now()/1E3;if(c.a!=f||c.h!=e)c.f=g,c.a=f,c.h=e,c.b=!1;f=g-c.f;if(e=f>=c.i&&e&&!c.b)c.c(c.a,f),c.b=!0,c.a=d.a.currentTime;c=!e}if(c){g=b.u.smallGapLimit;c=b.a.currentTime;d=b.a.buffered;a:{if(d&&d.length&&!(1==d.length&&1E-6>d.end(0)-d.start(0)))for(e=wc()||yc("Trident/")||yc("Tizen")||yc("CrKey")?
.5:.1,f=0;f<d.length;f++)if(d.start(f)>c&&(0==f||d.end(f-1)-c<=e)){e=f;break a}e=null}if(null!=e&&(0!=e||b.h)){f=d.start(e);var h=b.v.Ga();if(!(f>=h)){h=f-c;g=h<=g;var k=!1;if(!(.001>h)){if(!g&&!b.c){b.c=!0;var m=new J("largegap",{currentTime:c,gapSize:h});m.cancelable=!0;b.l(m);b.u.jumpLargeGaps&&!m.defaultPrevented?k=!0:B.info("Ignoring large gap at",c,"size",h)}if(g||k)0==e?B.info("Jumping forward",h,"seconds because of gap before start time of",f):B.info("Jumping forward",h,"seconds because of gap starting at",
d.end(e-1),"and ending at",f),b.a.currentTime=f}}}}}}};function gi(b){var c=this;this.c=b;this.a=new Set;this.b=(new D(function(){hi(c,!1)})).Ka(.25)}gi.prototype.release=function(){this.b.stop();for(var b=t(this.a),c=b.next();!c.done;c=b.next())c.value.release();this.a.clear()};function hi(b,c){for(var d=t(b.a),e=d.next();!e.done;e=d.next())e.value.g(b.c.currentTime,c)};function ii(b){var c=[];b=t(b);for(var d=b.next();!d.done;d=b.next()){d=t(d.value.variants);for(var e=d.next();!e.done;e=d.next())c.push(e.value)}return c}function ji(b,c){for(var d=null,e=t(b),f=e.next();!f.done;f=e.next())f=f.value,c>=f.startTime&&(d=f);return d};function ki(b){this.c=b;this.a=null;this.b=function(){}}ki.prototype.release=function(){this.a=this.c=null;this.b=function(){}};ki.prototype.g=function(b){var c=this.a,d=this.c.periods;b=ji(d,b)||d[0];c!=b&&this.b(b);this.a=b};function li(b,c){b.b=c};function mi(b){var c=this;this.a=b;this.f=!1;this.c=this.a.rc();this.b=new D(function(){c.a.le(.25*c.c)})}mi.prototype.release=function(){this.b&&(this.b.stop(),this.b=null);this.a=null};mi.prototype.set=function(b){this.c=b;ni(this)};function ni(b){b.b.stop();var c=b.f?0:b.c;if(0<=c)try{b.a.rc()!=c&&b.a.Id(c);return}catch(d){}b.b.Ka(.25);0!=b.a.rc()&&b.a.Id(0)};/*

 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function oi(b,c,d,e){c==HTMLMediaElement.HAVE_NOTHING||b.readyState>=c?e():(c=pi.get(c),d.ua(b,c,e))}var pi=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function qi(b,c,d){var e=this;this.a=b;this.g=c;this.f=d;this.h=!1;this.b=new L;this.c=new ri(b);oi(this.a,HTMLMediaElement.HAVE_METADATA,this.b,function(){si(e,e.f)})}qi.prototype.release=function(){this.b&&(this.b.release(),this.b=null);null!=this.c&&(this.c.release(),this.c=null);this.g=function(){};this.a=null};function ti(b){return b.h?b.a.currentTime:b.f}function ui(b,c){0<b.a.readyState?vi(b.c,c):oi(b.a,HTMLMediaElement.HAVE_METADATA,b.b,function(){si(b,b.f)})}
function si(b,c){.001>Math.abs(b.a.currentTime-c)?wi(b):(b.b.ua(b.a,"seeking",function(){wi(b)}),vi(b.c,0==b.a.currentTime?c:b.a.currentTime))}function wi(b){b.h=!0;b.b.B(b.a,"seeking",function(){return b.g()})}function ri(b){var c=this;this.b=b;this.h=10;this.g=this.c=this.f=0;this.a=new D(function(){0>=c.f?(B.m(["Failed to move playhead from",c.c,"to",c.g].join(" ")),c.a.stop()):c.b.currentTime!=c.c?c.a.stop():(c.b.currentTime=c.g,c.f--)})}
ri.prototype.release=function(){this.a&&(this.a.stop(),this.a=null);this.b=null};function vi(b,c){b.c=b.b.currentTime;b.g=c;b.f=b.h;b.b.currentTime=c;b.a.Ka(.1)};function xi(b){function c(){null==d.c?d.f=!0:(d.b.ua(d.a,"seeking",function(){d.f=!0}),d.a.currentTime=Math.max(0,d.a.currentTime+d.c))}var d=this;this.a=b;this.f=!1;this.c=null;this.b=new L;oi(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,function(){c()})}xi.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.a=null};xi.prototype.o=function(b){this.c=this.f?this.c:b};xi.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0};xi.prototype.u=function(){};
function yi(b,c,d,e,f,g){var h=this;this.c=b;this.a=c.presentationTimeline;this.F=c.minBufferTime||0;this.h=d;this.v=f;this.l=null;this.f=new ei(b,c.presentationTimeline,d,zi(b,d),g);this.b=new qi(b,function(){a:{var b=h.f;b.i=!0;b.h=!1;b.c=!1;b=ti(h.b);var c=Ai(h,b);if(.001<Math.abs(c-b)){var d=Date.now()/1E3;if(!h.l||h.l<d-1){h.l=d;ui(h.b,c);b=void 0;break a}}B.D("Seek to "+b);h.v();b=void 0}return b},Bi(this,e));this.i=(new D(function(){if(0!=h.c.readyState&&!h.c.paused){var b=ti(h.b),c=h.a.wb(),
d=h.a.Ga();3>d-c&&(c=d-3);b<c&&(c=Ai(h,b),B.info("Jumping forward "+(c-b)+" seconds to catch up with the seek range."),h.c.currentTime=c)}})).Ka(.25)}yi.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.f&&(this.f.release(),this.f=null);this.i&&(this.i.stop(),this.i=null);this.c=this.b=this.a=this.h=null;this.v=function(){}};yi.prototype.o=function(b){ui(this.b,b)};yi.prototype.g=function(){var b=ti(this.b);return 0<this.c.readyState&&!this.c.paused?Ci(this,b):b};
function Bi(b,c){null==c?c=Infinity>b.a.ca()?b.a.wb():b.a.Ga():0>c&&(c=b.a.Ga()+c);return Di(b,Ci(b,c))}yi.prototype.u=function(){this.f.td()};function Di(b,c){var d=b.a.ca();return c>=d?d-b.h.durationBackoff:c}
function Ai(b,c){var d=td.bind(null,b.c.buffered),e=Math.max(b.F,b.h.rebufferingGoal),f=b.h.safeSeekOffset,g=b.a.wb(),h=b.a.Ga(),k=b.a.ca();3>h-g&&(g=h-3);var m=b.a.Vb(e),n=b.a.Vb(f);e=b.a.Vb(e+f);if(c>=k)return B.D("Playhead past duration."),Di(b,c);if(c>h)return B.D("Playhead past end."),h;if(c<g){if(d(n))return B.D("Playhead before start & start is buffered"),n;B.D("Playhead before start & start is unbuffered");return e}if(c>=m||d(c))return B.D("Playhead in safe region or in buffered region."),
c;B.D("Playhead outside safe region & in unbuffered region.");return e}function Ci(b,c){var d=b.a.wb();if(c<d)return d;d=b.a.Ga();return c>d?d:c}function zi(b,c){if(!c.stallEnabled)return null;var d=c.stallSkip,e=new ai(new di(b),c.stallThreshold);ci(e,function(c,e){B.debug("Stall detected at "+c+" for "+e+" seconds.");d?(B.debug("Seeking forward "+d+" seconds to break stall."),b.currentTime+=d):(B.debug("Pausing and unpausing to break stall."),b.pause(),b.play())});return e};function Ei(b){var c=this;this.b=function(){};this.a=new Set;this.f=b;this.c=(new D(function(){for(var b=c.f(),e=t(c.a),f=e.next();!f.done;f=e.next())f=f.value,f.endTime<b.start&&c.a["delete"](f)})).Ka(2)}Ei.prototype.release=function(){this.b=function(){};this.a.clear();this.c.stop()};function Fi(b,c){b.b=c};function Gi(b){var c=this;this.h=b;this.f=new Map;this.a=function(){};this.b=function(){};this.c=function(){};this.i=[{lb:null,kb:Hi,ab:function(b,e){return c.a(b,e)}},{lb:Ii,kb:Hi,ab:function(b,e){return c.a(b,e)}},{lb:Ji,kb:Hi,ab:function(b,e){return c.a(b,e)}},{lb:Hi,kb:Ii,ab:function(b,e){return c.b(b,e)}},{lb:Hi,kb:Ji,ab:function(b,e){return c.b(b,e)}},{lb:Ii,kb:Ji,ab:function(b,e){return c.c(b,e)}},{lb:Ji,kb:Ii,ab:function(b,e){return c.c(b,e)}}]}
Gi.prototype.release=function(){this.h=null;this.f.clear();this.a=function(){};this.b=function(){};this.c=function(){}};Gi.prototype.g=function(b,c){for(var d=t(this.h.a),e=d.next();!e.done;e=d.next()){e=e.value;var f=this.f.get(e),g=b<e.startTime?Ii:b>e.endTime?Ji:Hi;this.f.set(e,g);for(var h=t(this.i),k=h.next();!k.done;k=h.next())k=k.value,k.lb==f&&k.kb==g&&k.ab(e,c)}};function Ki(b,c,d,e){b.a=c;b.b=d;b.c=e}var Ii=1,Hi=2,Ji=3;function Li(b,c){this.a=c;this.c=b;this.g=null;this.l=1;this.v=Promise.resolve();this.h=[];this.i=new Map;this.b=new Map;this.u=!1;this.H=null;this.G=this.f=this.o=!1;this.F=0}Li.prototype.destroy=function(){var b=this;return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:e=[];for(var g=t(b.b.values()),k=g.next();!k.done;k=g.next())f=k.value,Mi(f),e.push(Ni(f));return v(d,Promise.all(e),2);case 2:b.b.clear(),b.i.clear(),b.a=null,b.c=null,b.v=null,b.h=null,b.g=null,b.f=!0,w(d)}})})};
Li.prototype.configure=function(b){this.g=b;this.H=new zb({maxAttempts:Math.max(b.retryParameters.maxAttempts,2),baseDelay:b.retryParameters.baseDelay,backoffFactor:b.retryParameters.backoffFactor,fuzzFactor:b.retryParameters.fuzzFactor,timeout:0},!0)};
Li.prototype.start=function(){var b=this;return u(function d(){var e,f,g;return x(d,function(d){switch(d.j){case 1:return e=b.a.Za(),f=Oi(b,e),g=b.a.oe(b.c.periods[f]),g.variant||g.text?v(d,Pi(b,g.variant?g.variant.audio:null,g.variant?g.variant.video:null,g.text,e),2):(B.error("init: no Streams chosen"),d["return"](new E(2,5,5005)));case 2:if(b.f)return d["return"]();B.debug("init: completed initial Stream setup");b.a&&b.a.Pf&&(B.D("init: calling onInitialStreamsSetup()..."),b.a.Pf());w(d)}})})};
function Qi(b){return Ri(b,"audio")}function Si(b){return Ri(b,"video")}function Ri(b,c){var d=b.b.get(c);return d?d.Pa||d.stream:null}
function Ti(b,c){return u(function e(){var f,g,h,k,m,n,p,q,r,y;return x(e,function(e){switch(e.j){case 1:return f=zd,v(e,oe(b.a.O,f.va),2);case 2:return b.F++,b.G=!1,g=b.F,h=b.a.O,k=new Map,m=new Set,k.set(f.va,c),m.add(c),v(e,h.init(k,!1),3);case 3:return b.f?e["return"]():v(e,Ui(b,m),4);case 4:if(b.f)return e["return"]();p=(n=b.a.O.g.isTextVisible())||b.g.alwaysStreamText;b.F!=g||b.b.has(f.va)||b.G||!p||(q=b.a.Za(),r=Oi(b,q),y=Vi(c,r,0),b.b.set(f.va,y),Wi(b,y,0));w(e)}})})}
function Xi(b){b.G=!0;var c=b.b.get("text");c&&(Mi(c),Ni(c)["catch"](function(){}),b.b["delete"]("text"))}function Yi(b,c){var d=b.b.get("video");if(d){var e=d.stream;if(e)if(B.debug("setTrickPlay",c),c){var f=e.trickModeVideo;f&&!d.Pa&&(B.debug("Engaging trick mode stream",f),Zi(b,f,!1,0,!1),d.Pa=e)}else if(e=d.Pa)B.debug("Restoring non-trick-mode stream",e),d.Pa=null,Zi(b,e,!0,0,!1)}}
function $i(b,c,d,e){var f=!1;if(c.video){var g=Zi(b,c.video,d,e,!1);f=f||g}c.audio&&(b=Zi(b,c.audio,d,e,!1),f=f||b);return f}
function Zi(b,c,d,e,f){var g=b.b.get(c.type);if(!g&&"text"==c.type&&b.g.ignoreTextStreamFailures)return Ti(b,c),!0;if(!g)return!1;var h=aj(b,c),k=Array.from(b.b.values()).every(function(b){return b.ka==g.ka});if(d&&h!=g.ka&&k)return B.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),b.b.forEach(function(c){bj(b,c)}),!0;g.Pa&&(B.debug("switch during trick play mode",c),c.trickModeVideo?(g.Pa=c,c=c.trickModeVideo,B.debug("switch found trick play stream",c)):
(g.Pa=null,B.debug("switch found no special trick play stream")));k=b.h[h];if(!k||!k.Mb)return!1;k=b.i.get(c.id);if(!k||!k.Mb)return!1;if(g.stream==c&&!f)return B.debug("switch: Stream "+cj(g)+" already active"),!1;"text"==c.type&&fe(b.a.O,pc(c.mimeType,c.codecs));g.stream=c;g.vc=!0;B.debug("switch: switching to Stream "+cj(g));dj(b,g,h)&&(B.info("Aborting current segment request to switch."),g.fb.abort());d&&(g.Wa?g.Kc=!0:g.Oa?(g.Sa=!0,g.lc=e,g.Kc=!0):(Mi(g),ej(b,g,!0,e)["catch"](function(c){if(b.a)b.a.onError(c)})));
return!0}function dj(b,c,d){if(!c.fb)return!1;var e=b.a.Za(),f=je(b.a.O,c.type),g=fj(b,c,e,f,d);d=g?g.a?g.a-g.b:null:null;g&&!d&&(d=(g.endTime-g.sc())*c.stream.bandwidth/8);if(isNaN(d))return!1;(g=c.stream.initSegmentReference)&&(d+=(g.a?g.a-g.b:null)||0);g=b.a.getBandwidthEstimate();return 8*d/g<f-e-Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal)||c.fb.b.a>d?!0:!1}
function gj(b){function c(c){var f=b.a.O;"text"==c?(c=f.a,c=null==c.a||null==c.b?!1:d>=c.a&&d<c.b):(c=ie(f,c),c=td(c,d,e));return c}var d=b.a.Za(),e=b.g.smallGapLimit,f=!1,g=Oi(b,d);if(mc(b.b.values(),function(b){return b.ka==g}))for(var h=t(b.b.keys()),k=h.next();!k.done;k=h.next())k=k.value,c(k)||(bj(b,b.b.get(k)),f=!0);else mc(b.b.keys(),c)||(B.debug("(all): seeked: unbuffered seek: clearing all buffers"),b.b.forEach(function(c){bj(b,c)}),f=!0);f||B.debug("(all): seeked: buffered seek: presentationTime="+
d)}function bj(b,c){var d=cj(c);c.Wa?B.debug(d,"clear: already clearing the buffer"):c.Sa?B.debug(d,"clear: already waiting"):c.Oa?(B.debug(d,"clear: currently updating"),c.Sa=!0,c.lc=0):null==he(b.a.O,c.type)?(B.debug(d,"clear: nothing buffered"),null==c.La&&Wi(b,c,0)):(B.debug(d,"clear: handling right now"),Mi(c),ej(b,c,!1,0)["catch"](function(c){if(b.a)b.a.onError(c)}))}
function Pi(b,c,d,e,f){return u(function h(){var k,m,n,p,q,r,y;return x(h,function(h){switch(h.j){case 1:return k=b.a.Za(),m=Oi(b,k),n=zd,p=new Map,q=new Set,c&&(p.set(n.Nb,c),q.add(c)),d&&(p.set(n.Ua,d),q.add(d)),e&&(p.set(n.va,e),q.add(e)),r=b.a.O,y=b.g.forceTransmuxTS,v(h,r.init(p,y),2);case 2:if(b.f)return h["return"]();hj(b);return v(h,Ui(b,q),3);case 3:if(b.f)return h["return"]();p.forEach(function(c,d){if(!b.b.has(d)){var e=Vi(c,m,f);b.b.set(d,e);Wi(b,e,0)}});w(h)}})})}
function Vi(b,c,d){return{stream:b,type:b.type,Cb:null,Ha:null,Pa:null,vc:!0,ka:c,endOfStream:!1,Oa:!1,La:null,Sa:!1,lc:0,Kc:!1,Wa:!1,yd:!1,Xb:!1,Bd:d||0,fb:null}}
function ij(b,c){var d=b.h[c];if(d)return B.debug("(all) Period "+c+" is being or has been set up"),d.promise;B.debug("(all) setting up Period "+c);d={promise:new G,Mb:!1};b.h[c]=d;for(var e=new Set,f=t(b.c.periods[c].variants),g=f.next();!g.done;g=f.next())g=g.value,g.video&&e.add(g.video),g.video&&g.video.trickModeVideo&&e.add(g.video.trickModeVideo),g.audio&&e.add(g.audio);f=t(b.c.periods[c].textStreams);for(g=f.next();!g.done;g=f.next())e.add(g.value);b.v=b.v.then(function(){if(!this.f)return Ui(this,
e)}.bind(b)).then(function(){this.f||(this.h[c].promise.resolve(),this.h[c].Mb=!0,B.D("(all) setup Period "+c))}.bind(b))["catch"](function(b){this.f||(this.h[c].promise["catch"](function(){}),this.h[c].promise.reject(),delete this.h[c],B.m("(all) failed to setup Period "+c),this.a.onError(b))}.bind(b));return d.promise}
function Ui(b,c){return u(function e(){var f,g,h,k,m,n,p;return x(e,function(e){switch(e.j){case 1:f=[];for(var q=t(c),y=q.next();!y.done;y=q.next())g=y.value,(h=b.i.get(g.id))?(B.debug("(all) Stream "+g.id+" is being or has been set up"),f.push(h.promise)):(B.D("(all) setting up Stream "+g.id),b.i.set(g.id,{promise:new G,Mb:!1}),f.push(g.createSegmentIndex()));Aa(e,2);return v(e,Promise.all(f),4);case 4:if(b.f)return e["return"]();Ea(e,3);break;case 2:k=Fa(e);if(b.f)return e["return"]();e=t(c);for(y=
e.next();!y.done;y=e.next())m=y.value,b.i.get(m.id).promise["catch"](function(){}),b.i.get(m.id).promise.reject(),b.i["delete"](m.id);throw k;case 3:q=t(c);for(y=q.next();!y.done;y=q.next())n=y.value,p=b.i.get(n.id),p.Mb||(p.promise.resolve(),p.Mb=!0,B.D("(all) setup Stream "+n.id));w(e)}})})}function hj(b){var c=b.c.presentationTimeline.ca();Infinity>c?b.a.O.Ba(c):b.a.O.Ba(Math.pow(2,32))}
function jj(b,c){if(!b.f){var d=cj(c);if(!c.Oa&&null!=c.La&&!c.Wa)if(c.La=null,c.Sa)B.debug(d,"skipping update and clearing the buffer"),ej(b,c,c.Kc,c.lc);else{try{var e=kj(b,c);null!=e&&(Wi(b,c,e),c.Xb=!1)}catch(f){lj(b,f);return}e=Array.from(b.b.values());mj(b,c);b.u&&e.every(function(b){return b.endOfStream})&&(B.D(d,"calling endOfStream()..."),b.a.O.endOfStream().then(function(){if(!this.f){var b=this.a.O.ca();0!=b&&b<this.c.presentationTimeline.ca()&&this.c.presentationTimeline.Ba(b)}}.bind(b)))}}}
function kj(b,c){if(nj(c))return ne(b.a.O,c.stream.originalId||""),null;var d=cj(c),e=b.a.Za(),f=oj(b,c,e);B.J(d,"timeNeeded="+f);var g=aj(b,c.stream),h=Oi(b,f),k=ke(b.a.O,c.type,e);B.J(d,"update_:","presentationTime="+e,"bufferedAhead="+k);var m=Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal,b.g.bufferingGoal)*b.l;if(f>=b.c.presentationTimeline.ca())return B.debug(d,"buffered to end of presentation"),c.endOfStream=!0,"video"==c.type&&(f=b.b.get("text"))&&"application/cea-608"==f.stream.mimeType&&
(f.endOfStream=!0),null;c.endOfStream=!1;c.ka=h;if(h!=g)return B.debug(d,"need Period "+h,"presentationTime="+e,"timeNeeded="+f,"currentPeriodIndex="+g),null;if(k>=m)return B.J(d,"buffering goal met"),.5;d=je(b.a.O,c.type);d=fj(b,c,e,d,g);if(!d)return 1;var n=Infinity;Array.from(b.b.values()).forEach(function(c){nj(c)||(c=oj(b,c,e),n=Math.min(n,c))});if(f>=n+b.c.presentationTimeline.a)return 1;c.Bd=0;pj(b,c,e,g,d);return null}
function oj(b,c,d){if(!c.Cb||!c.Ha)return Math.max(d,c.Bd);d=aj(b,c.Cb);return b.c.periods[d].startTime+c.Ha.endTime}
function fj(b,c,d,e,f){var g=cj(c);if(c.Ha&&c.stream==c.Cb)return e=c.Ha.position+1,B.J(g,"next position known:","position="+e),qj(b,c,f,e);c.Ha?(B.D(g,"next position unknown: another Stream buffered"),g=aj(b,c.Cb),g=rj(b,c,b.c.periods[g].startTime+c.Ha.endTime,f)):(B.D(g,"next position unknown: nothing buffered"),g=rj(b,c,e||d,f));if(null==g)return null;d=null;null==e&&(d=qj(b,c,f,Math.max(0,g-1)));return d||qj(b,c,f,g)}
function rj(b,c,d,e){var f=cj(c);b=b.c.periods[e];B.debug(f,"looking up segment:","presentationTime="+d,"currentPeriod.startTime="+b.startTime);d=Math.max(0,d-b.startTime);c=c.stream.findSegmentPosition(d);null==c&&B.m(f,"cannot find segment:","currentPeriod.startTime="+b.startTime,"lookupTime="+d);return c}
function qj(b,c,d,e){var f=cj(c);d=b.c.periods[d];c=c.stream.getSegmentReference(e);if(!c)return B.D(f,"segment does not exist:","currentPeriod.startTime="+d.startTime,"position="+e),null;e=b.c.presentationTimeline;b=e.Wb();e=e.xb();return d.startTime+c.endTime<b||d.startTime+c.startTime>e?(B.J(f,"segment is not available:","currentPeriod.startTime="+d.startTime,"reference.startTime="+c.startTime,"reference.endTime="+c.endTime,"availabilityStart="+b,"availabilityEnd="+e),null):c}
function pj(b,c,d,e,f){var g=cj(c),h=b.c.periods[e];B.D(g,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+h.startTime,"reference.position="+f.position,"reference.startTime="+f.startTime,"reference.endTime="+f.endTime);var k=c.stream,m=b.c.presentationTimeline.ca(),n=b.c.periods[e+1];e=sj(b,c,e,Math.max(0,h.startTime-.1),n?n.startTime+.01:m);c.Oa=!0;c.vc=!1;B.J(g,"fetching segment");m=tj(b,c,f);Promise.all([e,m]).then(function(b){if(!this.f&&!this.o)return uj(this,c,d,h,k,f,b[1])}.bind(b)).then(function(){this.f||
this.o||(c.Oa=!1,c.yd=!1,c.Sa||this.a.td(),Wi(this,c,0),vj(this,c,k),B.D(g,"finished fetch and append"))}.bind(b))["catch"](function(b){this.f||this.o||(c.Oa=!1,"text"==c.type&&this.g.ignoreTextStreamFailures?(1001==b.code?B.m(g,"Text stream failed to download. Proceeding without it."):B.m(g,"Text stream failed to parse. Proceeding without it."),this.b["delete"]("text")):7001==b.code?(c.Oa=!1,c.La=null,Wi(this,c,0)):3017==b.code?wj(this,c,b):(B.error(g,"failed fetch and append: code="+b.code),c.Xb=
!0,b.severity=2,lj(this,b)))}.bind(b))}
function wj(b,c,d){var e=cj(c);if(Array.from(b.b.values()).some(function(b){return b!=c&&b.yd}))B.debug(e,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var f=Math.round(100*b.l);if(20<f)b.l-=.2;else if(4<f)b.l-=.04;else{B.error(e,"MediaSource threw QuotaExceededError too many times");c.Xb=!0;b.o=!0;b.a.onError(d);return}B.m(e,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*b.l))+"%");c.yd=!0}Wi(b,c,4)}
function sj(b,c,d,e,f){if(!c.vc)return Promise.resolve();var g=cj(c);d=b.c.periods[d].startTime-c.stream.presentationTimeOffset;B.D(g,"setting timestamp offset to "+d);B.D(g,"setting append window start to "+e);B.D(g,"setting append window end to "+f);e=pe(b.a.O,c.type,d,e,f);if(!c.stream.initSegmentReference)return e;B.D(g,"fetching init segment");b=tj(b,c,c.stream.initSegmentReference).then(function(b){if(!this.f)return B.D(g,"appending init segment"),le(this.a.O,c.type,b,null,null,c.stream.closedCaptions&&
0<c.stream.closedCaptions.size)}.bind(b))["catch"](function(b){c.vc=!0;return Promise.reject(b)});return Promise.all([e,b])}
function uj(b,c,d,e,f,g,h){var k=cj(c),m=f.closedCaptions&&0<f.closedCaptions.size;null!=f.emsgSchemeIdUris&&0<f.emsgSchemeIdUris.length&&(new T).ia("emsg",b.K.bind(b,e,g,f.emsgSchemeIdUris)).parse(h);return xj(b,c,d).then(function(){if(!this.f)return B.D(k,"appending media segment"),le(this.a.O,c.type,h,g.startTime+e.startTime,g.endTime+e.startTime,m)}.bind(b)).then(function(){if(!this.f)return B.J(k,"appended media segment"),c.Cb=f,c.Ha=g,Promise.resolve()}.bind(b))}
Li.prototype.K=function(b,c,d,e){var f=e.reader.wd(),g=e.reader.wd(),h=e.reader.I(),k=e.reader.I(),m=e.reader.I(),n=e.reader.I();e=e.reader.gb(e.reader.N.byteLength-e.reader.ga());b=b.startTime+c.startTime+k/h;if(d.includes(f))if("urn:mpeg:dash:event:2012"==f)this.a.Qf();else this.a.onEvent(new J("emsg",{detail:{startTime:b,endTime:b+m/h,schemeIdUri:f,value:g,timescale:h,presentationTimeDelta:k,eventDuration:m,id:n,messageData:e}}))};
function xj(b,c,d){var e=cj(c);B.J(e,"checking buffer length");var f=Math.max(b.g.bufferBehind,b.c.presentationTimeline.a),g=he(b.a.O,c.type);if(null==g)return B.J(e,"buffer behind okay because nothing buffered:","presentationTime="+d,"bufferBehind="+f),Promise.resolve();var h=d-g,k=h-f;if(0>=k)return B.J(e,"buffer behind okay:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+f,"underflow="+-k),Promise.resolve();B.D(e,"buffer behind too large:","presentationTime="+d,"bufferedBehind="+h,
"bufferBehind="+f,"overflow="+k);return b.a.O.remove(c.type,g,g+k).then(function(){this.f||B.D(e,"evicted "+k+" seconds")}.bind(b))}
function vj(b,c,d){if(!b.u){var e=cj(c);c=Array.from(b.b.values());if(1!=c.length||"text"!=c[0].type)b.u=c.every(function(b){return"text"==b.type?!0:!b.Sa&&!b.Wa&&b.Ha});if(b.u){B.debug(e,"startup complete");d=aj(b,d);b.h[d]||ij(b,d).then(function(){this.f||(B.D(e,"calling onCanSwitch()..."),this.a.ne())}.bind(b))["catch"](wd.wc);for(d=0;d<b.c.periods.length;++d)ij(b,d)["catch"](wd.wc);b.a.Yf&&(B.D(e,"calling onStartupComplete()..."),b.a.Yf())}}}
function mj(b,c){var d=cj(c),e=aj(b,c.stream);if(c.ka!=e){var f=c.ka,g=Array.from(b.b.values());g.every(function(b){return b.ka==f||nj(b)})?g.every(yj)?(B.debug(d,"all need Period "+f),ij(b,f).then(function(){if(!this.f)if(g.every(function(b){var c=yj(b),d=aj(this,b.stream);return nj(b)?!0:c&&b.ka==f&&d!=f}.bind(this))){var b=this.c.periods[f];B.D(d,"calling onChooseStreams()...");var c=this.a.oe(b),e=new Map;c.variant&&c.variant.video&&e.set("video",c.variant.video);c.variant&&c.variant.audio&&e.set("audio",
c.variant.audio);c.text&&e.set("text",c.text);c=t(this.b.keys());for(var n=c.next();!n.done;n=c.next())if(n=n.value,!e.has(n)&&"text"!=n){B.error(d,"invalid Streams chosen: missing "+n+" Stream");this.a.onError(new E(2,5,5005));return}c=t(Array.from(e.keys()));for(n=c.next();!n.done;n=c.next())if(n=n.value,!this.b.has(n))if("text"==n)Pi(this,null,null,e.get("text"),b.startTime),e["delete"](n);else{B.error(d,"invalid Streams chosen: unusable "+n+" Stream");this.a.onError(new E(2,5,5005));return}c=
t(Array.from(this.b.keys()));for(n=c.next();!n.done;n=c.next()){n=n.value;var p=this.b.get(n),q=e.get(n);if(q){var r=nj(p);r&&(p.ka=f,p.Bd=b.startTime);Zi(this,q,!1,0,!1);r&&nj(p)||Wi(this,this.b.get(n),0)}else this.b["delete"](n)}B.D(d,"calling onCanSwitch()...");this.a.ne()}else B.debug(d,"ignoring transition to Period",f,"since another is happening")}.bind(b))["catch"](wd.wc)):B.debug(d,"all MediaStates need Period "+f+", but not all MediaStates are idle"):B.debug(d,"not all MediaStates need Period "+
f)}}function nj(b){return b&&"text"==b.type&&"application/cea-608"==b.stream.mimeType}function yj(b){return!b.Oa&&null==b.La&&!b.Sa&&!b.Wa}function Oi(b,c){var d=ji(b.c.periods,c+Ad);return d?b.c.periods.indexOf(d):0}
function aj(b,c){for(var d=b.c.periods,e=0;e<d.length;e++){for(var f=d[e],g=new Set,h=t(f.variants),k=h.next();!k.done;k=h.next())k=k.value,k.audio&&g.add(k.audio),k.video&&g.add(k.video),k.video&&k.video.trickModeVideo&&g.add(k.video.trickModeVideo);f=t(f.textStreams);for(h=f.next();!h.done;h=f.next())g.add(h.value);if(g.has(c))return e}return-1}
function tj(b,c,d){var e=sg(d.c(),d.b,d.a,b.g.retryParameters);B.J("fetching: reference=",d);b=b.a.Db.request(1,e);c.fb=b;return b.promise.then(function(b){c.fb=null;return b.data})}
function ej(b,c,d,e){return u(function g(){var h,k,m,n;return x(g,function(g){switch(g.j){case 1:return h=cj(c),c.Sa=!1,c.Kc=!1,c.lc=0,c.Wa=!0,c.Cb=null,c.Ha=null,B.debug(h,"clearing buffer"),e?(m=b.a.Za(),n=b.a.O.ca(),k=b.a.O.remove(c.type,m+e,n)):k=oe(b.a.O,c.type).then(function(){if(!this.f&&d)return this.a.O.flush(c.type)}.bind(b)),v(g,k,2);case 2:if(b.f)return g["return"]();B.debug(h,"cleared buffer");c.Wa=!1;c.endOfStream=!1;Wi(b,c,0);w(g)}})})}
function Wi(b,c,d){B.J(cj(c),"updating in "+d+" seconds");c.La=(new yb(function(){return u(function f(){var d;return x(f,function(f){switch(f.j){case 1:return Aa(f,2),v(f,jj(b,c),4);case 4:Ea(f,0);break;case 2:d=Fa(f);if(b.a)b.a.onError(d);w(f)}})})})).R(d)}function Mi(b){null!=b.La&&(b.La.stop(),b.La=null)}function Ni(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:if(b.fb)return v(d,b.fb.abort(),0);d.C(0)}})})}
function lj(b,c){Eb(b.H).then(function(){this.f||(this.a.onError(c),c.handled||this.g.failureCallback(c))}.bind(b))}function cj(b){return"("+b.type+":"+b.stream.id+")"};function zj(b,c,d,e,f,g){if(200<=d&&299>=d&&202!=d)return{uri:f||e,vd:e,data:c,headers:b,fromCache:!!b["x-shaka-from-cache"]};f=null;try{f=ic(c)}catch(h){}B.debug("HTTP error text:",f);throw new E(401==d||403==d?2:1,1,1001,e,d,f,b,g);};function Aj(b,c,d,e){var f=new Aj.b;nc(c.headers).forEach(function(b,c){f.append(c,b)});var g=new Aj.a,h={Ud:!1,He:!1};b=Aj.l(b,d,{body:c.body||void 0,headers:f,method:c.method,signal:g.signal,credentials:c.allowCrossSiteCredentials?"include":void 0},h,e);b=new I(b,function(){h.Ud=!0;g.abort();return Promise.resolve()});if(c=c.retryParameters.timeout){var k=new D(function(){h.He=!0;g.abort()});k.R(c/1E3);b["finally"](function(){k.stop()})}return b}A("shaka.net.HttpFetchPlugin",Aj);
Aj.l=function(b,c,d,e,f){return u(function h(){var k,m,n,p,q,r,y,C,z,F,H,R,sa,ba;return x(h,function(h){switch(h.j){case 1:return k=Aj.g,m=Aj.c,r=q=0,y=Date.now(),Aa(h,2),v(h,k(b,d),4);case 4:return n=h.s,C=n.clone().body.getReader(),F=(z=n.headers.get("Content-Length"))?parseInt(z,10):0,H=function(b){function c(){return u(function ea(){var d,e,h;return x(ea,function(k){switch(k.j){case 1:return Aa(k,2),v(k,C.read(),4);case 4:d=k.s;Ea(k,3);break;case 2:return e=Fa(k),B.D("error reading from stream",
e.message),k["return"]();case 3:d.done||(q+=d.value.byteLength);h=Date.now();if(100<h-y||d.done)f(h-y,q-r,F-q),r=q,y=h;d.done?b.close():(b.enqueue(d.value),c());w(k)}})})}c()},new m({start:H}),v(h,n.arrayBuffer(),5);case 5:p=h.s;Ea(h,3);break;case 2:R=Fa(h);if(e.Ud)throw new E(1,1,7001,b,c);if(e.He)throw new E(1,1,1003,b,c);throw new E(1,1,1002,b,R,c);case 3:return sa={},ba=n.headers,ba.forEach(function(b,c){sa[c.trim()]=b}),h["return"](zj(sa,p,n.status,b,n.url,c))}})})};
Aj.isSupported=function(){if(window.ReadableStream)try{new ReadableStream({})}catch(b){return!1}else return!1;return!(!window.fetch||!window.AbortController)};Aj.isSupported=Aj.isSupported;Aj.g=window.fetch;Aj.a=window.AbortController;Aj.c=window.ReadableStream;Aj.b=window.Headers;Aj.isSupported()&&(Vb("http",Aj,2),Vb("https",Aj,2));function Bj(b,c,d,e){var f=new Bj.f,g=Date.now(),h=0,k=new Promise(function(k,n){f.open(c.method,b,!0);f.responseType="arraybuffer";f.timeout=c.retryParameters.timeout;f.withCredentials=c.allowCrossSiteCredentials;f.onabort=function(){n(new E(1,1,7001,b,d))};f.onload=function(c){c=c.target;var e=c.getAllResponseHeaders().trim().split("\r\n"),f={};e=t(e);for(var g=e.next();!g.done;g=e.next())g=g.value.split(": "),f[g[0].toLowerCase()]=g.slice(1).join(": ");try{var h=zj(f,c.response,c.status,b,c.responseURL,
d);k(h)}catch(F){n(F)}};f.onerror=function(c){n(new E(1,1,1002,b,c,d))};f.ontimeout=function(){n(new E(1,1,1003,b,d))};f.onprogress=function(b){var c=Date.now();if(100<c-g||b.lengthComputable&&b.loaded==b.total)e(c-g,b.loaded-h,b.total-b.loaded),h=b.loaded,g=c};for(var m in c.headers)f.setRequestHeader(m.toLowerCase(),c.headers[m]);f.send(c.body)});return new I(k,function(){f.abort();return Promise.resolve()})}A("shaka.net.HttpXHRPlugin",Bj);Bj.f=window.XMLHttpRequest;Vb("http",Bj,1);
Vb("https",Bj,1);function Cj(){this.a=this.f=this.b=0;this.c=new Map;this.g=0}function Dj(b,c){b.b+=c;var d=b.g;b.g++;b.c.set(d,c);return d}Cj.prototype.close=function(b,c){if(this.c.has(b)){var d=this.c.get(b);this.c["delete"](b);this.f+=d;this.a+=c}};function Ej(b,c,d){this.h=b;this.b=new Map;this.c=!1;this.g=c;this.f=d;this.a=new Cj}Ej.prototype.destroy=function(){this.c=!0;return Promise.all(this.b.values()).then(function(){},function(){})};
function Fj(b,c,d,e,f,g){var h=Dj(b.a,e);e=b.b.get(c)||Promise.resolve();b.b.set(c,e.then(function(){return u(function m(){var c,e,q,r,y,C;return x(m,function(m){switch(m.j){case 1:return v(m,Gj(b,d),2);case 2:c=m.s;if(b.c)throw new E(2,9,7001);if(f){e=new Uint8Array(c);q=new Bf(e);for(var n in q.data)r=Number(n),y=q.data[r],C=q.a[r],b.f(y,C)}b.a.close(h,c.byteLength);n=b.a;b.g(0==n.b?0:n.f/n.b,b.a.a);return m["return"](g(c))}})})}))}
function Hj(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:return v(d,Promise.all(b.b.values()),2);case 2:return d["return"](b.a.a)}})})}function Gj(b,c){return u(function e(){var f,g;return x(e,function(e){switch(e.j){case 1:return f=b.h.request(1,c),v(e,f.promise,2);case 2:return g=e.s,e["return"](g.data)}})})};function Ij(b,c){var d=this;this.c=b;this.b=b.objectStore(c);this.a=new G;b.onabort=function(b){b.preventDefault();d.a.reject()};b.onerror=function(b){b.preventDefault();d.a.reject()};b.oncomplete=function(){d.a.resolve()}}Ij.prototype.abort=function(){try{this.c.abort()}catch(b){}return this.a["catch"](function(){})};
function Jj(b,c){return new Promise(function(d,e){var f=b.b.openCursor();f.onerror=e;f.onsuccess=function(b){b=b.target.result;if(!b)return d();c(b.key,b.value,b);b["continue"]()}})}Ij.prototype.store=function(){return this.b};Ij.prototype.promise=function(){return this.a};function Kj(b){this.b=b;this.a=[]}Kj.prototype.destroy=function(){return Promise.all(this.a.map(function(b){return b.abort()}))};function Lj(b,c){return Mj(b,c,"readwrite")}function Mj(b,c,d){d=b.b.transaction([c],d);var e=new Ij(d,c);b.a.push(e);e.promise().then(function(){Pb(b.a,e)},function(){Pb(b.a,e)});return e};function Nj(b,c,d){this.b=new Kj(b);this.c=c;this.a=d}l=Nj.prototype;l.destroy=function(){return this.b.destroy()};l.hasFixedKeySpace=function(){return!0};l.addSegments=function(){return Oj(this.c)};l.removeSegments=function(b,c){return Pj(this,this.c,b,c)};l.getSegments=function(b){var c=this;return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return v(e,Qj(c,c.c,b),2);case 2:return f=e.s,e["return"](f.map(function(b){return c.Wd(b)}))}})})};l.addManifests=function(){return Oj(this.a)};
l.updateManifestExpiration=function(b,c){var d=Lj(this.b,this.a),e=d.store();e.get(b).onsuccess=function(d){if(d=d.target.result)d.expiration=c,e.put(d,b)};return d.promise()};l.removeManifests=function(b,c){return Pj(this,this.a,b,c)};l.getManifests=function(b){var c=this;return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return v(e,Qj(c,c.a,b),2);case 2:return f=e.s,e["return"](f.map(function(b){return c.mc(b)}))}})})};
l.getAllManifests=function(){var b=this;return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return e=Mj(b.b,b.a,"readonly"),f=new Map,v(d,Jj(e,function(d,e){f.set(d,b.mc(e))}),2);case 2:return v(d,e.promise(),3);case 3:return d["return"](f)}})})};l.Wd=function(b){return b};l.mc=function(b){return b};function Oj(b){return Promise.reject(new E(2,9,9011,"Cannot add new value to "+b))}
l.add=function(b,c){var d=this;return u(function f(){var g,h,k,m,n;return x(f,function(f){switch(f.j){case 1:g=Lj(d.b,b);h=g.store();k=[];for(var p=t(c),r=p.next();!r.done;r=p.next())m=r.value,n=h.add(m),n.onsuccess=function(b){k.push(b.target.result)};return v(f,g.promise(),2);case 2:return f["return"](k)}})})};
function Pj(b,c,d,e){b=Lj(b.b,c);c=b.store();var f={};d=t(d);for(var g=d.next();!g.done;f={key:f.key},g=d.next())f.key=g.value,c["delete"](f.key).onsuccess=function(b){return function(){return e(b.key)}}(f);return b.promise()}
function Qj(b,c,d){return u(function f(){var g,h,k,m,n,p,q;return x(f,function(f){switch(f.j){case 1:g=Mj(b.b,c,"readonly");h=g.store();k={};m=[];n={};p=t(d);for(q=p.next();!q.done;n={request:n.request,key:n.key},q=p.next())n.key=q.value,n.request=h.get(n.key),n.request.onsuccess=function(b){return function(){void 0==b.request.result&&m.push(b.key);k[b.key]=b.request.result}}(n);return v(f,g.promise(),2);case 2:if(m.length)throw new E(2,9,9012,"Could not find values for "+m);return f["return"](d.map(function(b){return k[b]}))}})})}
;function Rj(b){this.a=new Kj(b)}Rj.prototype.destroy=function(){return this.a.destroy()};Rj.prototype.getAll=function(){var b=this;return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return e=Mj(b.a,"session-ids","readonly"),f=[],v(d,Jj(e,function(b,d){f.push(d)}),2);case 2:return v(d,e.promise(),3);case 3:return d["return"](f)}})})};Rj.prototype.add=function(b){var c=Lj(this.a,"session-ids"),d=c.store();b=t(b);for(var e=b.next();!e.done;e=b.next())d.add(e.value);return c.promise()};
Rj.prototype.remove=function(b){var c=this;return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return f=Lj(c.a,"session-ids"),v(e,Jj(f,function(c,e,f){0<=b.indexOf(e.sessionId)&&f["delete"]()}),2);case 2:return v(e,f.promise(),0)}})})};function Sj(){this.a=new Map}Sj.prototype.destroy=function(){for(var b=[],c=t(this.a.values()),d=c.next();!d.done;d=c.next())b.push(d.value.destroy());this.a.clear();return Promise.all(b)};Sj.prototype.init=function(){var b=this;Tj.forEach(function(c,d){var e=c();e?b.a.set(d,e):B.info("Skipping "+d+" as it is not supported on this platform")});for(var c=[],d=t(this.a.values()),e=d.next();!e.done;e=d.next())c.push(e.value.init());return Promise.all(c)};
function Uj(b){var c=null;b.a.forEach(function(b,e){b.getCells().forEach(function(b,d){b.hasFixedKeySpace()||c||(c={path:{Aa:e,fa:d},fa:b})})});if(c)return c;throw new E(2,9,9013,"Could not find a cell that supports add-operations");}function Vj(b,c){b.a.forEach(function(b,e){b.getCells().forEach(function(b,d){c({Aa:e,fa:d},b)})})}
function Wj(b,c,d){b=b.a.get(c);if(!b)throw new E(2,9,9013,"Could not find mechanism with name "+c);c=b.getCells().get(d);if(!c)throw new E(2,9,9013,"Could not find cell with name "+d);return c}function Xj(b,c){b.a.forEach(function(b){c(b.getEmeSessionCell())})}function Yj(b){var c=Array.from(b.a.keys());if(!c.length)throw new E(2,9,9E3,"No supported storage mechanisms found");return b.a.get(c[0]).getEmeSessionCell()}
Sj.prototype.erase=function(){var b=this;return u(function d(){var e,f,g;return x(d,function(d){switch(d.j){case 1:return e=Array.from(b.a.values()),f=0<e.length,f||(g=Tj,g.forEach(function(b){(b=b())&&e.push(b)})),v(d,Promise.all(e.map(function(b){return b.erase()})),2);case 2:if(f)d.C(0);else return v(d,Promise.all(e.map(function(b){return b.destroy()})),0)}})})};function Zj(b,c){Tj.set(b,c)}A("shaka.offline.StorageMuxer.register",Zj);A("shaka.offline.StorageMuxer.unregister",function(b){Tj["delete"](b)});
var Tj=new Map;function ak(b){Nj.apply(this,arguments)}wa(ak,Nj);ak.prototype.updateManifestExpiration=function(b,c){var d=Lj(this.b,this.a),e=d.store(),f=new G;e.get(b).onsuccess=function(d){(d=d.target.result)?(d.expiration=c,e.put(d),f.resolve()):f.reject(new E(2,9,9012,"Could not find values for "+b))};return d.promise().then(function(){return f})};
ak.prototype.mc=function(b){return{originalManifestUri:b.originalManifestUri,duration:b.duration,size:b.size,expiration:null==b.expiration?Infinity:b.expiration,periods:b.periods.map(bk),sessionIds:b.sessionIds,drmInfo:b.drmInfo,appMetadata:b.appMetadata}};function bk(b){ck(b);b.streams.forEach(function(){});return{startTime:b.startTime,streams:b.streams.map(dk)}}
function dk(b){var c=b.initSegmentUri?ek(b.initSegmentUri):null;return{id:b.id,originalId:null,primary:b.primary,presentationTimeOffset:b.presentationTimeOffset,contentType:b.contentType,mimeType:b.mimeType,codecs:b.codecs,frameRate:b.frameRate,pixelAspectRatio:void 0,kind:b.kind,language:b.language,label:b.label,width:b.width,height:b.height,initSegmentKey:c,encrypted:b.encrypted,keyId:b.keyId,segments:b.segments.map(fk),variantIds:b.variantIds}}
function fk(b){var c=ek(b.uri);return{startTime:b.startTime,endTime:b.endTime,dataKey:c}}ak.prototype.Wd=function(b){return{data:b.data}};function ek(b){var c;if((c=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(b))||(c=/^offline:segment\/([0-9]+)$/.exec(b)))return Number(c[1]);throw new E(2,9,9004,"Could not parse uri "+b);}
function ck(b){var c=b.streams.filter(function(b){return"audio"==b.contentType}),d=b.streams.filter(function(b){return"video"==b.contentType});if(!c.every(function(b){return b.variantIds})||!d.every(function(b){return b.variantIds})){c.forEach(function(b){b.variantIds=[]});d.forEach(function(b){b.variantIds=[]});var e=0;if(d.length&&!c.length){B.debug("Found video-only content. Creating variants for video.");var f=e++;d.forEach(function(b){b.variantIds.push(f)})}if(!d.length&&c.length){B.debug("Found audio-only content. Creating variants for audio.");
var g=e++;c.forEach(function(b){b.variantIds.push(g)})}d.length&&c.length&&(B.debug("Found audio-video content. Creating variants."),c.forEach(function(b){d.forEach(function(c){var d=e++;b.variantIds.push(d);c.variantIds.push(d)})}))}};function gk(b,c,d,e){Nj.call(this,b,c,d);this.f=e}wa(gk,Nj);gk.prototype.hasFixedKeySpace=function(){return this.f};gk.prototype.addSegments=function(b){return this.f?Oj(this.c):this.add(this.c,b)};gk.prototype.addManifests=function(b){return this.f?Oj(this.a):this.add(this.a,b)};gk.prototype.mc=function(b){null==b.expiration&&(b.expiration=Infinity);return b};function hk(){this.g=this.c=this.b=this.a=this.f=null}l=hk.prototype;
l.init=function(){var b=this,c=new G,d=window.indexedDB.open("shaka_offline_db",4);d.onsuccess=function(d){d=d.target.result;b.f=d;var e=d.objectStoreNames;e.contains("manifest")&&e.contains("segment")?(B.debug("Mounting v1 idb storage cell"),e=new ak(d,"segment","manifest")):e=null;b.a=e;e=d.objectStoreNames;e.contains("manifest-v2")&&e.contains("segment-v2")?(B.debug("Mounting v2 idb storage cell"),e=new gk(d,"segment-v2","manifest-v2",!0)):e=null;b.b=e;e=d.objectStoreNames;e.contains("manifest-v3")&&
e.contains("segment-v3")?(B.debug("Mounting v3 idb storage cell"),e=new gk(d,"segment-v3","manifest-v3",!1)):e=null;b.c=e;d.objectStoreNames.contains("session-ids")?(B.debug("Mounting session ID idb storage cell"),d=new Rj(d)):d=null;b.g=d;c.resolve()};d.onupgradeneeded=function(b){b=b.target.result;for(var c=t(["segment-v3","manifest-v3","session-ids"]),d=c.next();!d.done;d=c.next())d=d.value,b.objectStoreNames.contains(d)||b.createObjectStore(d,{autoIncrement:!0})};d.onerror=function(b){c.reject(new E(2,
9,9001,d.error));b.preventDefault()};return c};l.destroy=function(){var b=this;return u(function d(){return x(d,function(d){switch(d.j){case 1:if(!b.a){d.C(2);break}return v(d,b.a.destroy(),2);case 2:if(!b.b){d.C(4);break}return v(d,b.b.destroy(),4);case 4:if(!b.c){d.C(6);break}return v(d,b.c.destroy(),6);case 6:if(!b.g){d.C(8);break}return v(d,b.g.destroy(),8);case 8:b.f&&b.f.close(),w(d)}})})};
l.getCells=function(){var b=new Map;this.a&&b.set("v1",this.a);this.b&&b.set("v2",this.b);this.c&&b.set("v3",this.c);return b};l.getEmeSessionCell=function(){return this.g};
l.erase=function(){var b=this;return u(function d(){return x(d,function(d){switch(d.j){case 1:if(!b.a){d.C(2);break}return v(d,b.a.destroy(),2);case 2:if(!b.b){d.C(4);break}return v(d,b.b.destroy(),4);case 4:if(!b.c){d.C(6);break}return v(d,b.c.destroy(),6);case 6:return b.f&&b.f.close(),v(d,ik(),8);case 8:return b.f=null,b.a=null,b.b=null,b.c=null,v(d,b.init(),0)}})})};
function ik(){var b=new G,c=window.indexedDB.deleteDatabase("shaka_offline_db");c.onblocked=function(){B.m("Deleting","shaka_offline_db","is being blocked")};c.onsuccess=function(){b.resolve()};c.onerror=function(d){b.reject(new E(2,9,9001,c.error));d.preventDefault()};return b}Zj("idb",function(){return yc("CrKey")||!window.indexedDB?null:new hk});function jk(b,c,d,e){this.a=b;this.g=c;this.f=d;this.c=e;this.b=["offline:",b,"/",c,"/",d,"/",e].join("")}jk.prototype.Aa=function(){return this.g};jk.prototype.fa=function(){return this.f};jk.prototype.key=function(){return this.c};jk.prototype.toString=function(){return this.b};
function kk(b){b=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(b);if(null==b)return null;var c=b[1];if("manifest"!=c&&"segment"!=c)return null;var d=b[2];if(!d)return null;var e=b[3];return e&&null!=c?new jk(c,d,e,Number(b[4])):null};function lk(b,c){this.b=b;this.a=c}function mk(b,c){var d=new X(null,0);d.Ba(c.duration);var e=c.periods.map(function(c){return nk(b,c,d)}),f=c.drmInfo?[c.drmInfo]:[];c.drmInfo&&e.forEach(function(b){b.variants.forEach(function(b){b.drmInfos=f})});return{presentationTimeline:d,minBufferTime:2,offlineSessionIds:c.sessionIds,periods:e}}
function nk(b,c,d){var e=c.streams.filter(function(b){return"audio"==b.contentType}),f=c.streams.filter(function(b){return"video"==b.contentType});e=ok(b,e,f);f=c.streams.filter(function(b){return"text"==b.contentType}).map(function(c){return pk(b,c)});c.streams.forEach(function(e){e=e.segments.map(function(c,d){return qk(b,d,c)});d.Eb(e,c.startTime)});return{startTime:c.startTime,variants:Array.from(e.values()),textStreams:f}}
function ok(b,c,d){for(var e=new Set,f=t(c),g=f.next();!g.done;g=f.next()){var h=t(g.value.variantIds);for(g=h.next();!g.done;g=h.next())e.add(g.value)}f=t(d);for(g=f.next();!g.done;g=f.next())for(h=t(g.value.variantIds),g=h.next();!g.done;g=h.next())e.add(g.value);f=new Map;e=t(e);for(g=e.next();!g.done;g=e.next())g=g.value,f.set(g,{id:g,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});c=t(c);for(e=c.next();!e.done;e=c.next())for(e=
e.value,g=pk(b,e),h=t(e.variantIds),e=h.next();!e.done;e=h.next())e=f.get(e.value),e.language=g.language,e.primary=e.primary||g.primary,e.audio=g;d=t(d);for(c=d.next();!c.done;c=d.next())for(e=c.value,c=pk(b,e),g=t(e.variantIds),e=g.next();!e.done;e=g.next())e=f.get(e.value),e.primary=e.primary||c.primary,e.video=c;return f}
function pk(b,c){var d=c.segments.map(function(c,d){return qk(b,d,c)}),e=new Vf(d);d={id:c.id,originalId:c.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(b){return e.find(b)},getSegmentReference:function(b){return e.get(b)},initSegmentReference:null,presentationTimeOffset:c.presentationTimeOffset,mimeType:c.mimeType,codecs:c.codecs,width:c.width||void 0,height:c.height||void 0,frameRate:c.frameRate||void 0,pixelAspectRatio:c.pixelAspectRatio||void 0,
kind:c.kind,encrypted:c.encrypted,keyId:c.keyId,language:c.language,label:c.label||null,type:c.contentType,primary:c.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null};null!=c.initSegmentKey&&(d.initSegmentReference=rk(b,c.initSegmentKey));return d}function qk(b,c,d){var e=new jk("segment",b.b,b.a,d.dataKey);return new V(c,d.startTime,d.endTime,function(){return[e.toString()]},0,null)}
function rk(b,c){var d=new jk("segment",b.b,b.a,c);return new Sf(function(){return[d.toString()]},0,null)};function sk(){this.a=null}l=sk.prototype;l.configure=function(){};
l.start=function(b){var c=this;return u(function e(){var f,g,h,k,m,n;return x(e,function(e){switch(e.j){case 1:f=kk(b);c.a=f;if(null==f||"manifest"!=f.a)return e["return"](Promise.reject(new E(2,1,9004,f)));g=new Sj;Ca(e,2);return v(e,g.init(),4);case 4:return v(e,Wj(g,f.Aa(),f.fa()),5);case 5:return h=e.s,v(e,h.getManifests([f.key()]),6);case 6:return k=e.s,m=k[0],n=new lk(f.Aa(),f.fa()),e["return"](mk(n,m));case 2:return Ga(e),v(e,g.destroy(),7);case 7:Ha(e,0)}})})};l.stop=function(){return Promise.resolve()};
l.update=function(){};
l.onExpirationUpdated=function(b,c){var d=this;return u(function f(){var g,h,k,m,n,p,q,r;return x(f,function(f){switch(f.j){case 1:return g=d.a,h=new Sj,Aa(f,2,3),v(f,h.init(),5);case 5:return v(f,Wj(h,g.Aa(),g.fa()),6);case 6:return k=f.s,v(f,k.getManifests([g.key()]),7);case 7:m=f.s;n=m[0];p=n.sessionIds.includes(b);q=void 0==n.expiration||n.expiration>c;if(!p||!q){f.C(3);break}B.debug("Updating expiration for stored content");return v(f,k.updateManifestExpiration(g.key(),c),3);case 3:return Ga(f),
v(f,h.destroy(),10);case 10:Ha(f,0);break;case 2:r=Fa(f),B.error("There was an error updating",g,r),f.C(3)}})})};W.Lb("application/x-offline-manifest",sk);function tk(b){var c=kk(b);return c&&"manifest"==c.a?tk.h(b):c&&"segment"==c.a?tk.i(c.key(),c):Fb(new E(2,1,9004,b))}A("shaka.offline.OfflineScheme",tk);tk.h=function(b){b={uri:b,vd:b,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}};return Hb(b)};tk.i=function(b,c){var d=new Sj;return Hb(void 0).Y(function(){return d.init()}).Y(function(){return Wj(d,c.Aa(),c.fa())}).Y(function(b){return b.getSegments([c.key()])}).Y(function(b){return{uri:c,vd:c,data:b[0].data,headers:{}}})["finally"](function(){return d.destroy()})};
Vb("offline",tk);function uk(b,c,d){return u(function f(){var g,h,k,m,n,p;return x(f,function(f){switch(f.j){case 1:g=[];for(var q=[],y=t(d),C=y.next();!C.done;C=y.next()){C=C.value;for(var z=!1,F=t(q),H=F.next();!H.done;H=F.next())if(H=H.value,vk(H.info,C)){H.sessionIds.push(C.sessionId);z=!0;break}z||q.push({info:C,sessionIds:[C.sessionId]})}h=t(q);k=h.next();case 2:if(k.done){f.C(4);break}m=k.value;n=wk(b,c,m);return v(f,n,5);case 5:p=f.s;g=g.concat(p);k=h.next();f.C(2);break;case 4:return f["return"](g)}})})}
function wk(b,c,d){return u(function f(){var g,h,k,m;return x(f,function(f){switch(f.j){case 1:return g=new Hc({Db:c,onError:function(){},yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),Aa(f,2),g.configure(b),v(f,Pc(g,d.info.keySystem,d.info.licenseUri,d.info.serverCertificate,d.info.audioCapabilities,d.info.videoCapabilities),4);case 4:Ea(f,3);break;case 2:return h=Fa(f),B.m("Error initializing EME",h),v(f,g.destroy(),5);case 5:return f["return"]([]);case 3:return Aa(f,6),
v(f,Wc(g),8);case 8:Ea(f,7);break;case 6:return k=Fa(f),B.m("Error setting server certificate",k),v(f,g.destroy(),9);case 9:return f["return"]([]);case 7:return m=[],v(f,Promise.all(d.sessionIds.map(function(b){return u(function r(){var c;return x(r,function(d){switch(d.j){case 1:return Aa(d,2),v(d,Zc(g,b),4);case 4:m.push(b);Ea(d,0);break;case 2:c=Fa(d),B.m("Error deleting offline session",c),w(d)}})})})),10);case 10:return v(f,g.destroy(),11);case 11:return f["return"](m)}})})}
function vk(b,c){function d(b,c){return b.robustness==c.robustness&&b.contentType==c.contentType}return b.keySystem==c.keySystem&&b.licenseUri==c.licenseUri&&Rb(b.audioCapabilities,c.audioCapabilities,d)&&Rb(b.videoCapabilities,c.videoCapabilities,d)};function xk(b,c){var d=yk(),e=this;this.h=c;this.c=b;this.f=d;this.i=null;this.g=[];this.b=this.a=null;this.l=!0;this.o=Promise.resolve().then(function(){return zk(e)})}xk.prototype.destroy=function(){var b=this;return u(function d(){var e;return x(d,function(d){switch(d.j){case 1:return b.l=!1,b.b&&b.b.abort(),Ak(b),v(d,b.o,2);case 2:b.a&&b.a.za.eb();for(var f=t(b.g),h=f.next();!h.done;h=f.next())e=h.value,e.za.eb();b.a=null;b.g=[];b.h=null;w(d)}})})};
function Bk(b,c){var d={Fb:function(){},xc:function(){},eb:function(){},onError:function(){},zc:function(){},Sg:function(){}};b.g.push({create:c,za:d});b.b&&b.b.abort();Ak(b);return d}
function zk(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:if(b.l){if(0==b.g.length||b.a&&!b.a.$a)var e=!1;else{b.a&&(b.a.za.eb(),b.a=null);e=b.g.shift();var g=e.create(b.f);g?(e.za.Fb(),b.a={node:g.node,payload:g.payload,$a:g.$a,za:e.za}):e.za.zc();e=!0}e?e=Promise.resolve():b.a?e=Ck(b):(b.h.Of(b.c),b.i=new G,e=b.i);return v(d,e,1)}d.C(0)}})})}
function Ck(b){return u(function d(){var e,f;return x(d,function(d){switch(d.j){case 1:return b.c=b.h.sf(b.c,b.f,b.a.node,b.a.payload),Aa(d,2),b.b=b.h.Ze(b.c,b.f,b.a.payload),v(d,b.b.promise,4);case 4:b.b=null;b.c==b.a.node&&(b.a.za.xc(),b.a=null);Ea(d,0);break;case 2:e=Fa(d);if(7001==e.code)b.a.za.eb();else b.a.za.onError(e);b.a=null;b.b=null;f=b;return v(d,b.h.handleError(b.f,e),5);case 5:f.c=d.s,w(d)}})})}function Ak(b){b.i&&(b.i.resolve(),b.i=null)};function Dk(b){this.a=null;for(var c=0;c<b.textTracks.length;++c){var d=b.textTracks[c];d.mode="disabled";"Shaka Player TextTrack"==d.label&&(this.a=d)}this.a||(this.a=b.addTextTrack("subtitles","Shaka Player TextTrack"));this.a.mode="hidden"}A("shaka.text.SimpleTextDisplayer",Dk);Dk.prototype.remove=function(b,c){if(!this.a)return!1;Ek(this.a,function(d){return d.startTime<c&&d.endTime>b});return!0};Dk.prototype.remove=Dk.prototype.remove;
Dk.prototype.append=function(b){var c=Fk,d=b.map(function(b){if(b.nestedCues.length){var c=b.nestedCues.map(function(b){return b.spacer?"\n":b.payload+" "}).join("").replace(/ $/m,"");b=b.clone();b.nestedCues=[];b.payload=c}return b}),e=[];b=this.a.cues?Array.from(this.a.cues):[];var f={};d=t(d);for(var g=d.next();!g.done;f={Ab:f.Ab},g=d.next())f.Ab=g.value,b.some(function(b){return function(c){return c.startTime==b.Ab.startTime&&c.endTime==b.Ab.endTime&&c.text==b.Ab.payload?!0:!1}}(f))||(g=c(f.Ab))&&
e.push(g);e.slice().sort(function(b,c){return b.startTime!=c.startTime?b.startTime-c.startTime:b.endTime!=c.endTime?b.endTime-c.startTime:"line"in VTTCue.prototype?e.indexOf(c)-e.indexOf(b):e.indexOf(b)-e.indexOf(c)}).forEach(function(b){this.a.addCue(b)}.bind(this))};Dk.prototype.append=Dk.prototype.append;Dk.prototype.destroy=function(){this.a&&Ek(this.a,function(){return!0});this.a=null;return Promise.resolve()};Dk.prototype.destroy=Dk.prototype.destroy;
Dk.prototype.isTextVisible=function(){return"showing"==this.a.mode};Dk.prototype.isTextVisible=Dk.prototype.isTextVisible;Dk.prototype.setTextVisibility=function(b){this.a.mode=b?"showing":"hidden"};Dk.prototype.setTextVisibility=Dk.prototype.setTextVisibility;
function Fk(b){if(b.startTime>=b.endTime)return B.m("Invalid cue times: "+b.startTime+" - "+b.endTime),null;var c=new VTTCue(b.startTime,b.endTime,b.payload);c.lineAlign=b.lineAlign;c.positionAlign=b.positionAlign;b.size&&(c.size=b.size);try{c.align=b.textAlign}catch(d){}"center"==b.textAlign&&"center"!=c.align&&(c.align="middle");"vertical-lr"==b.writingMode?c.vertical="lr":"vertical-rl"==b.writingMode&&(c.vertical="rl");1==b.lineInterpretation&&(c.snapToLines=!1);null!=b.line&&(c.line=b.line);null!=
b.position&&(c.position=b.position);return c}function Ek(b,c){var d=b.mode;b.mode="showing"==d?"showing":"hidden";for(var e=b.cues,f=e.length-1;0<=f;f--){var g=e[f];g&&c(g)&&b.removeCue(g)}b.mode=d};function Gk(b,c,d,e,f){var g=f in e,h=!0,k;for(k in c){var m=f+"."+k,n=g?e[f]:d[k];g||k in d?void 0===c[k]?void 0===n||g?delete b[k]:b[k]=Nb(n):n.constructor==Object&&c[k]&&c[k].constructor==Object?(b[k]||(b[k]=Nb(n)),m=Gk(b[k],c[k],n,e,m),h=h&&m):typeof c[k]!=typeof n||null==c[k]||"function"!=typeof c[k]&&c[k].constructor!=n.constructor?(B.jc("Invalid config, wrong type for "+m),h=!1):("function"==typeof d[k]&&d[k].length!=c[k].length&&B.Z("Unexpected number of arguments for "+m),b[k]=c[k]):(B.jc("Invalid config, unrecognized key "+
m),h=!1)}return h}A("shaka.util.ConfigUtils.mergeConfigObjects",Gk);function Hk(b,c){for(var d={},e=d,f=0,g=0;;){f=b.indexOf(".",f);if(0>f)break;if(0==f||"\\"!=b[f-1])g=b.substring(g,f).replace(/\\\./g,"."),e[g]={},e=e[g],g=f+1;f+=1}e[b.substring(g).replace(/\\\./g,".")]=c;return d}A("shaka.util.ConfigUtils.convertToConfigObject",Hk);function Ik(){}A("shaka.util.PlayerConfiguration",Ik);
function Jk(){var b=5E5,c=Infinity;navigator.connection&&(navigator.connection.downlink&&(b=1E6*navigator.connection.downlink),navigator.connection.saveData&&(c=360));var d={retryParameters:Ab(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:fd,fairPlayTransform:!0,updateExpirationTime:1},e={retryParameters:Ab(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(b){if(b)return null},clockSyncUri:"",ignoreDrmInfo:!1,
xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},f={retryParameters:Ab(),failureCallback:function(b){B.error("Unhandled streaming error",b);return[b]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,
forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};if(yc("Web0S")||yc("Tizen")||yc("CrKey"))f.stallSkip=0;var g={trackSelectionCallback:function(b){return u(function n(){return x(n,function(c){switch(c.j){case 1:return c["return"](b)}})})},progressCallback:function(b,c){return[b,c]},usePersistentLicense:!0},h={drm:d,manifest:e,streaming:f,offline:g,abrFactory:P,abr:{enabled:!0,defaultBandwidthEstimate:b,switchInterval:8,bandwidthUpgradeTarget:.85,
bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:c,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:Infinity,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity},
playRangeStart:0,playRangeEnd:Infinity,textDisplayFactory:function(){return null}};g.trackSelectionCallback=function(b){return u(function n(){return x(n,function(c){switch(c.j){case 1:return c["return"](Kk(b,h.preferredAudioLanguage))}})})};return h}
function Lk(b,c,d){var e={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Gk(b,c,d||Jk(),e,"")}Ik.mergeConfigObjects=Lk;
function Kk(b,c){var d=b.filter(function(b){return"variant"==b.type}),e=[],f=we(c,d.map(function(b){return b.language}));f&&(e=d.filter(function(b){return N(b.language)==f}));0==e.length&&(e=d.filter(function(b){return b.primary}));0==e.length&&(1<(new Set(d.map(function(b){return b.language}))).size&&B.m("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),e=d);var g=e.filter(function(b){return b.height&&480>=b.height});g.length&&
(g.sort(function(b,c){return c.height-b.height}),e=g.filter(function(b){return b.height==g[0].height}));d=[];if(e.length){var h=Math.floor(e.length/2);e.sort(function(b,c){return b.bandwidth-c.bandwidth});d.push(e[h])}e=t(b);for(h=e.next();!h.done;h=e.next())h=h.value,"text"==h.type&&d.push(h);return d};function Mk(){this.a=null;this.b=[]}function Nk(b,c){if(null==b.a)b.a={timestamp:Date.now()/1E3,state:c,duration:0};else{var d=Date.now()/1E3;b.a.duration=d-b.a.timestamp;b.a.state!=c&&(b.b.push(b.a),b.a={timestamp:d,state:c,duration:0})}}function Ok(b,c){var d=0;b.a&&b.a.state==c&&(d+=b.a.duration);for(var e=t(b.b),f=e.next();!f.done;f=e.next())f=f.value,d+=f.state==c?f.duration:0;return d}
function Pk(b){function c(b){return{timestamp:b.timestamp,state:b.state,duration:b.duration}}for(var d=[],e=t(b.b),f=e.next();!f.done;f=e.next())d.push(c(f.value));b.a&&d.push(c(b.a));return d};function Qk(){this.b=this.c=null;this.a=[]};function Rk(){this.f=this.u=this.h=this.b=this.i=this.l=this.o=this.g=this.v=NaN;this.a=new Mk;this.c=new Qk};function Y(b,c){var d=this;Mb.call(this);this.i=Sk;this.a=null;this.ob=!1;this.g=new L;this.Lc=this.l=this.Ob=this.c=this.u=this.f=this.ec=this.F=this.fc=this.H=this.qb=this.o=this.G=this.h=this.T=null;this.ke=1E9;this.hc=new Set;this.sb=!0;this.sa=null;this.je=!1;this.ge=0;this.ra=null;this.ea=new Kh;this.b=Tk(this);this.ic={width:Infinity,height:Infinity};this.v=null;this.Pb=new Th(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount);this.qa=this.b.preferredTextLanguage;
this.nb=this.b.preferredTextRole;this.Mc=[];c&&c(this);this.T=Uk(this);this.g.B(window,"online",function(){d.Cd()});this.K={name:"detach"};this.V={name:"attach"};this.Ma={name:"unload"};this.Zc={name:"manifest-parser"};this.Uc={name:"manifest"};this.pb={name:"media-source"};this.Nc={name:"drm-engine"};this.$={name:"load"};this.dd={name:"src-equals-drm-engine"};this.rb={name:"src-equals"};var e=new Map;e.set(this.V,function(b,c){return Ib(Vk(d,b,c))});e.set(this.K,function(b){b.w&&(d.g.pa(b.w,"error"),
b.w=null);d.a=null;b=Promise.resolve();return Ib(b)});e.set(this.Ma,function(b){return Ib(Wk(d,b))});e.set(this.pb,function(b){b=Xk(d,b);return Ib(b)});e.set(this.Zc,function(b,c){var e=Yk(d,b,c);return Ib(e)});e.set(this.Uc,function(b){return Zk(d,b)});e.set(this.Nc,function(){var b=$k(d);return Ib(b)});e.set(this.$,function(b,c){return Ib(al(d,b,c))});e.set(this.dd,function(b){b=bl(d,b);return Ib(b)});e.set(this.rb,function(b,c){return cl(d,b,c)});this.Ta=new xk(this.K,{sf:function(b,c,e,k){var f=
null;b==d.K&&(f=e==d.K?d.K:d.V);b==d.V&&(f=e==d.K||c.w!=k.w?d.K:e==d.V?d.V:e==d.pb||e==d.$?d.pb:e==d.rb?d.dd:null);b==d.pb&&(f=e==d.$&&c.w==k.w?d.Zc:d.Ma);b==d.Zc&&(f=dl(d.$,d.Uc,d.Ma,e,c,k));b==d.Uc&&(f=dl(d.$,d.Nc,d.Ma,e,c,k));b==d.Nc&&(f=dl(d.$,d.$,d.Ma,e,c,k));b==d.dd&&(f=e==d.rb&&c.w==k.w?d.rb:d.Ma);if(b==d.$||b==d.rb)f=d.Ma;b==d.Ma&&(f=k.w&&c.w==k.w?d.V:d.K);return f},Ze:function(b,c,h){d.dispatchEvent(new J("onstatechange",{state:b.name}));return e.get(b)(c,h)},handleError:function(b,c){return u(function k(){return x(k,
function(e){switch(e.j){case 1:return B.m("The walker saw an error:"),c instanceof E?B.m("Error Code:",c.code):(B.m("Error Message:",c.message),B.m("Error Stack:",c.stack)),v(e,Wk(d,b),2);case 2:return e["return"](b.w?d.V:d.K)}})})},Of:function(b){d.dispatchEvent(new J("onstateidle",{state:b.name}))}});b&&this.Qb(b,!0)}cb(Y,Mb);A("shaka.Player",Y);
Y.prototype.destroy=function(){var b=this;return u(function d(){var e;return x(d,function(d){switch(d.j){case 1:if(b.i==el)return d["return"]();b.i=el;e=Bk(b.Ta,function(){return{node:b.K,payload:yk(),$a:!1}});return v(d,new Promise(function(d){e.Fb=function(){B.info("Preparing to destroy walker...")};e.xc=function(){d();b.dispatchEvent(new J("loaded"))};e.eb=function(){d()};e.onError=function(){d()};e.zc=function(){d()}}),2);case 2:return v(d,b.Ta.destroy(),3);case 3:b.g&&(b.g.release(),b.g=null);
b.Lc=null;b.l=null;b.b=null;if(!b.T){d.C(0);break}return v(d,b.T.destroy(),5);case 5:b.T=null,w(d)}})})};Y.prototype.destroy=Y.prototype.destroy;Y.version="v2.5.17";var fl=["2","5"];Ae=new function(b){this.a=b;this.c=Be;this.b=Ce}(new ye(Number(fl[0]),Number(fl[1])));var gl=["output-restricted","internal-error"],hl={};Y.registerSupportPlugin=function(b,c){hl[b]=c};
Y.isBrowserSupported=function(){if(!(window.Promise&&window.Uint8Array&&Array.prototype.forEach))return!1;var b=zc();return b&&12>b||!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)?!1:tc()?!0:uc("application/x-mpegurl")};
Y.probeSupport=function(){return ld().then(function(b){for(var c=W.eg(),d={},e=t('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),f=
e.next();!f.done;f=e.next()){f=f.value;d[f]=tc()?Yd(f)?!0:MediaSource.isTypeSupported(f)||Cd(f):uc(f);var g=f.split(";")[0];d[g]=d[g]||d[f]}b={manifest:c,media:d,drm:b};for(var h in hl)b[h]=hl[h]();return b})};Y.prototype.Qb=function(b,c){c=void 0===c?!0:c;if(this.i==el)return Promise.reject(il());var d=yk();d.w=b;tc()||(c=!1);var e=c?this.pb:this.V,f=Bk(this.Ta,function(){return{node:e,payload:d,$a:!1}});f.Fb=function(){return B.info("Starting attach...")};return jl(f)};Y.prototype.attach=Y.prototype.Qb;
Y.prototype.detach=function(){var b=this;if(this.i==el)return Promise.reject(il());var c=Bk(this.Ta,function(){return{node:b.K,payload:yk(),$a:!1}});c.Fb=function(){return B.info("Starting detach...")};return jl(c)};Y.prototype.detach=Y.prototype.detach;
Y.prototype.Od=function(b){var c=this;b=void 0===b?!0:b;if(this.i==el)return Promise.reject(il());tc()||(b=!1);var d=yk(),e=Bk(this.Ta,function(e){var f=e.w&&b?c.pb:e.w?c.V:c.K;d.w=e.w;return{node:f,payload:d,$a:!1}});e.Fb=function(){return B.info("Starting unload...")};return jl(e)};Y.prototype.unload=Y.prototype.Od;
Y.prototype.load=function(b,c,d){if(this.i==el)return Promise.reject(il());this.dispatchEvent(new J("loading"));var e=yk();e.uri=b;e.Ld=Date.now()/1E3;d&&"string"!=typeof d&&(ze("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.Ea=function(){return new d});d&&"string"==typeof d&&(e.mimeType=d);void 0!==c&&(e.startTime=c);var f=kl(this,e)?this.rb:this.$,g=Bk(this.Ta,function(b){if(null==b.w)return null;e.w=b.w;return{node:f,payload:e,$a:!0}});g.Fb=
function(){return B.info("Starting load of "+b+"...")};return new Promise(function(b,c){g.zc=function(){return c(new E(2,7,7002))};g.xc=function(){return b()};g.eb=function(){return c(il())};g.onError=function(b){return c(b)}})};Y.prototype.load=Y.prototype.load;
function kl(b,c){if(c.Ea)return!1;if(!tc())return!0;var d=c.mimeType,e=c.uri||"";d||(d={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[W.getExtension(e)]);return d?""==(c.w||vc()).canPlayType(d)?!1:W.isSupported(e,d)?xc()&&b.b.streaming.useNativeHlsOnSafari:!0:!1}
function Vk(b,c,d){null==c.w&&(c.w=d.w,b.g.B(c.w,"error",function(){var c=ll(b);c&&b.Ra(c)}));b.a=c.w;return Promise.resolve()}
function Wk(b,c){return u(function e(){var f;return x(e,function(e){switch(e.j){case 1:return b.i!=el&&(b.i=Sk),f=b.Mc.map(function(b){return b()}),b.Mc=[],v(e,Promise.all(f),2);case 2:b.dispatchEvent(new J("unloading"));c.Ea=null;c.mimeType=null;c.startTime=null;c.uri=null;c.w&&(b.g.pa(c.w,"loadedmetadata"),b.g.pa(c.w,"playing"),b.g.pa(c.w,"pause"),b.g.pa(c.w,"ended"),b.g.pa(c.w,"ratechange"));b.qb&&(b.qb.release(),b.qb=null);b.fc&&(b.fc.stop(),b.fc=null);if(!b.u){e.C(3);break}return v(e,b.u.stop(),
4);case 4:b.u=null;case 3:if(!b.l){e.C(5);break}return v(e,b.l.stop(),5);case 5:if(!b.f){e.C(7);break}return v(e,b.f.destroy(),8);case 8:b.f=null;case 7:b.H&&(b.H.release(),b.H=null);b.o&&(b.o.release(),b.o=null);if(!b.G){e.C(9);break}return v(e,b.G.destroy(),10);case 10:b.G=null;case 9:if(!c.w||!c.w.src){e.C(11);break}return v(e,new Promise(function(b){return(new D(b)).R(.1)}),12);case 12:c.w.removeAttribute("src"),c.w.load();case 11:if(!b.h){e.C(13);break}return v(e,b.h.destroy(),14);case 14:b.h=
null;case 13:b.ea.a.clear(),b.Ob=null,b.F=null,b.hc.clear(),b.c=null,b.v=null,b.Rc=null,b.sb=!0,ml(b),w(e)}})})}function Xk(b,c){return u(function e(){var f,g,h,k;return x(e,function(e){switch(e.j){case 1:return f=window.muxjs?new qd:new rd,g=b.b.textDisplayFactory,h=new g,b.Rc=g,k=new ce(c.w,f,h),v(e,k.u,2);case 2:b.G=k,w(e)}})})}
function Yk(b,c,d){return u(function f(){var g,h,k,m;return x(f,function(f){switch(f.j){case 1:c.Ea=d.Ea;c.mimeType=d.mimeType;c.uri=d.uri;g=c.uri;h=b.T;b.Ob=g;if(c.Ea){b.u=c.Ea();f.C(2);break}k=b;return v(f,W.create(g,h,b.b.manifest.retryParameters,c.mimeType),3);case 3:k.u=f.s;case 2:m=Nb(b.b.manifest),d.w&&"AUDIO"===d.w.nodeName&&(m.disableVideo=!0),b.u.configure(m),w(f)}})})}
function Zk(b,c){var d=c.uri,e=b.T;b.ec=new Ei(function(){return b.Be()});Fi(b.ec,function(c){nl(b,"timelineregionadded",c)});var f={networkingEngine:e,filterNewPeriod:function(c){return b.Vc(c)},filterAllPeriods:function(c){return ol(b,c)},onTimelineRegionAdded:function(c){var d=b.ec;a:{var e=t(d.a);for(var f=e.next();!f.done;f=e.next())if(f=f.value,f.schemeIdUri==c.schemeIdUri&&f.id==c.id&&f.startTime==c.startTime&&f.endTime==c.endTime){e=f;break a}e=null}null==e&&(d.a.add(c),d.b(c))},onEvent:function(c){return b.dispatchEvent(c)},
onError:function(c){return b.Ra(c)}};return new I(Promise.resolve().then(function(){return u(function h(){var c;return x(h,function(e){switch(e.j){case 1:return c=b,v(e,b.u.start(d,f),2);case 2:c.c=e.s;b.dispatchEvent(new J("manifestparsed"));if(0==b.c.periods.length)throw new E(2,4,4014);pl(b.c.periods);w(e)}})})}),function(){B.info("Aborting parser step...");return b.u.stop()})}
function $k(b){return u(function d(){return x(d,function(d){switch(d.j){case 1:return b.h=ql(b,{Db:b.T,onError:function(d){b.Ra(d)},yc:function(d){rl(b,d)},onExpirationUpdated:function(d,e){sl(b,d,e)},onEvent:function(d){b.dispatchEvent(d)}}),b.h.configure(b.b.drm),v(d,Oc(b.h,ii(b.c.periods),b.c.offlineSessionIds),2);case 2:ol(b,b.c.periods),w(d)}})})}
function al(b,c,d){return u(function f(){var g,h,k,m,n,p,q,r,y,C;return x(f,function(f){switch(f.j){case 1:return c.startTime=d.startTime,g=c.w,h=c.uri,b.Ob=h,b.H=new mi({rc:function(){return c.w.playbackRate},Id:function(b){c.w.playbackRate=b},le:function(b){c.w.currentTime+=b}}),b.v=new Rk,k=function(){return tl(b)},m=function(){return ul(b)},b.g.B(g,"playing",k),b.g.B(g,"pause",k),b.g.B(g,"ended",k),b.g.B(g,"ratechange",m),n=b.b.abrFactory,b.l&&b.Lc==n||(b.Lc=n,b.l=new n,b.l.configure(b.b.abr)),
vl(b,b.c.periods),b.Pb=new Th(b.b.preferredAudioLanguage,b.b.preferredVariantRole,b.b.preferredAudioChannelCount),b.qa=b.b.preferredTextLanguage,wl(b.c.presentationTimeline,b.b.playRangeStart,b.b.playRangeEnd),v(f,b.h.Qb(g),2);case 2:return b.l.init(function(c,d,f){d=void 0===d?!1:d;f=void 0===f?0:f;B.debug("switch_");a:{var g=t(b.c.periods);for(var h=g.next();!h.done;h=g.next())if(h=h.value,h.variants.includes(c)){g=h;break a}g=null}xl(b,g,c,!0);b.f&&$i(b.f,c,d,f)&&yl(b)}),b.o=zl(b,c.startTime),
b.qb=Al(b),p=Math.max(b.c.minBufferTime,b.b.streaming.rebufferingGoal),Bl(b,p),b.f=Cl(b),b.f.configure(b.b.streaming),O.Vd(b.c,b.b.preferredAudioChannelCount),b.i=Dl,b.dispatchEvent(new J("streaming")),v(f,b.f.start(),3);case 3:b.b.streaming.startAtSegmentBoundary&&(q=b.o.g(),r=El(b,q),b.o.o(r)),b.c.periods.forEach(b.Vc.bind(b)),Fl(b),yl(b),y=Gl(b)||b.c.periods[0],C=y.variants.some(function(b){return b.primary}),b.b.preferredAudioLanguage||C||B.m("No preferred audio language set.  We will choose an arbitrary language initially"),
Hl(b,y.variants),b.g.ua(g,"loadedmetadata",function(){b.v.b=Date.now()/1E3-d.Ld}),w(f)}})})}
function bl(b,c){return u(function e(){var f,g;return x(e,function(e){switch(e.j){case 1:return f=zd,b.h=ql(b,{Db:b.T,onError:function(c){b.Ra(c)},yc:function(c){rl(b,c)},onExpirationUpdated:function(c,e){sl(b,c,e)},onEvent:function(c){b.dispatchEvent(c)}}),b.h.configure(b.b.drm),g={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,
presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:f.Ua,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},v(e,Oc(b.h,[g],[]),2);case 2:return v(e,b.h.Qb(c.w),0)}})})}
function cl(b,c,d){function e(){return tl(b)}c.uri=d.uri;c.startTime=d.startTime;b.Ob=c.uri;b.v=new Rk;b.o=new xi(c.w);null!=c.startTime&&b.o.o(c.startTime);b.H=new mi({rc:function(){return c.w.playbackRate},Id:function(b){c.w.playbackRate=b},le:function(b){c.w.currentTime+=b}});Bl(b,b.b.streaming.rebufferingGoal);b.g.B(c.w,"playing",e);b.g.B(c.w,"pause",e);b.g.B(c.w,"ended",e);b.g.B(c.w,"ratechange",function(){return ul(b)});"none"!=b.a.preload&&b.g.ua(c.w,"loadedmetadata",function(){b.v.b=Date.now()/
1E3-d.Ld});b.a.audioTracks&&(b.g.B(b.a.audioTracks,"addtrack",function(){return Fl(b)}),b.g.B(b.a.audioTracks,"removetrack",function(){return Fl(b)}),b.g.B(b.a.audioTracks,"change",function(){return Fl(b)}));if(b.a.textTracks){var f=b.a.textTracks;b.g.B(f,"addtrack",function(){return Fl(b)});b.g.B(f,"removetrack",function(){return Fl(b)});b.g.B(f,"change",function(){return Fl(b)})}c.w.src=c.uri;(yc("Tizen")||yc("Web0S"))&&c.w.load();b.i=Il;b.dispatchEvent(new J("streaming"));var g=new G;oi(b.a,HTMLMediaElement.HAVE_METADATA,
b.g,function(){g.resolve()});var h=!1;b.Mc.push(function(){h=!0});oi(b.a,HTMLMediaElement.HAVE_CURRENT_DATA,b.g,function(){return u(function m(){var c;return x(m,function(d){switch(d.j){case 1:if(h)return d["return"]();Jl(b);c=Kl(b);if(c.find(function(b){return"disabled"!=b.mode})){d.C(2);break}return v(d,new Promise(function(c){b.g.ua(b.a.textTracks,"change",c);(new D(c)).R(1)}),2);case 2:if(h)return d["return"]();Ll(b);w(d)}})})});b.a.error?g.reject(ll(b)):"none"==b.a.preload&&(B.Z('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),
g.resolve());b.g.ua(b.a,"error",function(){g.reject(ll(b))});return new I(g,function(){g.reject(new E(2,7,7001));return Promise.resolve()})}function Jl(b){var c=b.b.preferredAudioLanguage;if(""!=c){b.Dd(c);var d=b.b.preferredVariantRole;""!=d&&b.Dd(c,d)}}function Ll(b){var c=b.b.preferredTextLanguage;if(""!=c){b.Ed(c);var d=b.b.preferredTextRole;""!=d&&b.Ed(c,d)}}
function pl(b){function c(b){return b.video&&b.audio||b.video&&b.video.codecs.includes(",")}b.some(function(b){return b.variants.some(c)})&&(B.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),b.forEach(function(b){b.variants=b.variants.filter(c)}))}function ql(b,c){return new Hc(c,b.b.drm.updateExpirationTime)}function Uk(b){return new K(function(c,d){b.l&&b.l.segmentDownloaded(c,d)})}
function zl(b,c){return new yi(b.a,b.c,b.b.streaming,c,function(){b.qb&&hi(b.qb,!0);b.f&&gj(b.f);b.F&&Ml(b)},function(c){return b.dispatchEvent(c)})}function Al(b){var c=new ki(b.c);li(c,function(){Fl(b)});var d=new Gi(b.ec);Ki(d,function(c){nl(b,"timelineregionenter",c)},function(c){nl(b,"timelineregionexit",c)},function(c,d){d||(nl(b,"timelineregionenter",c),nl(b,"timelineregionexit",c))});var e=new gi(b.a);e.a.add(c);e.a.add(d);return e}
function Bl(b,c){b.F=new Xh;b.F.a=Zh;$h(b.F,c,Math.min(.5,c/2));ml(b);b.fc=(new D(function(){Ml(b)})).Ka(.25)}function Ml(b){switch(b.i){case Il:var c=b.a.ended?!0:sd(b.a.buffered)>=b.a.duration-1;break;case Dl:a:if(b.a.ended||ge(b.G))c=!0;else{if(b.c.presentationTimeline.X()){var d=b.c.presentationTimeline.xb();if(sd(b.a.buffered)>=d){c=!0;break a}}c=!1}break;default:c=!1}var e=ud(b.a.buffered,b.a.currentTime);d=b.F;var f=c,g=d.b.get(d.a);c=d.a;e=f||e>=g?Yh:Zh;d.a=e;c!=e&&ml(b)}
function Cl(b){return new Li(b.c,{Za:function(){return b.o.g()},getBandwidthEstimate:function(){return b.l.getBandwidthEstimate()},O:b.G,Db:b.T,oe:b.Mf.bind(b),ne:b.Te.bind(b),onError:b.Ra.bind(b),onEvent:function(c){return b.dispatchEvent(c)},Qf:b.Rf.bind(b),td:b.Wf.bind(b)})}Y.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=Hk(b,c));var d=Lk(this.b,b,Tk(this));Nl(this);return d};Y.prototype.configure=Y.prototype.configure;
function Nl(b){if(b.u){var c=Nb(b.b.manifest);b.a&&"AUDIO"===b.a.nodeName&&(c.disableVideo=!0);b.u.configure(c)}b.h&&b.h.configure(b.b.drm);if(b.f){b.f.configure(b.b.streaming);try{b.c.periods.forEach(b.Vc.bind(b))}catch(g){b.Ra(g)}var d=Qi(b.f),e=Si(b.f);c=Gl(b);d=O.ce(d,e,c.variants);b.l&&d&&d.allowedByApplication&&d.allowedByKeySystem?Hl(b,c.variants):(B.debug("Choosing new streams after changing configuration"),Ol(b,c))}if(b.G&&(c=b.b.textDisplayFactory,b.Rc!=c)){d=new c;e=b.G;var f=e.g;e.g=d;
f&&(d.setTextVisibility(f.isTextVisible()),f.destroy());e.a&&(e.a.c=d);b.Rc=c;b.f&&(c=b.f,(d=c.b.get("text"))&&Zi(c,d.stream,!0,0,!0))}b.l&&(b.l.configure(b.b.abr),b.b.abr.enabled&&!b.sb?b.l.enable():b.l.disable(),Pl(b));b.F&&(c=b.b.streaming.rebufferingGoal,b.c&&(c=Math.max(c,b.c.minBufferTime)),$h(b.F,c,Math.min(.5,c/2)))}Y.prototype.getConfiguration=function(){var b=Tk(this);Lk(b,this.b,Tk(this));return b};Y.prototype.getConfiguration=Y.prototype.getConfiguration;
Y.prototype.mg=function(){for(var b in this.b)delete this.b[b];Lk(this.b,Tk(this),Tk(this));Nl(this)};Y.prototype.resetConfiguration=Y.prototype.mg;Y.prototype.kf=function(){return this.i};Y.prototype.getLoadMode=Y.prototype.kf;Y.prototype.qf=function(){return this.a};Y.prototype.getMediaElement=Y.prototype.qf;Y.prototype.Ub=function(){return this.T};Y.prototype.getNetworkingEngine=Y.prototype.Ub;Y.prototype.pc=function(){return this.Ob};Y.prototype.getAssetUri=Y.prototype.pc;
Y.prototype.nf=function(){ze("getManifestUri",'Please use "getAssetUri" instead.');return this.pc()};Y.prototype.getManifestUri=Y.prototype.nf;Y.prototype.X=function(){return this.c?this.c.presentationTimeline.X():this.a&&this.a.src?Infinity==this.a.duration:!1};Y.prototype.isLive=Y.prototype.X;Y.prototype.bb=function(){return this.c?this.c.presentationTimeline.bb():!1};Y.prototype.isInProgress=Y.prototype.bb;
Y.prototype.Hf=function(){if(this.c){if(!this.c.periods.length)return!1;var b=this.c.periods[0].variants;return b.length?!b[0].video:!1}return this.a&&this.a.src?this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight:!1};Y.prototype.isAudioOnly=Y.prototype.Hf;Y.prototype.Be=function(){if(this.c){var b=this.c.presentationTimeline;return{start:b.wb(),end:b.Ga()}}return this.a&&this.a.src&&(b=this.a.seekable,b.length)?{start:b.start(0),end:b.end(b.length-1)}:{start:0,end:0}};
Y.prototype.seekRange=Y.prototype.Be;Y.prototype.keySystem=function(){return bd(this.drmInfo())};Y.prototype.keySystem=Y.prototype.keySystem;Y.prototype.drmInfo=function(){return this.h?this.h.a:null};Y.prototype.drmInfo=Y.prototype.drmInfo;Y.prototype.Tb=function(){return this.h?this.h.Tb():Infinity};Y.prototype.getExpiration=Y.prototype.Tb;Y.prototype.fd=function(){return this.F?this.F.a==Zh:!1};Y.prototype.isBuffering=Y.prototype.fd;
Y.prototype.uf=function(){if(this.H){var b=this.H;b=b.f?0:b.c}else b=0;return b};Y.prototype.getPlaybackRate=Y.prototype.uf;Y.prototype.Eg=function(b){0==b?B.Z("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.H&&this.H.set(b),this.i==Dl&&Yi(this.f,1<Math.abs(b)))};Y.prototype.trickPlay=Y.prototype.Eg;Y.prototype.Ue=function(){this.i==Il&&this.H.set(1);this.i==Dl&&(this.H.set(1),Yi(this.f,!1))};Y.prototype.cancelTrickPlay=Y.prototype.Ue;
Y.prototype.cd=function(){if(this.c&&this.o){for(var b=Ql(this),c=[],d=t(Rl(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=O.Qd(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(b){return O.de(b)}):[]};Y.prototype.getVariantTracks=Y.prototype.cd;
Y.prototype.zb=function(){if(this.c&&this.o){for(var b=Sl(this),c=[],d=t(Tl(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=O.Fc(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.src&&this.a.textTracks?Kl(this).map(function(b){return O.Ff(b)}):[]};Y.prototype.getTextTracks=Y.prototype.zb;
Y.prototype.Fd=function(b){if(this.c&&this.f){var c=Gl(this),d=c.textStreams.find(function(c){return c.id==b.id});d?(Ul(this,c,d,!1),Vl(this,d),this.qa=d.language):B.error("No stream with id",b.id)}else if(this.a&&this.a.src&&this.a.textTracks){c=Kl(this);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,O.ed(d)==b.id?d.mode=this.ob?"showing":"hidden":d.mode="disabled";Wl(this)}};Y.prototype.selectTextTrack=Y.prototype.Fd;
Y.prototype.og=function(){ze("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var b=this.zb().filter(function(b){return"application/cea-608"==b.mimeType});0<b.length?this.Fd(b[0]):B.m("Unable to find the text track embedded in the video.")};Y.prototype.selectEmbeddedTextTrack=Y.prototype.og;
Y.prototype.Jg=function(){ze("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var b=this.zb().filter(function(b){return b.active})[0];return b?"application/cea-608"==b.mimeType:!1};Y.prototype.usingEmbeddedTextTrack=Y.prototype.Jg;
Y.prototype.pg=function(b,c,d){d=void 0===d?0:d;if(this.c&&this.f){var e=Gl(this);this.b.abr.enabled&&B.Z("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var f=e.variants.find(function(c){return c.id==b.id});f?O.Bb(f)?(xl(this,e,f,!1),Xl(this,f,c,d),this.Pb=new Sh(f),Hl(this,e.variants)):B.error("Unable to switch to restricted track",b.id):B.error("No variant with id",b.id)}else if(this.a&&
this.a.audioTracks){c=Array.from(this.a.audioTracks);c=t(c);for(d=c.next();!d.done;d=c.next())d=d.value,O.ed(d)==b.id&&(d.enabled=!0);Yl(this)}};Y.prototype.selectVariantTrack=Y.prototype.pg;Y.prototype.ef=function(){return Zl(this.cd())};Y.prototype.getAudioLanguagesAndRoles=Y.prototype.ef;Y.prototype.Bf=function(){return Zl(this.zb())};Y.prototype.getTextLanguagesAndRoles=Y.prototype.Bf;Y.prototype.df=function(){return Array.from($l(this.cd()))};Y.prototype.getAudioLanguages=Y.prototype.df;
Y.prototype.Af=function(){return Array.from($l(this.zb()))};Y.prototype.getTextLanguages=Y.prototype.Af;Y.prototype.Dd=function(b,c){if(this.c&&this.o){var d=Gl(this);this.Pb=new Th(b,c||"",0,"","audio");am(this,d)}else if(this.a&&this.a.audioTracks){var e=Array.from(this.a.audioTracks);d=N(b);e=t(e);for(var f=e.next();!f.done;f=e.next()){f=f.value;var g=O.de(f);N(g.language)!=d||c&&!g.roles.includes(c)||(f.enabled=!0)}Yl(this)}};Y.prototype.selectAudioLanguage=Y.prototype.Dd;
Y.prototype.Ed=function(b,c){if(this.c&&this.o){var d=Gl(this);this.qa=b;this.nb=c||"";var e=O.Sb(d.textStreams,this.qa,this.nb)[0]||null;e&&(Ul(this,d,e,!1),(this.b.streaming.alwaysStreamText||this.uc())&&Vl(this,e))}else{var f=N(b);(d=this.zb().filter(function(b){return N(b.language)==f&&(!c||b.roles.includes(c))})[0])&&this.Fd(d)}};Y.prototype.selectTextLanguage=Y.prototype.Ed;
Y.prototype.qg=function(b){if(this.c&&this.o){for(var c=Gl(this),d=null,e=t(Rl(this)),f=e.next();!f.done;f=e.next())if(f=f.value,f.audio.label==b){d=f;break}null==d?B.m("No variants were found with label: "+b+". Ignoring the request to switch."):(this.Pb=new Th(d.language,"",0,b),am(this,c))}};Y.prototype.selectVariantsByLabel=Y.prototype.qg;
Y.prototype.uc=function(){var b=this.ob;return this.G?this.G.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Kl(this).some(function(b){return"showing"==b.mode}):b};Y.prototype.isTextTrackVisible=Y.prototype.uc;function Kl(b){return Array.from(b.a.textTracks).filter(function(b){return"metadata"!=b.kind&&"Shaka Player TextTrack"!=b.label})}
Y.prototype.tg=function(b){var c=this;return u(function e(){var f,g,h,k,m,n;return x(e,function(e){switch(e.j){case 1:f=c.ob;g=!!b;if(f==g)return e["return"]();c.ob=g;if(c.i!=Dl){if(c.a&&c.a.src&&c.a.textTracks){h=Kl(c);for(var p=t(h),r=p.next();!r.done;r=p.next())k=r.value,"disabled"!=k.mode&&(k.mode=g?"showing":"hidden")}e.C(2);break}c.G.g.setTextVisibility(g);if(c.b.streaming.alwaysStreamText){e.C(2);break}if(!g){Xi(c.f);e.C(2);break}if(Ri(c.f,"text")){e.C(2);break}m=Gl(c);n=O.Sb(m.textStreams,
c.qa,c.nb);if(!(0<n.length)){e.C(2);break}return v(e,Ti(c.f,n[0]),2);case 2:bm(c),w(e)}})})};Y.prototype.setTextTrackVisibility=Y.prototype.tg;
Y.prototype.wf=function(){if(!this.X())return B.m("getPlayheadTimeAsDate is for live streams!"),null;var b=this.Ta.f,c=0;if(this.o)c=this.o.g();else if(b){if(null==b.startTime)return new Date;c=b.startTime}if(this.c)return new Date(1E3*(this.c.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate)return b=this.a.getStartDate(),isNaN(b.getTime())?(B.m("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(b.getTime()+1E3*c);B.m("No way to get playhead time as Date!");
return null};Y.prototype.getPlayheadTimeAsDate=Y.prototype.wf;Y.prototype.yf=function(){if(!this.X())return B.m("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1E3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var b=this.a.getStartDate();return isNaN(b.getTime())?(B.m("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):b}B.m("No way to get presentation start time as Date!");return null};
Y.prototype.getPresentationStartTimeAsDate=Y.prototype.yf;Y.prototype.$c=function(){var b={total:[],audio:[],video:[],text:[]};this.i==Il&&(b.total=vd(this.a.buffered));this.i==Dl&&this.G.$c(b);return b};Y.prototype.getBufferedInfo=Y.prototype.$c;
Y.prototype.getStats=function(){if(this.i!=Dl&&this.i!=Il)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};tl(this);var b=this.a;if(b.getVideoPlaybackQuality){b=b.getVideoPlaybackQuality();var c=this.v,d=Number(b.totalVideoFrames);c.o=Number(b.droppedVideoFrames);c.l=d;this.v.i=Number(b.corruptedVideoFrames)}this.h?
(b=this.h,b=b.K?b.K:NaN):b=NaN;this.v.h=b;if(this.i==Dl){if(b=Ql(this))this.v.u=b.bandwidth;b&&b.video&&(c=this.v,d=b.video.height||NaN,c.v=b.video.width||NaN,c.g=d);b=this.l.getBandwidthEstimate();this.v.f=b}var e=this.v;b=e.v;c=e.g;d=e.u;var f=e.l,g=e.o,h=e.i,k=e.f,m=e.b,n=Ok(e.a,"playing"),p=Ok(e.a,"paused"),q=Ok(e.a,"buffering"),r=e.h,y=Pk(e.a),C=[];e=t(e.c.a);for(var z=e.next();!z.done;z=e.next())z=z.value,C.push({timestamp:z.timestamp,id:z.id,type:z.type,fromAdaptation:z.fromAdaptation,bandwidth:z.bandwidth});
return{width:b,height:c,streamBandwidth:d,decodedFrames:f,droppedFrames:g,corruptedFrames:h,estimatedBandwidth:k,loadLatency:m,playTime:n,pauseTime:p,bufferingTime:q,licenseTime:r,stateHistory:y,switchHistory:C}};Y.prototype.getStats=Y.prototype.getStats;
Y.prototype.addTextTrack=function(b,c,d,e,f,g){var h=this;return u(function m(){var n,p,q,r,y,C,z,F,H;return x(m,function(m){switch(m.j){case 1:if(h.i==Il)throw B.error("Cannot add text when loaded with src="),Error("State error!");if(h.i!=Dl)throw B.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");n=Gl(h);p=zd;q=h.c.periods.indexOf(n);r=q+1;y=r>=h.c.periods.length?h.c.presentationTimeline.ca():h.c.periods[r].startTime;C=y-n.startTime;if(Infinity==
C)throw new E(1,4,4033);z=new V(1,0,C,function(){return[b]},0,null);F={id:h.ke++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(b){return 1==b?z:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:e,codecs:f||"",kind:d,encrypted:!1,keyId:null,language:c,label:g||null,type:p.va,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,
audioSamplingRate:null,closedCaptions:null};h.hc.add(F);n.textStreams.push(F);return v(m,Ti(h.f,F),2);case 2:return(H=Ri(h.f,"text"))&&Lh(h.ea,n,H),h.hc["delete"](F),B.debug("Choosing new streams after adding a text stream"),Ol(h,n),Fl(h),m["return"](O.Fc(F))}})})};Y.prototype.addTextTrack=Y.prototype.addTextTrack;Y.prototype.Hd=function(b,c){this.ic.width=b;this.ic.height=c};Y.prototype.setMaxHardwareResolution=Y.prototype.Hd;
Y.prototype.Cd=function(){if(this.i==Dl){var b=this.f;if(b.f)B.error("Unable to retry after StreamingEngine is destroyed!"),b=!1;else if(b.o)B.error("Unable to retry after StreamingEngine encountered a fatal error!"),b=!1;else{for(var c=t(b.b.values()),d=c.next();!d.done;d=c.next()){d=d.value;var e=cj(d);d.Xb&&(B.info(e,"Retrying after failure..."),d.Xb=!1,Wi(b,d,.1))}b=!0}}else b=!1;return b};Y.prototype.retryStreaming=Y.prototype.Cd;Y.prototype.lf=function(){return this.c};
Y.prototype.getManifest=Y.prototype.lf;Y.prototype.mf=function(){return this.u?this.u.constructor:null};Y.prototype.getManifestParserFactory=Y.prototype.mf;function xl(b,c,d,e){Mh(b.ea,c).variant=d;b=b.v.c;b.c!=d&&(b.c=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"variant",fromAdaptation:e,bandwidth:d.bandwidth}))}function Ul(b,c,d,e){Lh(b.ea,c,d);b=b.v.c;b.b!=d&&(b.b=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"text",fromAdaptation:e,bandwidth:null}))}
function Tk(b){var c=Jk();c.streaming.failureCallback=function(c){var d=[1001,1002,1003];b.X()&&d.includes(c.code)&&(c.severity=1,B.m("Live streaming error.  Retrying automatically..."),b.Cd())};c.textDisplayFactory=function(){return new Dk(b.a)};return c}
function vl(b,c){for(var d=0;d<c.length;d++){for(var e=c[d],f=new Map,g=t(e.variants),h=g.next();!h.done;h=g.next())if(h=h.value,h.video&&h.video.closedCaptions){h=h.video;for(var k=t(h.closedCaptions.keys()),m=k.next();!m.done;m=k.next())if(m=m.value,!f.has(m)){var n={id:b.ke++,originalId:m,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",
codecs:"",kind:"caption",encrypted:!1,keyId:null,language:h.closedCaptions.get(m),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:h.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};f.set(m,n)}}f=t(f.values());for(g=f.next();!g.done;g=f.next())e.textStreams.push(g.value)}}
function ol(b,c){var d=b.f?Qi(b.f):null,e=b.f?Si(b.f):null;c.forEach(O.filterNewPeriod.bind(null,b.h,d,e));d=Qb(c,function(b){return b.variants.some(O.Bb)});if(0==d)throw new E(2,4,4032);if(d<c.length)throw new E(2,4,4011);c.forEach(function(b){O.Sd(b.variants,this.b.restrictions,this.ic)&&this.f&&Gl(this)==b&&Fl(this);cm(this,b.variants)}.bind(b))}l=Y.prototype;
l.Vc=function(b){var c=this.f?Qi(this.f):null,d=this.f?Si(this.f):null;O.filterNewPeriod(this.h,c,d,b);c=b.variants;if(!c.some(O.Bb))throw new E(2,4,4011);cm(this,b.variants);O.Sd(c,this.b.restrictions,this.ic)&&this.f&&Gl(this)==b&&Fl(this);if(b=this.h?this.h.a:null)for(c=t(c),d=c.next();!d.done;d=c.next()){d=t(d.value.drmInfos);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.keySystem==b.keySystem){e=t(e.initData||[]);for(var f=e.next();!f.done;f=e.next())f=f.value,Yc(this.h,f.initDataType,
f.initData)}}};function Xl(b,c,d,e){d=void 0===d?!1:d;e=void 0===e?0:e;if(b.sb)return b.sa=c,b.je=d,b.ge=e,!0;(c=$i(b.f,c,d,e))&&Yl(b);return c}function Vl(b,c){if(b.sb)return b.ra=c,!0;var d=Zi(b.f,c,!0,0,!1);d&&Wl(b);return d}
function El(b,c){function d(b,c){if(!b)return null;var d=b.findSegmentPosition(c-g.startTime);return null==d?null:(d=b.getSegmentReference(d))?d.startTime+g.startTime:null}var e=Qi(b.f),f=Si(b.f),g=Gl(b);e=d(e,c);f=d(f,c);return null!=f&&null!=e?Math.max(f,e):null!=f?f:null!=e?e:c}function ml(b){var c=b.fd();if(b.v&&b.F&&b.o){var d=b.H;d.f=c;ni(d);tl(b)}b.dispatchEvent(new J("buffering",{buffering:c}))}function ul(b){var c=b.a.playbackRate;0!=c&&b.H.set(c)}
function tl(b){if(b.v&&b.F){var c=b.v.a;b.F.a==Zh?Nk(c,"buffering"):b.a.paused?Nk(c,"paused"):b.a.ended?Nk(c,"ended"):Nk(c,"playing")}}function Hl(b,c){try{cm(b,c)}catch(e){return b.Ra(e),null}var d=c.filter(function(b){return O.Bb(b)});d=b.Pb.create(d);b.l.setVariants(Array.from(d.values()));return b.l.chooseVariant()}function Ol(b,c){var d=am(b,c,!1),e=O.Sb(c.textStreams,b.qa,b.nb)[0]||null,f=!1;e&&(b.b.streaming.alwaysStreamText||b.uc())&&(Ul(b,c,e,!0),f=Vl(b,e));(d||f)&&yl(b)}
function am(b,c,d){d=void 0===d?!0:d;var e=Hl(b,c.variants),f=!1;e&&(xl(b,c,e,!0),f=Xl(b,e,!0));d&&f&&yl(b);return f}
l.Mf=function(b){B.debug("onChooseStreams_",b);try{B.J("onChooseStreams_, choosing variant from ",b.variants);B.J("onChooseStreams_, choosing text from ",b.textStreams);this.sb=!0;this.l.disable();Pl(this);B.debug("Choosing new streams after period changed");var c=Hl(this,b.variants),d=O.Sb(b.textStreams,this.qa,this.nb)[0]||null;this.sa&&(b.variants.includes(this.sa)&&(c=this.sa),this.sa=null);this.ra&&(b.textStreams.includes(this.ra)&&(d=this.ra),this.ra=null);c&&xl(this,b,c,!0);d&&Ul(this,b,d,
!0);var e=this.f,f=e.b.get("video");if(f)var g=e.c.periods[f.ka];else{var h=e.b.get("audio");g=h?e.c.periods[h.ka]:null}var k=c?c.audio:null;if(!g&&d){var m;if(m=k){b=d;var n=N(this.b.preferredTextLanguage),p=N(k.language),q=N(b.language);m=se(q,n)&&!se(p,q)}m&&(this.ob=!0);this.ob&&this.G.g.setTextVisibility(!0);bm(this)}var r=this.b.streaming.alwaysStreamText||this.uc()?{variant:c,text:d}:{variant:c,text:null};B.J("onChooseStreams_, chose variant ",r.variant);B.J("onChooseStreams_, chose text ",
r.text);return r}catch(y){return this.Ra(y),{variant:null,text:null}}};l.Te=function(){B.debug("canSwitch_");this.sb=!1;this.b.abr.enabled&&(this.l.enable(),Pl(this));this.sa&&($i(this.f,this.sa,this.je,this.ge),Yl(this),this.sa=null);this.ra&&(Zi(this.f,this.ra,!0,0,!1),Wl(this),this.ra=null)};l.Rf=function(){this.u&&this.u.update&&this.u.update()};l.Wf=function(){this.o&&this.o.u()};function yl(b){dm(b,new J("adaptation"))}function Fl(b){dm(b,new J("trackschanged"))}
function Yl(b){dm(b,new J("variantchanged"))}function Wl(b){dm(b,new J("textchanged"))}function bm(b){dm(b,new J("texttrackvisibility"))}function Pl(b){dm(b,new J("abrstatuschanged",{Rg:b.b.abr.enabled}))}l.Ra=function(b){if(this.i!=el){var c=new J("error",{detail:b});this.dispatchEvent(c);c.defaultPrevented&&(b.handled=!0)}};function nl(b,c,d){b.dispatchEvent(new J(c,{detail:{schemeIdUri:d.schemeIdUri,value:d.value,startTime:d.startTime,endTime:d.endTime,id:d.id,eventElement:d.eventElement}}))}
function ll(b){if(!b.a.error)return null;var c=b.a.error.code;if(1==c)return null;var d=b.a.error.msExtendedCode;d&&(0>d&&(d+=Math.pow(2,32)),d=d.toString(16));return new E(2,3,3016,c,d,b.a.error.message)}
function rl(b,c){if(b.f){var d=Gl(b),e=!1,f=Object.keys(c);0==f.length&&B.m("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var g=1==f.length&&"00"==f[0];g&&B.m("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");f.length&&b.c.periods.forEach(function(b){b.variants.forEach(function(b){O.Cf(b).forEach(function(d){var f=
b.allowedByKeySystem;d.keyId&&(d=c[g?"00":d.keyId],b.allowedByKeySystem=!!d&&!gl.includes(d));f!=b.allowedByKeySystem&&(e=!0)})})});f=Qi(b.f);var h=Si(b.f);(f=O.ce(f,h,d.variants))&&!f.allowedByKeySystem&&(B.debug("Choosing new variants after key status changed"),am(b,d));e&&(Fl(b),Hl(b,d.variants))}}function sl(b,c,d){if(b.u&&b.u.onExpirationUpdated)b.u.onExpirationUpdated(c,d);b.dispatchEvent(new J("expirationupdated"))}
function wl(b,c,d){0<c&&(b.X()?B.m("|playRangeStart| has been configured for live content. Ignoring the setting."):b.Ee(c));d<b.ca()&&(b.X()?B.m("|playRangeEnd| has been configured for live content. Ignoring the setting."):b.Ba(d))}
function cm(b,c){var d=b.h?oc(b.h.$):{},e=Object.keys(d);e=e.length&&"00"==e[0];for(var f=!1,g=!1,h=[],k=[],m=t(c),n=m.next();!n.done;n=m.next()){n=n.value;var p=[];n.audio&&p.push(n.audio);n.video&&p.push(n.video);p=t(p);for(var q=p.next();!q.done;q=p.next())if(q=q.value,q.keyId){var r=d[e?"00":q.keyId];r?gl.includes(r)&&(k.includes(r)||k.push(r)):h.includes(q.keyId)||h.push(q.keyId)}n.allowedByApplication?n.allowedByKeySystem&&(f=!0):g=!0}if(!f)throw new E(2,4,4012,{hasAppRestrictions:g,missingKeys:h,
restrictedKeyStatuses:k});}function dm(b,c){u(function e(){return x(e,function(e){switch(e.j){case 1:return v(e,Promise.resolve(),2);case 2:b.i!=el&&b.dispatchEvent(c),w(e)}})})}function $l(b){var c=new Set;b=t(b);for(var d=b.next();!d.done;d=b.next())d=d.value,d.language?c.add(N(d.language)):c.add("und");return c}
function Zl(b){var c=new Map;b=t(b);for(var d=b.next();!d.done;d=b.next()){var e=d.value;d="und";var f=[];e.language&&(d=N(e.language));"variant"==e.type?f=e.audioRoles:f=e.roles;f&&f.length||(f=[""]);c.has(d)||c.set(d,new Set);e=t(f);for(f=e.next();!f.done;f=e.next())f=f.value,c.get(d).add(f)}var g=[];c.forEach(function(b,c){for(var d=t(b),e=d.next();!e.done;e=d.next())g.push({language:c,role:e.value})});return g}
function Rl(b){b=Gl(b);return null==b?[]:b.variants.filter(function(b){return O.Bb(b)})}function Tl(b){var c=Gl(b);return null==c?[]:c.textStreams.filter(function(c){return!b.hc.has(c)})}function Gl(b){var c=b.o.g(),d=null;b=t(b.c.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.startTime<=c&&(d=e);return d}function Ql(b){var c=Gl(b);return Mh(b.ea,c).variant}
function Sl(b){var c=Gl(b);if(null==c)return null;if(!Mh(b.ea,c).text){var d=O.Sb(c.textStreams,b.qa,b.nb);d.length&&Lh(b.ea,c,d[0])}return Mh(b.ea,c).text}function il(){return new E(2,7,7E3)}function dl(b,c,d,e,f,g){return e==b&&f.w==g.w&&f.uri==g.uri&&f.mimeType==g.mimeType&&f.Ea==g.Ea?c:d}function yk(){return{Ea:null,w:null,mimeType:null,startTime:null,Ld:null,uri:null}}
function jl(b){return new Promise(function(c,d){b.eb=function(){return d(il())};b.xc=function(){return c()};b.onError=function(b){return d(b)};b.zc=function(){return d(il())}})}var el=0,Sk=1,Dl=2,Il=3;Y.LoadMode={DESTROYED:el,NOT_LOADED:Sk,MEDIA_SOURCE:Dl,SRC_EQUALS:Il};function em(b,c,d){var e=void 0==c.expiration?Infinity:c.expiration,f=c.presentationTimeline.ca();c=fm(c.periods[0]);return{offlineUri:null,originalManifestUri:b,duration:f,size:0,expiration:e,tracks:c,appMetadata:d}}function gm(b,c){var d=nk(new lk(b.Aa(),b.fa()),c.periods[0],new X(null,0)),e=c.appMetadata||{};d=fm(d);return{offlineUri:b.toString(),originalManifestUri:c.originalManifestUri,duration:c.duration,size:c.size,expiration:c.expiration,tracks:d,appMetadata:e}}
function fm(b){var c=[],d=O.tf(b.variants);d=t(d);for(var e=d.next();!e.done;e=d.next())c.push(O.Qd(e.value));b=t(b.textStreams);for(d=b.next();!d.done;d=b.next())c.push(O.Fc(d.value));return c};function hm(){this.a={}}function im(b,c){var d=c.audio,e=c.video;d&&!e&&(b.a[d.id]=d.bandwidth||c.bandwidth);!d&&e&&(b.a[e.id]=e.bandwidth||c.bandwidth);if(d&&e){var f=d.bandwidth||393216,g=e.bandwidth||c.bandwidth-f;0>=g&&(B.m("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),g=c.bandwidth);b.a[d.id]=f;b.a[e.id]=g}}function jm(b,c,d){d=d.endTime-d.startTime;return km(b,c)*d}
function km(b,c){var d=b.a[c];null==d&&(d=0,B.error("Asking for bitrate of stream not given to the estimator"));0==d&&B.m("Using bitrate of 0, this stream won't affect progress");return d};function lm(b){this.a=!1;this.b=new G;this.c=b}lm.prototype.destroy=function(){var b=this;if(this.a)return this.b;this.a=!0;return this.c().then(function(){b.b.resolve()},function(){b.b.resolve()})};function mm(b,c,d){b=t(b.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.variants=e.variants.filter(function(b){return O.ld(b,c,d)})}function nm(b){b=t(b.periods);for(var c=b.next();!c.done;c=b.next())c=c.value,c.variants=c.variants.filter(function(b){var c=!0;b.audio&&(c=c&&ee(b.audio));b.video&&(c=c&&ee(b.video));return c})}function om(b,c){for(var d=t(b.periods),e=d.next();!e.done;e=d.next())e=e.value,e.variants=e.variants.filter(function(b){return md(c,b)})}
function pm(b){var c=new qm;b.periods.forEach(function(b,d){var e=rm(b.variants);if(0==d){e=t(e.a);for(var f=e.next();!f.done;f=e.next())c.add(f.value)}else sm(c,e)});b=t(b.periods);for(var d=b.next();!d.done;d=b.next())d=d.value,d.variants=d.variants.filter(function(b){return tm(c,new um(b))})}
function vm(b,c){return u(function e(){var f,g,h,k;return x(e,function(e){switch(e.j){case 1:f=null,g=t(b.periods),h=g.next();case 2:if(h.done){e.C(0);break}k=h.value;f&&(k.variants=k.variants.filter(function(b){return tm(f,new um(b))}));return v(e,c(k),5);case 5:f=rm(k.variants),h=g.next(),e.C(2)}})})}function um(b){var c=b.audio;b=b.video;this.b=c?c.mimeType:null;this.a=c?c.codecs.split(".")[0]:null;this.f=b?b.mimeType:null;this.c=b?b.codecs.split(".")[0]:null}function qm(){this.a=[]}
qm.prototype.add=function(b){tm(this,b)||this.a.push(b)};function sm(b,c){b.a=b.a.filter(function(b){return tm(c,b)})}function tm(b,c){return b.a.some(function(b){return c.b==b.b&&c.a==b.a&&c.f==b.f&&c.c==b.c})}function rm(b){var c=new qm;b=t(b);for(var d=b.next();!d.done;d=b.next())c.add(new um(d.value));return c};function Z(b){var c=this;if(b&&b.constructor!=Y)throw new E(2,9,9008);this.b=this.a=null;b?(this.a=b.b,this.b=b.Ub()):(this.a=Jk(),this.b=new K);this.f=!1;this.c=[];this.g=[];var d=!b;this.h=new lm(function(){return u(function f(){var b;return x(f,function(f){switch(f.j){case 1:return b=function(){},v(f,Promise.all(c.g.map(function(c){return c.then(b,b)})),2);case 2:if(!d){f.C(3);break}return v(f,c.b.destroy(),3);case 3:c.a=null,c.b=null,w(f)}})})})}A("shaka.offline.Storage",Z);
function wm(){if(tc())a:{var b=t(Tj.values());for(var c=b.next();!c.done;c=b.next())if(c=c.value,c=c()){c.destroy();b=!0;break a}b=!1}else b=!1;return b}Z.support=wm;Z.prototype.destroy=function(){return this.h.destroy()};Z.prototype.destroy=Z.prototype.destroy;
Z.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=Hk(b,c));var d=b,e=!1;null!=d.trackSelectionCallback&&(e=!0,d.offline=d.offline||{},d.offline.trackSelectionCallback=d.trackSelectionCallback,delete d.trackSelectionCallback);null!=d.progressCallback&&(e=!0,d.offline=d.offline||{},d.offline.progressCallback=d.progressCallback,delete d.progressCallback);null!=d.usePersistentLicense&&(e=!0,d.offline=d.offline||{},d.offline.usePersistentLicense=d.usePersistentLicense,delete d.usePersistentLicense);
e&&ze("Storage.configure with OfflineConfig","Please configure storage with a player configuration.");return Lk(this.a,b)};Z.prototype.configure=Z.prototype.configure;Z.prototype.getConfiguration=function(){var b=Jk();Lk(b,this.a,Jk());return b};Z.prototype.getConfiguration=Z.prototype.getConfiguration;Z.prototype.Ub=function(){return this.b};Z.prototype.getNetworkingEngine=Z.prototype.Ub;
Z.prototype.store=function(b,c,d){var e=this;return xm(this,ym(this,b,c||{},function(){return u(function g(){var c,k;return x(g,function(g){switch(g.j){case 1:return d&&"string"!=typeof d?(ze("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),c=d,g["return"](new c)):v(g,W.create(b,e.b,e.a.manifest.retryParameters,d),2);case 2:return k=g.s,g["return"](k)}})})}))};Z.prototype.store=Z.prototype.store;Z.prototype.zf=function(){return this.f};
Z.prototype.getStoreInProgress=Z.prototype.zf;
function ym(b,c,d,e){return u(function g(){var h,k,m,n,p,q,r,y,C,z;return x(g,function(g){switch(g.j){case 1:zm();if(b.f)return g["return"](Promise.reject(new E(2,9,9006)));b.f=!0;return v(g,Am(b,c,e),2);case 2:h=g.s;Bm(b);k=!h.presentationTimeline.X()&&!h.presentationTimeline.bb();if(!k)throw new E(2,9,9005,c);m=null;n=new Sj;q=p=null;Aa(g,3,4);return v(g,Cm(b,h,function(b){q=q||b}),6);case 6:m=g.s;Bm(b);if(q)throw q;return v(g,Dm(b,h,m),7);case 7:return v(g,n.init(),8);case 8:return Bm(b),v(g,Uj(n),
9);case 9:return p=g.s,Bm(b),v(g,Em(b,p.fa,m,h,c,d),10);case 10:r=g.s;Bm(b);if(q)throw q;return v(g,p.fa.addManifests([r]),11);case 11:return y=g.s,Bm(b),C=new jk("manifest",p.path.Aa,p.path.fa,y[0]),g["return"](gm(C,r));case 4:return Ga(g),b.f=!1,b.c=[],v(g,n.destroy(),12);case 12:if(!m){g.C(13);break}return v(g,m.destroy(),13);case 13:Ha(g,0);break;case 3:z=Fa(g);if(!p){g.C(15);break}return v(g,p.fa.removeSegments(b.c,function(){}),15);case 15:throw q||z;}})})}
function Dm(b,c,d){return u(function f(){var g,h;return x(f,function(f){switch(f.j){case 1:return g={width:Infinity,height:Infinity},mm(c,b.a.restrictions,g),nm(c),om(c,d),pm(c),h=b.a.preferredAudioChannelCount,O.Vd(c,h),v(f,vm(c,function(c){return u(function p(){var d,f,g,h,k,m,H,R;return x(p,function(p){switch(p.j){case 1:d=O;f=[];for(var q=t(c.variants),r=q.next();!r.done;r=q.next())g=r.value,f.push(d.Qd(g));q=t(c.textStreams);for(r=q.next();!r.done;r=q.next())h=r.value,f.push(d.Fc(h));return v(p,
b.a.offline.trackSelectionCallback(f),2);case 2:k=p.s;m=new Set;H=new Set;q=t(k);for(r=q.next();!r.done;r=q.next())R=r.value,"variant"==R.type&&m.add(R.id),"text"==R.type&&H.add(R.id);c.variants=c.variants.filter(function(b){return m.has(b.id)});c.textStreams=c.textStreams.filter(function(b){return H.has(b.id)});w(p)}})})}),2);case 2:Fm(c),w(f)}})})}
function Em(b,c,d,e,f,g){return u(function k(){var m,n,p,q,r,y,C,z,F,H;return x(k,function(k){switch(k.j){case 1:return m=em(f,e,g),n=e.periods.some(function(b){return b.variants.some(function(b){return b.drmInfos&&b.drmInfos.length})}),p=e.periods.some(function(b){return b.variants.some(function(b){return b.drmInfos.some(function(b){return b.initData&&b.initData.length})})}),q=n&&!p,r=null,q&&(y=d.a,r=Gm.get(y.keySystem)),C=new Ej(b.b,function(c,d){m.size=d;b.a.offline.progressCallback(m,c)},function(c,
e){q&&b.a.offline.usePersistentLicense&&r==e&&Yc(d,"cenc",c)}),Ca(k,2),F=z=Hm(b,C,c,d,e,f,g),v(k,Hj(C),4);case 4:F.size=k.s;z.expiration=d.Tb();H=cd(d);z.sessionIds=b.a.offline.usePersistentLicense?H:[];if(n&&b.a.offline.usePersistentLicense&&!H.length)throw new E(2,9,9007);return k["return"](z);case 2:return Ga(k),v(k,C.destroy(),5);case 5:Ha(k,0)}})})}Z.prototype.remove=function(b){return xm(this,Im(this,b))};Z.prototype.remove=Z.prototype.remove;
function Im(b,c){return u(function e(){var f,g,h,k,m,n;return x(e,function(e){switch(e.j){case 1:zm();f=kk(c);if(null==f||"manifest"!=f.a)return e["return"](Promise.reject(new E(2,9,9004,c)));g=f;h=new Sj;Ca(e,2);return v(e,h.init(),4);case 4:return v(e,Wj(h,g.Aa(),g.fa()),5);case 5:return k=e.s,v(e,k.getManifests([g.key()]),6);case 6:return m=e.s,n=m[0],v(e,Promise.all([Jm(b,n,h),Km(b,k,g,n)]),2);case 2:return Ga(e),v(e,h.destroy(),8);case 8:Ha(e,0)}})})}
function Lm(b,c){for(var d=[],e=t(b.periods),f=e.next();!f.done;f=e.next()){f=t(f.value.streams);for(var g=f.next();!g.done;g=f.next())g=g.value,c&&"video"==g.contentType?d.push({contentType:pc(g.mimeType,g.codecs),robustness:b.drmInfo.videoRobustness}):c||"audio"!=g.contentType||d.push({contentType:pc(g.mimeType,g.codecs),robustness:b.drmInfo.audioRobustness})}return d}function Jm(b,c,d){return u(function f(){return x(f,function(f){switch(f.j){case 1:return v(f,Mm(b.b,b.a.drm,d,c),0)}})})}
function Km(b,c,d,e){function f(){k+=1;b.a.offline.progressCallback(m,k/h)}var g=Nm(e),h=g.length+1,k=0,m=gm(d,e);return Promise.all([c.removeSegments(g,f),c.removeManifests([d.key()],f)])}Z.prototype.jg=function(){return xm(this,Om(this))};Z.prototype.removeEmeSessions=Z.prototype.jg;
function Om(b){return u(function d(){var e,f,g,h,k,m,n,p,q;return x(d,function(d){switch(d.j){case 1:return zm(),e=b.b,f=b.a.drm,g=new Sj,h=!1,Ca(d,2),v(d,g.init(),4);case 4:k=[];Xj(g,function(b){return k.push(b)});m=Promise.resolve();n={};p=t(k);for(q=p.next();!q.done;n={Ec:n.Ec},q=p.next())n.Ec=q.value,m=m.then(function(b){return function(){return u(function z(){var d,g;return x(z,function(k){switch(k.j){case 1:return v(k,b.Ec.getAll(),2);case 2:return d=k.s,v(k,uk(f,e,d),3);case 3:return g=k.s,
v(k,b.Ec.remove(g),4);case 4:g.length!=d.length&&(h=!0),w(k)}})})}}(n));return v(d,m,2);case 2:return Ga(d),v(d,g.destroy(),6);case 6:Ha(d,3);break;case 3:return d["return"](!h)}})})}Z.prototype.list=function(){return xm(this,Pm())};Z.prototype.list=Z.prototype.list;
function Pm(){return u(function c(){var d,e,f;return x(c,function(c){switch(c.j){case 1:return zm(),d=[],e=new Sj,Ca(c,2),v(c,e.init(),4);case 4:return f=Promise.resolve(),Vj(e,function(c,e){f=f.then(function(){return u(function n(){var f;return x(n,function(g){switch(g.j){case 1:return v(g,e.getAllManifests(),2);case 2:f=g.s,f.forEach(function(e,f){var g=gm(new jk("manifest",c.Aa,c.fa,f),e);d.push(g)}),w(g)}})})})}),v(c,f,2);case 2:return Ga(c),v(c,e.destroy(),6);case 6:Ha(c,3);break;case 3:return c["return"](d)}})})}
function Am(b,c,d){return u(function f(){var g,h,k,m,n,p;return x(f,function(f){switch(f.j){case 1:return g=null,h=b.b,k={networkingEngine:h,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(b){g=b}},v(f,d(),2);case 2:return m=f.s,m.configure(b.a.manifest),Bm(b),Ca(f,3),v(f,m.start(c,k),5);case 5:return n=f.s,Bm(b),p=Qm(n),v(f,Promise.all(lc(p,function(b){return b.createSegmentIndex()})),6);case 6:Bm(b);if(g)throw g;
return f["return"](n);case 3:return Ga(f),v(f,m.stop(),7);case 7:Ha(f,0)}})})}function Cm(b,c,d){return u(function f(){var g,h,k;return x(f,function(f){switch(f.j){case 1:return g=new Hc({Db:b.b,onError:d,yc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),h=ii(c.periods),k=b.a,g.configure(k.drm),v(f,Mc(g,h,k.offline.usePersistentLicense),2);case 2:return v(f,Wc(g),3);case 3:return v(f,Xc(g),4);case 4:return f["return"](g)}})})}
function Hm(b,c,d,e,f,g,h){var k=new hm,m=f.periods.map(function(e){return Rm(b,c,d,k,f,e)}),n=e.a,p=b.a.offline.usePersistentLicense;n&&p&&(n.initData=[]);return{originalManifestUri:g,duration:f.presentationTimeline.ca(),size:0,expiration:e.Tb(),periods:m,sessionIds:p?cd(e):[],drmInfo:n,appMetadata:h}}
function Rm(b,c,d,e,f,g){for(var h=t(g.variants),k=h.next();!k.done;k=h.next())im(e,k.value);h=t(g.textStreams);for(k=h.next();!k.done;k=h.next())e.a[k.value.id]=52;h=Sm(g);var m=new Map;h=t(h);for(k=h.next();!k.done;k=h.next()){k=k.value;var n=Tm(b,c,d,e,f,k);m.set(k.id,n)}g.variants.forEach(function(b){b.audio&&m.get(b.audio.id).variantIds.push(b.id);b.video&&m.get(b.video.id).variantIds.push(b.id)});return{startTime:g.startTime,streams:Array.from(m.values())}}
function Tm(b,c,d,e,f,g){var h={id:g.id,originalId:g.originalId,primary:g.primary,presentationTimeOffset:g.presentationTimeOffset||0,contentType:g.type,mimeType:g.mimeType,codecs:g.codecs,frameRate:g.frameRate,pixelAspectRatio:g.pixelAspectRatio,kind:g.kind,language:g.language,label:g.label,width:g.width||null,height:g.height||null,initSegmentKey:null,encrypted:g.encrypted,keyId:g.keyId,segments:[],variantIds:[]};f=f.presentationTimeline.Wb();var k=g.id,m=g.initSegmentReference;m&&(m=sg(m.c(),m.b,
m.a,b.a.streaming.retryParameters),Fj(c,k,m,.5*km(e,g.id),!0,function(c){return u(function q(){var e;return x(q,function(f){switch(f.j){case 1:return v(f,d.addSegments([{data:c}]),2);case 2:e=f.s,b.c.push(e[0]),h.initSegmentKey=e[0],w(f)}})})}));Um(g,f,function(f){var m=sg(f.c(),f.b,f.a,b.a.streaming.retryParameters);Fj(c,k,m,jm(e,g.id,f),!1,function(c){return u(function y(){var e;return x(y,function(g){switch(g.j){case 1:return v(g,d.addSegments([{data:c}]),2);case 2:e=g.s,b.c.push(e[0]),h.segments.push({startTime:f.startTime,
endTime:f.endTime,dataKey:e[0]}),w(g)}})})})});return h}function Um(b,c,d){c=b.findSegmentPosition(c);for(var e=null==c?null:b.getSegmentReference(c);e;)d(e),e=b.getSegmentReference(++c)}function Bm(b){if(b.h.a)throw new E(2,9,7001);}function zm(){if(!wm())throw new E(2,9,9E3);}function xm(b,c){return u(function e(){return x(e,function(e){switch(e.j){case 1:return b.g.push(c),Ca(e,2),v(e,c,4);case 4:return e["return"](e.s);case 2:Ga(e),Pb(b.g,c),Ha(e,0)}})})}
function Nm(b){var c=[];b.periods.forEach(function(b){b.streams.forEach(function(b){null!=b.initSegmentKey&&c.push(b.initSegmentKey);b.segments.forEach(function(b){c.push(b.dataKey)})})});return c}Z.deleteAll=function(){return u(function c(){var d;return x(c,function(c){switch(c.j){case 1:return d=new Sj,Ca(c,2),v(c,d.erase(),2);case 2:return Ga(c),v(c,d.destroy(),5);case 5:Ha(c,0)}})})};
function Mm(b,c,d,e){return u(function g(){var h,k,m;return x(g,function(g){switch(g.j){case 1:if(!e.drmInfo)return g["return"]();h=Yj(d);k=e.sessionIds.map(function(b){return{sessionId:b,keySystem:e.drmInfo.keySystem,licenseUri:e.drmInfo.licenseServerUri,serverCertificate:e.drmInfo.serverCertificate,audioCapabilities:Lm(e,!1),videoCapabilities:Lm(e,!0)}});return v(g,uk(c,b,k),2);case 2:return m=g.s,v(g,h.remove(m),3);case 3:return v(g,h.add(k.filter(function(b){return-1==m.indexOf(b.sessionId)})),
0)}})})}function Qm(b){var c=new Set;b=t(b.periods);for(var d=b.next();!d.done;d=b.next()){d=d.value;for(var e=t(d.textStreams),f=e.next();!f.done;f=e.next())c.add(f.value);d=t(d.variants);for(e=d.next();!e.done;e=d.next())e=e.value,e.audio&&c.add(e.audio),e.video&&c.add(e.video)}return c}
function Sm(b){for(var c=new Set,d=t(b.textStreams),e=d.next();!e.done;e=d.next())c.add(e.value);b=t(b.variants);for(d=b.next();!d.done;d=b.next())d=d.value,d.audio&&c.add(d.audio),d.video&&c.add(d.video);return c}function Fm(b){if(0==b.periods.length)throw new E(2,4,4014);b=t(b.periods);for(var c=b.next();!c.done;c=b.next())Vm(c.value)}
function Vm(b){var c=new Set(b.variants.map(function(b){return b.video})),d=new Set(b.variants.map(function(b){return b.audio}));b=b.textStreams;1<c.size&&B.m("Multiple video tracks selected to be stored");c=t(d);for(var e=c.next();!e.done;e=c.next()){e=e.value;for(var f=t(d),g=f.next();!g.done;g=f.next())g=g.value,e!=g&&e.language==g.language&&B.m("Similar audio tracks were selected to be stored",e.id,g.id)}d=t(b);for(c=d.next();!c.done;c=d.next())for(c=c.value,e=t(b),f=e.next();!f.done;f=e.next())f=
f.value,c!=f&&c.language==f.language&&B.m("Similar text tracks were selected to be stored",c.id,f.id)}var Gm=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");hl.offline=wm;A("shaka.polyfill.installAll",function(){for(var b=0;b<Wm.length;++b)try{Wm[b].Re()}catch(c){B.Z("Error installing polyfill!",c)}});var Wm=[];function Xm(b,c){c=c||0;for(var d={priority:c,Re:b},e=0;e<Wm.length;e++)if(Wm[e].priority<c){Wm.splice(e,0,d);return}Wm.push(d)}A("shaka.polyfill.register",Xm);Xm(function(){Ym()},-1);function Zm(b){var c=b.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"===typeof Event)var d=new Event(c,b);else d=document.createEvent("Event"),d.initEvent(c,b.bubbles,b.cancelable);b.target.dispatchEvent(d)}
Xm(function(){if(window.Document){var b=Element.prototype;b.requestFullscreen=b.requestFullscreen||b.mozRequestFullScreen||b.msRequestFullscreen||b.webkitRequestFullscreen;b=Document.prototype;b.exitFullscreen=b.exitFullscreen||b.mozCancelFullScreen||b.msExitFullscreen||b.webkitCancelFullScreen;"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||
document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}}));document.addEventListener("webkitfullscreenchange",Zm);document.addEventListener("webkitfullscreenerror",Zm);document.addEventListener("mozfullscreenchange",Zm);document.addEventListener("mozfullscreenerror",Zm);document.addEventListener("MSFullscreenChange",Zm);document.addEventListener("MSFullscreenError",
Zm)}});function $m(b,c,d){if("input"==b)switch(this.type){case "range":b="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,b,c,d)}Xm(function(){B.debug("InputEvent.install");yc("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(B.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=$m)});Xm(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})});Xm(function(){B.debug("mathRound.install")});function an(){var b=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];d=b.apply(this,d);d.abort=function(){};return d}}function bn(){var b=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(c,d){return b.call(this,c,d-.001)}}function cn(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"mp2t"==c.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:b(c)}}
function dn(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"opus"!=sc(c)[0]&&b(c)}}function en(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){var d=c.split(/ *; */);d.shift();return d.some(function(b){return b.startsWith("codecs=")})?cast.__platform__.canDisplayType(c):b(c)}}
Xm(function(){B.debug("MediaSource.install");var b=zc();window.MediaSource?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(B.info("Patching Chromecast MSE bugs."),en()):b?(cn(),12>=b?(B.info("Patching Safari 11 & 12 MSE bugs."),an(),bn()):(B.info("Patching Safari 13 MSE bugs."),an())):yc("Tizen 2")||yc("Tizen 3")||yc("Tizen 4")?dn():B.info("Using native MSE as-is."):B.info("No MSE implementation available.")});function fn(b,c){B.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var d=new gn(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function gn(b,c){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess");this.keySystem=b;if(b.startsWith("com.apple.fps"))for(var d=t(c),e=d.next();!e.done;e=d.next()){var f=e.value;if("required"==f.persistentState)e=null;else{e={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label};var g=!1,h=!1;if(f.audioCapabilities)for(var k=t(f.audioCapabilities),m=k.next();!m.done;m=k.next())if(m=
m.value,m.contentType){g=!0;var n=m.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,n)&&(e.audioCapabilities.push(m),h=!0)}if(f.videoCapabilities)for(f=t(f.videoCapabilities),m=f.next();!m.done;m=f.next())k=m.value,k.contentType&&(g=!0,m=k.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,m)&&(e.videoCapabilities.push(k),h=!0));g||(h=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));e=h?e:null}if(e){this.a=e;return}}d=Error("Unsupported keySystem");
d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}gn.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var b=new hn(this.keySystem);return Promise.resolve(b)};gn.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration");return this.a};
function jn(b){B.debug("PatchedMediaKeysApple.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&kn(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?kn(b,this):Promise.resolve()}function hn(b){B.debug("PatchedMediaKeysApple.MediaKeys");this.b=new WebKitMediaKeys(b);this.a=new L}
hn.prototype.createSession=function(b){B.debug("PatchedMediaKeysApple.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new ln(this.b,b)};hn.prototype.setServerCertificate=function(b){B.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate");b&&new Uint8Array(b);return Promise.resolve(!0)};
function kn(b,c){b.a.hb();if(!c)return Promise.resolve();b.a.B(c,"webkitneedkey",mn);try{return oi(c,HTMLMediaElement.HAVE_METADATA,b.a,function(){c.webkitSetMediaKeys(b.b)}),Promise.resolve()}catch(d){return Promise.reject(d)}}function ln(b){B.debug("PatchedMediaKeysApple.MediaKeySession");Mb.call(this);this.b=null;this.g=b;this.c=this.a=null;this.f=new L;this.sessionId="";this.expiration=NaN;this.closed=new G;this.keyStatuses=new nn}cb(ln,Mb);l=ln.prototype;
l.generateRequest=function(b,c){B.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest");this.a=new G;try{this.b=this.g.createSession("video/mp4",new Uint8Array(c)),this.sessionId=this.b.sessionId||"",this.f.B(this.b,"webkitkeymessage",this.yg.bind(this)),this.f.B(this.b,"webkitkeyadded",this.wg.bind(this)),this.f.B(this.b,"webkitkeyerror",this.xg.bind(this)),on(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};
l.load=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};l.update=function(b){B.debug("PatchedMediaKeysApple.MediaKeySession.update");this.c=new G;try{this.b.update(new Uint8Array(b))}catch(c){this.c.reject(c)}return this.c};l.close=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.b.close(),this.closed.resolve(),this.f.hb()}catch(b){this.closed.reject(b)}return this.closed};
l.remove=function(){B.debug("PatchedMediaKeysApple.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function mn(b){B.debug("PatchedMediaKeysApple.onWebkitNeedKey_",b);b=new Uint8Array(b.initData);if((new DataView(b.buffer,b.byteOffset,b.byteLength)).getUint32(0,!0)+4!=b.byteLength)throw new RangeError("Malformed FairPlay init data");b=Ec(b.subarray(4),!0);b=Fc(b);var c=new Event("encrypted");c.initDataType="skd";c.initData=b;this.dispatchEvent(c)}
l.yg=function(b){B.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new J("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};l.wg=function(b){B.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",b);this.c&&(on(this,"usable"),this.c.resolve(),this.c=null)};
l.xg=function(b){B.debug("PatchedMediaKeysApple.onWebkitKeyError_",b);b=Error("EME PatchedMediaKeysApple key error");b.errorCode=this.b.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.c)this.c.reject(b),this.c=null;else switch(this.b.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:on(this,"output-not-allowed");break;default:on(this,"internal-error")}};
function on(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new J("keystatuseschange"))}function nn(){this.size=0;this.a=void 0}var pn;l=nn.prototype;l.forEach=function(b){this.a&&b(this.a,pn)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=pn;return this.a&&M.Da(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
Xm(function(){window.HTMLVideoElement&&window.WebKitMediaKeys&&(B.info("Using Apple-prefixed EME"),pn=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=jn,window.MediaKeys=hn,window.MediaKeySystemAccess=gn,navigator.requestMediaKeySystemAccess=fn)});function qn(b,c){B.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var d=new rn(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function rn(b,c){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=b;for(var d=!1,e=0;e<c.length;++e){var f=c[e],g={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label},h=!1;if(f.audioCapabilities)for(var k=0;k<f.audioCapabilities.length;++k){var m=f.audioCapabilities[k];if(m.contentType){h=!0;var n=m.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,
n)&&(g.audioCapabilities.push(m),d=!0)}}if(f.videoCapabilities)for(k=0;k<f.videoCapabilities.length;++k)m=f.videoCapabilities[k],m.contentType&&(h=!0,n=m.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,n)&&(g.videoCapabilities.push(m),d=!0));h||(d=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==f.persistentState&&(d=!1);if(d){this.a=g;return}}d=Error("Unsupported keySystem");d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}
rn.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var b=new sn(this.keySystem);return Promise.resolve(b)};rn.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.a};function tn(b){B.debug("PatchedMediaKeysMs.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&un(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?un(b,this):Promise.resolve()}
function sn(b){B.debug("PatchedMediaKeysMs.MediaKeys");this.b=new MSMediaKeys(b);this.a=new L}sn.prototype.createSession=function(b){B.debug("PatchedMediaKeysMs.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new vn(this.b,b)};sn.prototype.setServerCertificate=function(){B.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
function un(b,c){b.a.hb();if(!c)return Promise.resolve();b.a.B(c,"msneedkey",wn);try{return oi(c,HTMLMediaElement.HAVE_METADATA,b.a,function(){c.msSetMediaKeys(b.b)}),Promise.resolve()}catch(d){return Promise.reject(d)}}function vn(b){B.debug("PatchedMediaKeysMs.MediaKeySession");Mb.call(this);this.c=null;this.g=b;this.b=this.a=null;this.f=new L;this.sessionId="";this.expiration=NaN;this.closed=new G;this.keyStatuses=new xn}cb(vn,Mb);l=vn.prototype;
l.generateRequest=function(b,c){B.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.a=new G;try{this.c=this.g.createSession("video/mp4",new Uint8Array(c),null),this.f.B(this.c,"mskeymessage",this.Vf.bind(this)),this.f.B(this.c,"mskeyadded",this.Tf.bind(this)),this.f.B(this.c,"mskeyerror",this.Uf.bind(this)),yn(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};l.load=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};
l.update=function(b){B.debug("PatchedMediaKeysMs.MediaKeySession.update");this.b=new G;try{this.c.update(new Uint8Array(b))}catch(c){this.b.reject(c)}return this.b};l.close=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.hb()}catch(b){this.closed.reject(b)}return this.closed};l.remove=function(){B.debug("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function wn(b){B.debug("PatchedMediaKeysMs.onMsNeedKey_",b);if(b.initData){var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";c.initData=Cf(b.initData).buffer;this.dispatchEvent(c)}}l.Vf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new J("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};
l.Tf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyAdded_",b);this.a?(B.debug("Simulating completion for a PR persistent license."),yn(this,"usable"),this.a.resolve(),this.a=null):this.b&&(yn(this,"usable"),this.b.resolve(),this.b=null)};
l.Uf=function(b){B.debug("PatchedMediaKeysMs.onMsKeyError_",b);b=Error("EME PatchedMediaKeysMs key error");b.errorCode=this.c.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.b)this.b.reject(b),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:yn(this,"output-not-allowed");break;default:yn(this,"internal-error")}};
function yn(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new J("keystatuseschange"))}function xn(){this.size=0;this.a=void 0}var zn;l=xn.prototype;l.forEach=function(b){this.a&&b(this.a,zn)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=zn;return this.a&&M.Da(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
Xm(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(B.info("Using ms-prefixed EME v20140218"),zn=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=tn,window.MediaKeys=sn,window.MediaKeySystemAccess=rn,navigator.requestMediaKeySystemAccess=qn)});function An(){B.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function Bn(b){B.debug("PatchedMediaKeysNop.setMediaKeys");return null==b?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Cn(){throw new TypeError("Illegal constructor.");}Cn.prototype.createSession=function(){};Cn.prototype.setServerCertificate=function(){};function Dn(){throw new TypeError("Illegal constructor.");}
Dn.prototype.getConfiguration=function(){};Dn.prototype.createMediaKeys=function(){};Xm(function(){!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(B.info("EME not available."),navigator.requestMediaKeySystemAccess=An,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Bn,window.MediaKeys=Cn,window.MediaKeySystemAccess=Dn)},-10);var En="";function Fn(b){var c=En;return c?c+b.charAt(0).toUpperCase()+b.slice(1):b}function Gn(b,c){B.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var d=new Hn(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}function In(b){B.debug("PatchedMediaKeysWebkit.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Jn(c,null);delete this.mediaKeys;(this.mediaKeys=b)&&Jn(b,this);return Promise.resolve()}
function Hn(b,c){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.a=this.keySystem=b;var d=!1;"org.w3.clearkey"==b&&(this.a="webkit-org.w3.clearkey",d=!1);var e=!1;var f=document.getElementsByTagName("video");f=f.length?f[0]:document.createElement("video");for(var g=0;g<c.length;++g){var h=c[g],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:h.initDataTypes,sessionTypes:["temporary"],label:h.label},m=!1;if(h.audioCapabilities)for(var n=
0;n<h.audioCapabilities.length;++n){var p=h.audioCapabilities[n];if(p.contentType){m=!0;var q=p.contentType.split(";")[0];f.canPlayType(q,this.a)&&(k.audioCapabilities.push(p),e=!0)}}if(h.videoCapabilities)for(n=0;n<h.videoCapabilities.length;++n)p=h.videoCapabilities[n],p.contentType&&(m=!0,f.canPlayType(p.contentType,this.a)&&(k.videoCapabilities.push(p),e=!0));m||(e=f.canPlayType("video/mp4",this.a)||f.canPlayType("video/webm",this.a));"required"==h.persistentState&&(d?(k.persistentState="required",
k.sessionTypes=["persistent-license"]):e=!1);if(e){this.b=k;return}}d="Unsupported keySystem";if("org.w3.clearkey"==b||"com.widevine.alpha"==b)d="None of the requested configurations were supported.";d=Error(d);d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}Hn.prototype.createMediaKeys=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var b=new Kn(this.a);return Promise.resolve(b)};
Hn.prototype.getConfiguration=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.b};function Kn(b){B.debug("PatchedMediaKeysWebkit.MediaKeys");this.g=b;this.b=null;this.a=new L;this.c=[];this.f={}}function Jn(b,c){b.b=c;b.a.hb();var d=En;c&&(b.a.B(c,d+"needkey",b.Zf.bind(b)),b.a.B(c,d+"keymessage",b.Bg.bind(b)),b.a.B(c,d+"keyadded",b.zg.bind(b)),b.a.B(c,d+"keyerror",b.Ag.bind(b)))}l=Kn.prototype;
l.createSession=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");var c=this.b||document.createElement("video");c.src||(c.src="about:blank");b=new Ln(c,this.g,b);this.c.push(b);return b};l.setServerCertificate=function(){B.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
l.Zf=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",b);var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";b.initData instanceof ArrayBuffer?c.initData=b.initData:c.initData=b.initData.buffer;this.b.dispatchEvent(c)};
l.Bg=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",b);var c=Mn(this,b.sessionId);c?(b=new J("message",{messageType:void 0==c.keyStatuses.a?"licenserequest":"licenserenewal",message:b.message}),B.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),c.b&&(c.b.resolve(),c.b=null),c.dispatchEvent(b)):B.error("Session not found",b.sessionId)};
l.zg=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",b);if(b=Mn(this,b.sessionId))B.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Nn(b,"usable"),b.a&&b.a.resolve(),b.a=null};l.Ag=function(b){B.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",b);var c=Mn(this,b.sessionId);c&&c.handleError(b)};
function Mn(b,c){var d=b.f[c];return d?(B.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):(d=b.c.shift())?(d.sessionId=c,b.f[c]=d,B.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):null}function Ln(b,c,d){B.debug("PatchedMediaKeysWebkit.MediaKeySession");Mb.call(this);this.f=b;this.h=!1;this.a=this.b=null;this.c=c;this.g=d;this.sessionId="";this.expiration=NaN;this.closed=new G;this.keyStatuses=new On}cb(Ln,Mb);l=Ln.prototype;
l.handleError=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",b);var c=Error("EME v0.1b key error"),d=b.errorCode;d.systemCode=b.systemCode;c.errorCode=d;!b.sessionId&&this.b?(45==b.systemCode&&(c.message="Unsupported session type."),this.b.reject(c),this.b=null):b.sessionId&&this.a?(this.a.reject(c),this.a=null):(c=b.systemCode,b.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Nn(this,"output-restricted"):1==c?Nn(this,"expired"):Nn(this,"internal-error"))};
function Pn(b,c,d){if(b.h)return Promise.reject(Error("The session is already initialized."));b.h=!0;try{if("persistent-license"==b.g)if(d)var e=new Uint8Array(Fc("LOAD_SESSION|"+d));else{var f=Fc("PERSISTENT|"),g=new Uint8Array(f.byteLength+c.byteLength);g.set(new Uint8Array(f),0);g.set(new Uint8Array(c),f.byteLength);e=g}else e=new Uint8Array(c)}catch(k){return Promise.reject(k)}b.b=new G;var h=Fn("generateKeyRequest");try{b.f[h](b.c,e)}catch(k){if("InvalidStateError"!=k.name)return b.b=null,Promise.reject(k);
(new D(function(){try{b.f[h](b.c,e)}catch(m){b.b.reject(m),b.b=null}})).R(.01)}return b.b}
l.Kd=function(b,c){if(this.a)this.a.then(this.Kd.bind(this,b,c))["catch"](this.Kd.bind(this,b,c));else{this.a=b;if("webkit-org.w3.clearkey"==this.c){var d=Cc(c);var e=JSON.parse(d);"oct"!=e.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null);d=M.Fa(e.keys[0].k);e=M.Fa(e.keys[0].kid)}else d=new Uint8Array(c),e=null;var f=Fn("addKey");try{this.f[f](this.c,d,e,this.sessionId)}catch(g){this.a.reject(g),this.a=null}}};
function Nn(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new J("keystatuseschange"))}l.generateRequest=function(b,c){B.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return Pn(this,c,null)};l.load=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.load");return"persistent-license"==this.g?Pn(this,null,b):Promise.reject(Error("Not a persistent session."))};
l.update=function(b){B.debug("PatchedMediaKeysWebkit.MediaKeySession.update",b);var c=new G;this.Kd(c,b);return c};l.close=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySession.close");if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var b=Fn("cancelKeyRequest");try{this.f[b](this.c,this.sessionId)}catch(c){}}this.closed.resolve();return this.closed};
l.remove=function(){B.debug("PatchedMediaKeysWebkit.MediaKeySession.remove");return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function On(){this.size=0;this.a=void 0}var Qn;l=On.prototype;l.forEach=function(b){this.a&&b(this.a,Qn)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=Qn;return this.a&&M.Da(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
Xm(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)B.info("Using webkit-prefixed EME v0.1b"),En="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)B.info("Using nonprefixed EME v0.1b");else return;Qn=(new Uint8Array([0])).buffer;navigator.requestMediaKeySystemAccess=Gn;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=
null;HTMLMediaElement.prototype.setMediaKeys=In;window.MediaKeys=Kn;window.MediaKeySystemAccess=Hn}});function Rn(b){b=b.target;if("picture-in-picture"==b.webkitPresentationMode){document.pictureInPictureElement=b;var c=new Event("enterpictureinpicture");b.dispatchEvent(c)}else document.pictureInPictureElement==b&&(document.pictureInPictureElement=null),c=new Event("leavepictureinpicture"),b.dispatchEvent(c)}
function Sn(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Tn(){var b=document.pictureInPictureElement;return b?(b.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}
function Un(){return this.hasAttribute("disablePictureInPicture")?!0:!this.webkitSupportsPresentationMode("picture-in-picture")}function Vn(b){b?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}
Xm(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;b.requestPictureInPicture&&document.exitPictureInPicture||!b.webkitSupportsPresentationMode||(B.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,b.requestPictureInPicture=Sn,Object.defineProperty(b,"disablePictureInPicture",{get:Un,set:Vn,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Tn,document.addEventListener("webkitpresentationmodechanged",Rn,!0))}});Xm(function(){B.debug("VideoPlayPromise.install");if(window.HTMLMediaElement){var b=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var c=b.apply(this);c&&c["catch"](function(){});return c}}});function Wn(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}Xm(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;!b.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in b&&(b.getVideoPlaybackQuality=Wn)}});function Xn(b,c,d){return new window.TextTrackCue(b,c,d)}function Yn(b,c,d){return new window.TextTrackCue(b+"-"+c+"-"+d,b,c,d)}
Xm(function(){if(window.VTTCue)B.info("Using native VTTCue.");else if(window.TextTrackCue){var b=TextTrackCue.length;if(3==b)B.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=Xn;else if(6==b)B.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=Yn;else{try{var c=!!Xn(1,2,"")}catch(d){c=!1}c&&(B.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=Xn)}}else B.error("VTTCue not available.")});function Zn(){}A("shaka.text.TtmlTextParser",Zn);Zn.prototype.parseInit=function(){};Zn.prototype.parseInit=Zn.prototype.parseInit;
Zn.prototype.parseMedia=function(b,c){var d=Cc(b),e=[],f=new DOMParser,g=null;if(""==d)return e;try{g=f.parseFromString(d,"text/xml")}catch(sa){throw new E(2,2,2005,"Failed to parse TTML.");}if(g){if(d=g.getElementsByTagName("parsererror")[0])throw new E(2,2,2005,d.textContent);if(f=g.getElementsByTagName("tt")[0]){var h=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","frameRate");var k=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","subFrameRate");var m=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter",
"frameRateMultiplier");var n=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","tickRate");g=f.getAttribute("xml:space")||"default";d=U.getAttributeNS(f,"http://www.w3.org/ns/ttml#styling","extent")}else throw new E(2,2,2005,"TTML does not contain <tt> tag.");if("default"!=g&&"preserve"!=g)throw new E(2,2,2005,"Invalid xml:space value: "+g);g="default"==g;h=new $n(h,k,m,n);k=ao(f.getElementsByTagName("metadata")[0]);m=ao(f.getElementsByTagName("styling")[0]);n=ao(f.getElementsByTagName("layout")[0]);
for(var p=[],q=0;q<n.length;q++){var r=n[q],y=m,C=d;var z=new Hd;var F=r.getAttribute("xml:id");if(F){z.id=F;F=null;C&&(F=bo.exec(C)||co.exec(C));C=F?Number(F[1]):null;F=F?Number(F[2]):null;var H,R;if(H=eo(r,y,"extent"))H=(R=bo.exec(H))||co.exec(H),null!=H&&(z.width=null!=C?100*Number(H[1])/C:Number(H[1]),z.height=null!=F?100*Number(H[2])/F:Number(H[2]),z.widthUnits=R||null!=C?Ud:0,z.heightUnits=R||null!=F?Ud:0);if(r=eo(r,y,"origin"))H=(R=bo.exec(r))||co.exec(r),null!=H&&(z.viewportAnchorX=null!=
F?100*Number(H[1])/F:Number(H[1]),z.viewportAnchorY=null!=C?100*Number(H[2])/C:Number(H[2]),z.viewportAnchorUnits=R||null!=C?Ud:0)}else B.m("TtmlTextParser parser encountered a region with no id. Region will be ignored."),z=null;z&&p.push(z)}d=fo(f.getElementsByTagName("body")[0]);d=t(d);for(f=d.next();!f.done;f=d.next())(f=go(f.value,c.periodStart,h,k,m,n,p,g,!1))&&e.push(f)}return e};Zn.prototype.parseMedia=Zn.prototype.parseMedia;
var bo=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,ho=/^(\d+px|\d+em)$/,co=/^(\d+)px (\d+)px$/,io=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,jo=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,ko=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,lo=/^(\d*(?:\.\d*)?)f$/,mo=/^(\d*(?:\.\d*)?)t$/,no=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,oo={left:Md,center:"center",right:"end",start:Md,end:"end"},po={left:"line-left",center:"center",right:"line-right"};
function ao(b){var c=[];if(!b)return c;for(var d=t(b.childNodes),e=d.next();!e.done;e=d.next())e=e.value,e.nodeType==Node.ELEMENT_NODE&&"br"!==e.nodeName&&(e=ao(e),c=c.concat(e));c.length||c.push(b);return c}function fo(b){if(!b)return[];var c=[];b=t(b.childNodes);for(var d=b.next();!d.done;d=b.next())d=d.value,d instanceof Element&&(d.hasAttribute("begin")?c.push(d):c=c.concat(fo(d)));return c}
function qo(b,c){for(var d="",e=t(b.childNodes),f=e.next();!f.done;f=e.next())f=f.value,"br"==f.nodeName&&b.childNodes[0]!==f?d+="\n":f.childNodes&&0<f.childNodes.length?d+=qo(f,c):c?(f=f.textContent.trim(),f=f.replace(/\s+/g," "),d+=f):d+=f.textContent;return d}
function go(b,c,d,e,f,g,h,k,m){if(m&&"br"==b.nodeName)return b=new Fd(0,0,""),b.spacer=!0,b;var n=/^[\s\n]*$/.test(b.textContent),p=b.nodeType==Node.ELEMENT_NODE&&!b.hasAttribute("begin")&&!b.hasAttribute("end");if(b.nodeType!=Node.ELEMENT_NODE||p&&n||p&&!m)return null;n=ro(b.getAttribute("begin"),d);p=ro(b.getAttribute("end"),d);var q=ro(b.getAttribute("dur"),d);null==p&&null!=q&&(p=n+q);if(!m&&(null==n||null==p))throw new E(2,2,2001);n=m&&null==n?0:n+c;p=m&&null==p?0:p+c;q="";m=[];if(Array.from(b.childNodes).find(function(b){return b.nodeType===
Node.TEXT_NODE&&/\S+/.test(b.textContent)}))q=qo(b,k);else for(var r=t(b.childNodes),y=r.next();!y.done;y=r.next())if(y=go(y.value,c,d,e,f,g,h,k,!0))y.startTime=y.startTime||n,y.endTime=y.endTime||p,m.push(y);c=new Fd(n,p,q);c.nestedCues=m;if((g=so(b,"region",g,"")[0])&&g.getAttribute("xml:id")){var C=g.getAttribute("xml:id");c.region=h.filter(function(b){return b.id==C})[0]}e=so(b,"smpte:backgroundImage",e,"#")[0];to(c,b,g,e,f);return c}
function to(b,c,d,e,f){"rtl"==uo(c,d,f,"direction")&&(b.direction="rtl");var g=uo(c,d,f,"writingMode");"tb"==g||"tblr"==g?b.writingMode="vertical-lr":"tbrl"==g?b.writingMode="vertical-rl":"rltb"==g||"rl"==g?b.direction="rtl":g&&(b.direction=Gd);(g=uo(c,d,f,"textAlign"))?(b.positionAlign=po[g],b.lineAlign=oo[g],b.textAlign=Qd[g.toUpperCase()]):b.textAlign="start";if(g=uo(c,d,f,"displayAlign"))b.displayAlign=Rd[g.toUpperCase()];if(g=uo(c,d,f,"color"))b.color=g;if(g=uo(c,d,f,"backgroundColor"))b.backgroundColor=
g;if(g=uo(c,d,f,"fontFamily"))b.fontFamily=g;(g=uo(c,d,f,"fontWeight"))&&"bold"==g&&(b.fontWeight=700);(g=uo(c,d,f,"wrapOption"))&&"noWrap"==g&&(b.wrapLine=!1);(g=uo(c,d,f,"lineHeight"))&&g.match(ho)&&(b.lineHeight=g);(g=uo(c,d,f,"fontSize"))&&g.match(ho)&&(b.fontSize=g);if(g=uo(c,d,f,"fontStyle"))b.fontStyle=Td[g.toUpperCase()];if(e){g=e.getAttribute("imagetype");var h=e.getAttribute("encoding");e=e.textContent.trim();"PNG"==g&&"Base64"==h&&e&&(b.backgroundImage="data:image/png;base64,"+e)}(d=eo(d,
f,"textDecoration"))&&vo(b,d);(c=wo(c,f,"textDecoration"))&&vo(b,c)}
function vo(b,c){for(var d=c.split(" "),e=0;e<d.length;e++)switch(d[e]){case "underline":b.textDecoration.includes("underline")||b.textDecoration.push("underline");break;case "noUnderline":b.textDecoration.includes("underline")&&Pb(b.textDecoration,"underline");break;case "lineThrough":b.textDecoration.includes("lineThrough")||b.textDecoration.push("lineThrough");break;case "noLineThrough":b.textDecoration.includes("lineThrough")&&Pb(b.textDecoration,"lineThrough");break;case "overline":b.textDecoration.includes("overline")||
b.textDecoration.push("overline");break;case "noOverline":b.textDecoration.includes("overline")&&Pb(b.textDecoration,"overline")}}function uo(b,c,d,e){return(b=wo(b,d,e))?b:eo(c,d,e)}function eo(b,c,d){if(!b)return null;for(var e=ao(b),f=0;f<e.length;f++){var g=U.getAttributeNS(e[f],"http://www.w3.org/ns/ttml#styling",d);if(g)return g}return xo(b,c,d)}function wo(b,c,d){var e=U.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d);return e?e:xo(b,c,d)}
function xo(b,c,d){b=so(b,"style",c,"");for(var e=null,f=0;f<b.length;f++){var g=U.getAttributeNS(b[f],"http://www.w3.org/ns/ttml#styling",d);g||(g=wo(b[f],c,d));g&&(e=g)}return e}
function so(b,c,d,e){var f=[];if(!b||1>d.length)return f;var g=b;for(b=null;g&&!(b=g.getAttribute(c))&&(g=g.parentNode,g instanceof Element););if(c=b)for(c=c.split(" "),c=t(c),b=c.next();!b.done;b=c.next()){b=b.value;g=t(d);for(var h=g.next();!h.done;h=g.next())if(h=h.value,e+h.getAttribute("xml:id")==b){f.push(h);break}}return f}
function ro(b,c){var d=null;if(io.test(b)){d=io.exec(b);var e=Number(d[1]),f=Number(d[2]),g=Number(d[3]),h=Number(d[4]);h+=(Number(d[5])||0)/c.b;g+=h/c.frameRate;d=g+60*f+3600*e}else jo.test(b)?d=yo(jo,b):ko.test(b)?d=yo(ko,b):lo.test(b)?(d=lo.exec(b),d=Number(d[1])/c.frameRate):mo.test(b)?(d=mo.exec(b),d=Number(d[1])/c.a):no.test(b)&&(d=yo(no,b));return d}
function yo(b,c){var d=b.exec(c);return null==d||""==d[0]?null:(Number(d[4])||0)/1E3+(Number(d[3])||0)+60*(Number(d[2])||0)+3600*(Number(d[1])||0)}function $n(b,c,d,e){this.frameRate=Number(b)||30;this.b=Number(c)||1;this.a=Number(e);0==this.a&&(this.a=b?this.frameRate*this.b:1);d&&(b=/^(\d+) (\d+)$/g.exec(d))&&(this.frameRate*=Number(b[1])/Number(b[2]))}Xd["application/ttml+xml"]=Zn;function zo(){this.a=new Zn}A("shaka.text.Mp4TtmlParser",zo);zo.prototype.parseInit=function(b){var c=!1;(new T).L("moov",yf).L("trak",yf).L("mdia",yf).L("minf",yf).L("stbl",yf).ia("stsd",zf).L("stpp",function(b){c=!0;b.parser.stop()}).parse(b);if(!c)throw new E(2,2,2007);};zo.prototype.parseInit=zo.prototype.parseInit;zo.prototype.parseMedia=function(b,c){var d=!1,e=[];(new T).L("mdat",Af(function(b){d=!0;e=e.concat(this.a.parseMedia(b,c))}.bind(this))).parse(b);if(!d)throw new E(2,2,2007);return e};
zo.prototype.parseMedia=zo.prototype.parseMedia;Xd['application/mp4; codecs="stpp"']=zo;Xd['application/mp4; codecs="stpp.ttml.im1t"']=zo;Xd['application/mp4; codecs="stpp.TTML.im1t"']=zo;function Ao(){}A("shaka.text.VttTextParser",Ao);Ao.prototype.parseInit=function(){};Ao.prototype.parseInit=Ao.prototype.parseInit;
Ao.prototype.parseMedia=function(b,c){var d=Cc(b);d=d.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");d=d.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new E(2,2,2E3);var e=c.segmentStart;if(null==e&&(e=0,d[0].includes("X-TIMESTAMP-MAP"))){var f=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),g=d[0].match(/MPEGTS:(\d+)/m);if(f&&g){e=Bo(new Og(f[1]));if(null==e)throw new E(2,2,2E3);e=c.periodStart+(Number(g[1])/9E4-e)}}g=[];var h=d[0].split("\n");for(f=1;f<h.length;f++)if(/^Region:/.test(h[f])){var k=
new Og(h[f]),m=new Hd;Rg(k);Pg(k);for(var n=Rg(k);n;){var p;a:{var q=m,r=n;if(p=/^id=(.*)$/.exec(r))q.id=p[1];else if(p=/^width=(\d{1,2}|100)%$/.exec(r))q.width=Number(p[1]);else if(p=/^lines=(\d+)$/.exec(r))q.height=Number(p[1]),q.heightUnits=2;else if(p=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(r))q.regionAnchorX=Number(p[1]),q.regionAnchorY=Number(p[2]);else if(p=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(r))q.viewportAnchorX=Number(p[1]),q.viewportAnchorY=Number(p[2]);else if(/^scroll=up$/.exec(r))q.scroll=
"up";else{p=!1;break a}p=!0}p||B.m("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored.");Pg(k);n=Rg(k)}g.push(m)}f=[];for(k=1;k<d.length;k++){h=d[k].split("\n");p=h;q=e;h=g;if(1==p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"==p[0])h=null;else{m=null;p[0].includes("--\x3e")||(m=p[0],p.splice(0,1));n=new Og(p[0]);r=Bo(n);var y=Qg(n,/[ \t]+--\x3e[ \t]+/g),C=Bo(n);if(null==r||null==y||null==C)throw new E(2,2,2001);p=new Fd(r+q,C+q,p.slice(1).join("\n").trim());
Pg(n);for(q=Rg(n);q;)Co(p,q,h)||B.m("VTT parser encountered an invalid VTT setting: ",q," The setting will be ignored."),Pg(n),q=Rg(n);null!=m&&(p.id=m);h=p}h&&f.push(h)}return f};Ao.prototype.parseMedia=Ao.prototype.parseMedia;
function Co(b,c,d){var e;if(e=/^align:(start|middle|center|end|left|right)$/.exec(c))c=e[1],"middle"==c?b.textAlign=Jd:b.textAlign=Qd[c.toUpperCase()];else if(e=/^vertical:(lr|rl)$/.exec(c))b.writingMode="lr"==e[1]?"vertical-lr":"vertical-rl";else if(e=/^size:([\d.]+)%$/.exec(c))b.size=Number(e[1]);else if(e=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(c))b.position=Number(e[1]),e[2]&&(c=e[2],b.positionAlign="line-left"==c||"start"==c?"line-left":"line-right"==c||"end"==
c?"line-right":"center");else if(e=/^region:(.*)$/.exec(c)){if(c=Do(d,e[1]))b.region=c}else{a:{if(d=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=1,b.line=Number(d[1]),d[2]&&(b.lineAlign=Sd[d[2].toUpperCase()]);else if(d=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=Ld,b.line=Number(d[1]),d[2]&&(b.lineAlign=Sd[d[2].toUpperCase()]);else{b=!1;break a}b=!0}return b}return!0}
function Do(b,c){var d=b.filter(function(b){return b.id==c});return d.length?d[0]:(B.m("VTT parser could not find a region with id: ",c," The region will be ignored."),null)}function Bo(b){b=Qg(b,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==b)return null;var c=Number(b[2]),d=Number(b[3]);return 59<c||59<d?null:Number(b[4])/1E3+d+60*c+3600*(Number(b[1])||0)}Xd["text/vtt"]=Ao;Xd['text/vtt; codecs="vtt"']=Ao;Xd['text/vtt; codecs="wvtt"']=Ao;function Eo(){this.a=null}A("shaka.text.Mp4VttParser",Eo);Eo.prototype.parseInit=function(b){var c=!1;(new T).L("moov",yf).L("trak",yf).L("mdia",yf).ia("mdhd",function(b){0==b.version?(b.reader.P(4),b.reader.P(4),this.a=b.reader.I(),b.reader.P(4)):(b.reader.P(8),b.reader.P(8),this.a=b.reader.I(),b.reader.P(8));b.reader.P(4)}.bind(this)).L("minf",yf).L("stbl",yf).ia("stsd",zf).L("wvtt",function(){c=!0}).parse(b);if(!this.a)throw new E(2,2,2008);if(!c)throw new E(2,2,2008);};
Eo.prototype.parseInit=Eo.prototype.parseInit;
Eo.prototype.parseMedia=function(b,c){var d=this;if(!this.a)throw B.error("No init segment for MP4+VTT!"),new E(2,2,2008);var e=0,f=[],g,h=[],k=!1,m=!1,n=!1,p=null;(new T).L("moof",yf).L("traf",yf).ia("tfdt",function(b){k=!0;e=0==b.version?b.reader.I():b.reader.Kb()}).ia("tfhd",function(b){var c=b.flags;b=b.reader;b.P(4);c&1&&b.P(8);c&2&&b.P(4);p=c&8?b.I():null}).ia("trun",function(b){m=!0;var c=b.version,d=b.flags;b=b.reader;var e=b.I();d&1&&b.P(4);d&4&&b.P(4);for(var g=[],h=0;h<e;h++){var k={duration:null,
sampleSize:null,Md:null};d&256&&(k.duration=b.I());d&512&&(k.sampleSize=b.I());d&1024&&b.P(4);d&2048&&(k.Md=0==c?b.I():b.xe());g.push(k)}f=g}).L("mdat",Af(function(b){n=!0;g=b})).parse(b);if(!n&&!k&&!m)throw new E(2,2,2008);var q=e,r=new DataView(g.buffer,g.byteOffset,g.byteLength),y=new S(r,0);f.forEach(function(b){var f=b.duration||p,g=b.Md?e+b.Md:q;q=g+(f||0);var k=0;do{var m=y.I();k+=m;var n=y.I();n=xf(n);var r=null;"vttc"==n?8<m&&(r=y.gb(m-8)):("vtte"!=n&&B.error("Unknown box "+n+"! Skipping!"),
y.P(m-8));f?r&&h.push(Fo(r,c.periodStart+g/d.a,c.periodStart+q/d.a)):B.error("WVTT sample duration unknown, and no default found!")}while(b.sampleSize&&k<b.sampleSize)});return h.filter(wd.Na)};Eo.prototype.parseMedia=Eo.prototype.parseMedia;function Fo(b,c,d){var e,f,g;(new T).L("payl",Af(function(b){e=Cc(b)})).L("iden",Af(function(b){f=Cc(b)})).L("sttg",Af(function(b){g=Cc(b)})).parse(b);return e?Go(e,f,g,c,d):null}
function Go(b,c,d,e,f){b=new Fd(e,f,b);c&&(b.id=c);if(d)for(c=new Og(d),d=Rg(c);d;)Co(b,d,[])||B.m("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Pg(c),d=Rg(c);return b}Xd['application/mp4; codecs="wvtt"']=Eo;A("shaka.util.Dom.createHTMLElement",function(b){return document.createElement(b)});A("shaka.util.Dom.createVideoElement",function(){var b=document.createElement("video");b.muted=!0;b.width=600;b.height=400;return b});A("shaka.util.Dom.asHTMLElement",function(b){return b});A("shaka.util.Dom.asHTMLMediaElement",function(b){return b});A("shaka.util.Dom.removeAllChildren",function(b){for(;b.firstChild;)b.removeChild(b.firstChild)});/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function Ho(){}var Io;A("EmeEncryptionSchemePolyfill",Ho);function Jo(){Io?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Io=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=Ko):console.debug("EmeEncryptionSchemePolyfill: EME not found")}Ho.install=Jo;
function Ko(b,c){var d=this;return u(function f(){var g;return x(f,function(f){switch(f.j){case 1:return console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess'),v(f,Io.call(d,b,c),2);case 2:g=f.s;if(Lo(g))return console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Io,f["return"](g);console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");navigator.requestMediaKeySystemAccess=
Mo;return f["return"](Mo.call(d,b,c))}})})}
function Mo(b,c){var d=this;return u(function f(){var g,h,k,m,n,p,q,r;return x(f,function(f){switch(f.j){case 1:console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess');g=No(b);h=[];for(var y=t(c),z=y.next();!z.done;z=y.next())k=z.value,m=Oo(k.videoCapabilities,g),n=Oo(k.audioCapabilities,g),k.videoCapabilities&&k.videoCapabilities.length&&!m.length||k.audioCapabilities&&k.audioCapabilities.length&&!n.length||(p=Object.assign({},k),p.videoCapabilities=m,p.audioCapabilities=n,h.push(p));
if(!h.length)throw q=Error("Unsupported keySystem or supportedConfigurations."),q.name="NotSupportedError",q.code=DOMException.NOT_SUPPORTED_ERR,q;return v(f,Io.call(d,b,h),2);case 2:return r=f.s,f["return"](new Po(r,g))}})})}function Oo(b,c){return b?b.filter(function(b){return!b.encryptionScheme||b.encryptionScheme==c}):b}function Qo(){}var Ro;A("McEncryptionSchemePolyfill",Qo);
function So(){navigator.mediaCapabilities?(Ro=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=To):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}Qo.install=So;
function To(b){var c=this;return u(function e(){var f,g;return x(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),v(e,Ro.call(c,b),2);case 2:f=e.s;if(!b.keySystemConfiguration)return e["return"](f);g=f.keySystemAccess;if(Lo(g))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Ro,e["return"](f);console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");
navigator.mediaCapabilities.decodingInfo=Uo;return e["return"](Uo.call(c,b))}})})}
function Uo(b){var c=this;return u(function e(){var f,g,h,k,m,n,p;return x(e,function(e){switch(e.j){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),f=null,b.keySystemConfiguration&&(g=b.keySystemConfiguration,h=g.keySystem,k=g.audio&&g.audio.encryptionScheme,m=g.video&&g.video.encryptionScheme,f=No(h),n={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:b},k&&k!=f||m&&m!=f)?e["return"](n):v(e,Ro.call(c,b),2);case 2:return p=e.s,
p.keySystemAccess&&(p.keySystemAccess=new Po(p.keySystemAccess,f)),e["return"](p)}})})}function Po(b,c){this.b=b;this.a=c;this.keySystem=b.keySystem}Po.prototype.getConfiguration=function(){var b=this.b.getConfiguration();if(b.videoCapabilities)for(var c=t(b.videoCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;if(b.audioCapabilities)for(c=t(b.audioCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;return b};Po.prototype.createMediaKeys=function(){return this.b.createMediaKeys()};
function No(b){if(b.startsWith("com.widevine")||b.startsWith("com.microsoft")||b.startsWith("com.adobe")||b.startsWith("org.w3"))return"cenc";if(b.startsWith("com.apple"))return"cbcs-1-9";console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",b,"Please contribute!");return null}function Lo(b){b=b.getConfiguration();var c=b.audioCapabilities&&b.audioCapabilities[0];return(b=b.videoCapabilities&&b.videoCapabilities[0]||c)&&void 0!==b.encryptionScheme?!0:!1}function Vo(){}
A("EncryptionSchemePolyfills",Vo);function Ym(){Jo();So()}Vo.install=Ym;"undefined"!==typeof module&&module.af&&(module.af=Vo);}).call(exportTo,innerGlobal,innerGlobal,undefined);if(typeof exports!="undefined")for(var k in exportTo.shaka)exports[k]=exportTo.shaka[k];else if(typeof define=="function"&&define.amd)define(function(){return exportTo.shaka});else innerGlobal.shaka=exportTo.shaka})();

//# sourceMappingURL=shaka-player.compiled.map